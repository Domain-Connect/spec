<!DOCTYPE html>
<html lang="en" class=" Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Domain Connect Protocol - DNS provisioning between Services and DNS Providers</title>
<meta content="P Kowalik" name="author">
<meta content="A Blinn" name="author">
<meta content="J Kolker" name="author">
<meta content="S Kerola" name="author">
<meta content="
       This document provides specification of the Domain Connect Protocol that was built to support DNS configuration provisioning between Service Providers (hosting, social, email, hardware, etc.) and DNS Providers. 
    " name="description">
<meta content="xml2rfc 3.22.0" name="generator">
<meta content="draft-kowalik-domainconnect-01" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.22.0
    Python 3.10.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 4.9.4
    platformdirs 4.2.2
    pycountry 24.6.1
    pydyf 0.10.0
    PyYAML 6.0.1
    requests 2.32.3
    setuptools 71.0.3
    wcwidth 0.2.13
    weasyprint 61.2
-->
<link href="draft-kowalik-domainconnect-01.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body class="xml2rfc">
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Domain Connect</td>
<td class="right">February 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Kowalik, et al.</td>
<td class="center">Expires 31 August 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-kowalik-domainconnect-01</dd>
<dt class="label-">:</dt>
<dd></dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-02-27" class="published">27 February 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-08-31">31 August 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">P. Kowalik</div>
<div class="org">DENIC eG</div>
</div>
<div class="author">
      <div class="author-name">A. Blinn</div>
</div>
<div class="author">
      <div class="author-name">J. Kolker</div>
<div class="org">GoDaddy Inc.</div>
</div>
<div class="author">
      <div class="author-name">S. Kerola</div>
<div class="org">Cloudflare, Inc.</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Domain Connect Protocol - DNS provisioning between Services and DNS Providers</h1>
<div id="_bbb6f541-c0a4-2b23-a3c5-544269e5d60c">
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<div id="_49f78dd5-d0bd-d917-fcec-743e02b7db3b">
<p id="section-abstract-1">This document provides specification of the Domain Connect Protocol that was built to support DNS configuration provisioning between Service Providers (hosting, social, email, hardware, etc.) and DNS Providers.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 31 August 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-use-cases" class="internal xref">Use Cases</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-primary-use-cases" class="internal xref">Primary Use Cases</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-use-cases-out-of-scope" class="internal xref">Use Cases out of scope</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-protocol-design" class="internal xref">Protocol design</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-templates" class="internal xref">Templates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-trust-model" class="internal xref">Trust Model</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-trust-establishment" class="internal xref">Trust Establishment</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-5.2.2" class="auto internal xref">5.2.2</a>.  <a href="#name-template-security" class="internal xref">Template Security</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-protocol-flows" class="internal xref">Protocol Flows</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-general-information" class="internal xref">General information</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-the-synchronous-flow" class="internal xref">The Synchronous Flow</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-the-asynchronous-flow" class="internal xref">The Asynchronous Flow</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-dns-provider-discovery" class="internal xref">DNS Provider Discovery</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-applying-domain-connect" class="internal xref">Applying Domain Connect</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-endpoints" class="internal xref">Endpoints</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-synchronous-flow" class="internal xref">Synchronous Flow</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.1">
                    <p id="section-toc.1-1.7.2.2.2.1.1"><a href="#section-8.2.1" class="auto internal xref">8.2.1</a>.  <a href="#name-query-supported-template" class="internal xref">Query Supported Template</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.2">
                    <p id="section-toc.1-1.7.2.2.2.2.1"><a href="#section-8.2.2" class="auto internal xref">8.2.2</a>.  <a href="#name-apply-template" class="internal xref">Apply Template</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.3">
                    <p id="section-toc.1-1.7.2.2.2.3.1"><a href="#section-8.2.3" class="auto internal xref">8.2.3</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.4">
                    <p id="section-toc.1-1.7.2.2.2.4.1"><a href="#section-8.2.4" class="auto internal xref">8.2.4</a>.  <a href="#name-shared-templates" class="internal xref">Shared Templates</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.5">
                    <p id="section-toc.1-1.7.2.2.2.5.1"><a href="#section-8.2.5" class="auto internal xref">8.2.5</a>.  <a href="#name-verification-of-changes" class="internal xref">Verification of Changes</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-asynchronous-flow-oauth" class="internal xref">Asynchronous Flow: OAuth</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.1">
                    <p id="section-toc.1-1.7.2.3.2.1.1"><a href="#section-8.3.1" class="auto internal xref">8.3.1</a>.  <a href="#name-general-information-2" class="internal xref">General information</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.2">
                    <p id="section-toc.1-1.7.2.3.2.2.1"><a href="#section-8.3.2" class="auto internal xref">8.3.2</a>.  <a href="#name-oauth-flow-setup" class="internal xref">OAuth Flow: Setup</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.3">
                    <p id="section-toc.1-1.7.2.3.2.3.1"><a href="#section-8.3.3" class="auto internal xref">8.3.3</a>.  <a href="#name-oauth-flow-getting-an-autho" class="internal xref">OAuth Flow: Getting an Authorization Code</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.4">
                    <p id="section-toc.1-1.7.2.3.2.4.1"><a href="#section-8.3.4" class="auto internal xref">8.3.4</a>.  <a href="#name-oauth-flow-requesting-an-ac" class="internal xref">OAuth Flow: Requesting an Access Token</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.5">
                    <p id="section-toc.1-1.7.2.3.2.5.1"><a href="#section-8.3.5" class="auto internal xref">8.3.5</a>.  <a href="#name-oauth-flow-making-requests-" class="internal xref">OAuth Flow: Making Requests with Access Tokens</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.6">
                    <p id="section-toc.1-1.7.2.3.2.6.1"><a href="#section-8.3.6" class="auto internal xref">8.3.6</a>.  <a href="#name-oauth-flow-apply-template-t" class="internal xref">OAuth Flow: Apply Template to Domain.</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.7">
                    <p id="section-toc.1-1.7.2.3.2.7.1"><a href="#section-8.3.7" class="auto internal xref">8.3.7</a>.  <a href="#name-oauth-flow-revert-template" class="internal xref">OAuth Flow: Revert Template</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.8">
                    <p id="section-toc.1-1.7.2.3.2.8.1"><a href="#section-8.3.8" class="auto internal xref">8.3.8</a>.  <a href="#name-oauth-flow-revoking-access" class="internal xref">OAuth Flow: Revoking access</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-domain-connect-objects-and-" class="internal xref">Domain Connect Objects and Templates</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-template-versioning" class="internal xref">Template Versioning</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-template-definition" class="internal xref">Template Definition</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-template-record" class="internal xref">Template Record</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-template-considerations" class="internal xref">Template Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-template-state-in-dns" class="internal xref">Template State in DNS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-disclosure-of-changes-and-c" class="internal xref">Disclosure of Changes and Conflicts</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-10.3" class="auto internal xref">10.3</a>.  <a href="#name-record-types-and-conflicts" class="internal xref">Record Types and Conflicts</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-10.4" class="auto internal xref">10.4</a>.  <a href="#name-apply-re-apply-and-multi-in" class="internal xref">Apply, Re-apply, and Multi-Instance</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a href="#section-10.5" class="auto internal xref">10.5</a>.  <a href="#name-non-essential-records" class="internal xref">Non-essential records</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.6">
                <p id="section-toc.1-1.9.2.6.1"><a href="#section-10.6" class="auto internal xref">10.6</a>.  <a href="#name-template-scope" class="internal xref">Template Scope</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.7">
                <p id="section-toc.1-1.9.2.7.1"><a href="#section-10.7" class="auto internal xref">10.7</a>.  <a href="#name-host-name-in-template" class="internal xref">Host/Name in Template</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.8">
                <p id="section-toc.1-1.9.2.8.1"><a href="#section-10.8" class="auto internal xref">10.8</a>.  <a href="#name-pointsto-in-template" class="internal xref">PointsTo in Template</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.9">
                <p id="section-toc.1-1.9.2.9.1"><a href="#section-10.9" class="auto internal xref">10.9</a>.  <a href="#name-variables" class="internal xref">Variables</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.9.2.1">
                    <p id="section-toc.1-1.9.2.9.2.1.1"><a href="#section-10.9.1" class="auto internal xref">10.9.1</a>.  <a href="#name-variables-and-host-name-in-" class="internal xref">Variables and Host/Name in Template</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.9.2.2">
                    <p id="section-toc.1-1.9.2.9.2.2.1"><a href="#section-10.9.2" class="auto internal xref">10.9.2</a>.  <a href="#name-variable-values" class="internal xref">Variable Values</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.9.2.3">
                    <p id="section-toc.1-1.9.2.9.2.3.1"><a href="#section-10.9.3" class="auto internal xref">10.9.3</a>.  <a href="#name-variables-and-security" class="internal xref">Variables and Security</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.9.2.4">
                    <p id="section-toc.1-1.9.2.9.2.4.1"><a href="#section-10.9.4" class="auto internal xref">10.9.4</a>.  <a href="#name-variable-examples" class="internal xref">Variable Examples</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.10">
                <p id="section-toc.1-1.9.2.10.1"><a href="#section-10.10" class="auto internal xref">10.10</a>. <a href="#name-spf-txt-record" class="internal xref">SPF TXT Record</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.10.2.1">
                    <p id="section-toc.1-1.9.2.10.2.1.1"><a href="#section-10.10.1" class="auto internal xref">10.10.1</a>.  <a href="#name-what-is-spf" class="internal xref">What is SPF?</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.10.2.2">
                    <p id="section-toc.1-1.9.2.10.2.2.1"><a href="#section-10.10.2" class="auto internal xref">10.10.2</a>.  <a href="#name-multiple-services" class="internal xref">Multiple Services</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.10.2.3">
                    <p id="section-toc.1-1.9.2.10.2.3.1"><a href="#section-10.10.3" class="auto internal xref">10.10.3</a>.  <a href="#name-spf-record-merging" class="internal xref">SPF Record Merging</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.10.2.4">
                    <p id="section-toc.1-1.9.2.10.2.4.1"><a href="#section-10.10.4" class="auto internal xref">10.10.4</a>.  <a href="#name-alternatives" class="internal xref">Alternatives</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.11">
                <p id="section-toc.1-1.9.2.11.1"><a href="#section-10.11" class="auto internal xref">10.11</a>. <a href="#name-public-template-repository" class="internal xref">Public Template Repository</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.11.2.1">
                    <p id="section-toc.1-1.9.2.11.2.1.1"><a href="#section-10.11.1" class="auto internal xref">10.11.1</a>.  <a href="#name-general-information-3" class="internal xref">General information</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.11.2.2">
                    <p id="section-toc.1-1.9.2.11.2.2.1"><a href="#section-10.11.2" class="auto internal xref">10.11.2</a>.  <a href="#name-repository-location" class="internal xref">Repository Location</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.11.2.3">
                    <p id="section-toc.1-1.9.2.11.2.3.1"><a href="#section-10.11.3" class="auto internal xref">10.11.3</a>.  <a href="#name-file-naming-requirements" class="internal xref">File naming requirements</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.11.2.4">
                    <p id="section-toc.1-1.9.2.11.2.4.1"><a href="#section-10.11.4" class="auto internal xref">10.11.4</a>.  <a href="#name-template-integrity" class="internal xref">Template Integrity</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-general-considerations" class="internal xref">General considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-onboarding" class="internal xref">Onboarding</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-case-sensitivity" class="internal xref">Case Sensitivity</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-extensions-exclusions" class="internal xref">Extensions/Exclusions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-general-information-4" class="internal xref">General information</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-apexcname" class="internal xref">APEXCNAME</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#section-12.3" class="auto internal xref">12.3</a>.  <a href="#name-redirection" class="internal xref">Redirection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a href="#section-12.4" class="auto internal xref">12.4</a>.  <a href="#name-nameservers" class="internal xref">Nameservers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.5">
                <p id="section-toc.1-1.11.2.5.1"><a href="#section-12.5" class="auto internal xref">12.5</a>.  <a href="#name-ds-dnssec" class="internal xref">DS (DNSSEC)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-14" class="auto internal xref"></a><a href="#name-implementation-status" class="internal xref">Implementation Status</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-15" class="auto internal xref"></a><a href="#name-change-history" class="internal xref">Change History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-16" class="auto internal xref"></a><a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-17" class="auto internal xref"></a><a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-examples" class="internal xref">Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.1">
                <p id="section-toc.1-1.17.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-example-template" class="internal xref">Example Template</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.2">
                <p id="section-toc.1-1.17.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-example-records-single-stat" class="internal xref">Example Records: Single static host record</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.3">
                <p id="section-toc.1-1.17.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-example-records-single-vari" class="internal xref">Example Records: Single variable host record for A</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.4">
                <p id="section-toc.1-1.17.2.4.1"><a href="#appendix-A.4" class="auto internal xref">A.4</a>.  <a href="#name-example-records-unspecified" class="internal xref">Example Records: Unspecified record type CAA</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.5">
                <p id="section-toc.1-1.17.2.5.1"><a href="#appendix-A.5" class="auto internal xref">A.5</a>.  <a href="#name-example-dns-zone-merging" class="internal xref">Example: DNS Zone merging</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.6">
                <p id="section-toc.1-1.17.2.6.1"><a href="#appendix-A.6" class="auto internal xref">A.6</a>.  <a href="#name-example-spf-record-merging" class="internal xref">Example: SPF Record Merging</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="_acknowledgments">
<section id="section-1">
      <h2 id="name-acknowledgements">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<div id="_ce81cefb-fba9-f9e7-bc76-5b5ed343d11b">
<p id="section-1-1">The authors wish to thank the following persons for their feedback and suggestions as well as for the previous work on the standard:<a href="#section-1-1" class="pilcrow">¶</a></p>
</div>
<ul class="normal">
<li class="normal" id="section-1-2.1">Roger Carney of GoDaddy Inc.<a href="#section-1-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.2">Chris Ambler of GoDaddy Inc.<a href="#section-1-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.3">Darrel Miller<a href="#section-1-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.4">Peter Thomassen<a href="#section-1-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.5">Paul Hoffmann<a href="#section-1-2.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.6">Arnt Gulbrandsen<a href="#section-1-2.6" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="_introduction">
<section id="section-2">
      <h2 id="name-introduction">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<div id="_ee2be90c-9a4b-533a-12ab-112def3bf89c">
<p id="section-2-1">Connecting a domain name to a service should be a simple and straightforward process.  However, historically, users have faced a complex and often frustrating task involving manual DNS configuration.  Traditional methods are unreliable, require deep technical knowledge of DNS, and result in outdated and confusing instructions from Service Providers.  This leads to user frustration, support overhead, and abandoned setups.<a href="#section-2-1" class="pilcrow">¶</a></p>
</div>
<div id="_09308fcb-e6d5-259e-3bd6-512b799d99fd">
<p id="section-2-2">To address these challenges, Domain Connect offers a streamlined and automated solution.  It empowers Service Providers to easily enable their services to work with user domains, simplifying both DNS provider discovery and DNS configuration.  By abstracting away the complexities of manual DNS management through user-friendly web interactions, standard authentication, and template-based configurations, Domain Connect significantly improves the user experience.<a href="#section-2-2" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_use_cases">
<section id="section-3">
      <h2 id="name-use-cases">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-use-cases" class="section-name selfRef">Use Cases</a>
      </h2>
<div id="_primary_use_cases">
<section id="section-3.1">
        <h3 id="name-primary-use-cases">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-primary-use-cases" class="section-name selfRef">Primary Use Cases</a>
        </h3>
<div id="_5da5f986-b3fc-5995-cdd3-6c62bb2ff85e">
<p id="section-3.1-1">The following use cases illustrate the wide range of applications where Domain Connect simplifies and automates DNS configuration, from basic service onboarding to complex, dynamic DNS management scenarios.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
</div>
<ul class="normal">
<li class="normal" id="section-3.1-2.1">
            <strong>SaaS Provider with One-Off DNS Configuration:</strong> A Software as a Service (SaaS) Provider offering functionality with an option to assign own domain name, such as web hosting or email, can utilize Domain Connect to streamline the process of configuring DNS records for their customers. This automation eliminates the need for manual configuration and simplifies the onboarding experience for users.<a href="#section-3.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-2.2">
            <strong>SaaS Provider with Multi-Step DNS Configuration:</strong> Some SaaS Providers may require a multi-step DNS configuration process, potentially involving asynchronous operations. For example, a service might require initial verification of domain ownership through a TXT record, followed by the creation of CNAME records for different subdomains. Domain Connect can handle such scenarios by utilizing its asynchronous flow. This allows the Service Provider to obtain user consent and apply the necessary DNS changes in multiple steps, even if the user is not actively present during the entire process.<a href="#section-3.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-2.3">
            <strong>On-Premise Service with Publicly Accessible DNS Service:</strong> An on-premise service, such as a local network device or server, can also benefit from Domain Connect if it utilizes a publicly accessible DNS service. By leveraging Domain Connect, the service can automatically update DNS records as needed, ensuring that the service remains accessible through its domain name.<a href="#section-3.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-2.4">
            <strong>Tool or Service with Regularly Updated DNS Entries:</strong> A tool or service that requires regular updates to DNS entries, such as a dynamic DNS service or a DNS-based load balancer, can use Domain Connect to automate the process.<a href="#section-3.1-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-2.5">
            <strong>Packaged Software Provider:</strong> A packaged software provider, whether open-source or proprietary, can integrate Domain Connect into their installation and configuration process. This allows the software to automatically configure necessary DNS records during installation, simplifying the setup process for users. However, if the software is installed on a private network with a private DNS service, it might not be directly compatible with Domain Connect, unless the DNS service provides Domain Connect endpoints accessible to the installation process.<a href="#section-3.1-2.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="_use_cases_out_of_scope">
<section id="section-3.2">
        <h3 id="name-use-cases-out-of-scope">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-use-cases-out-of-scope" class="section-name selfRef">Use Cases out of scope</a>
        </h3>
<div id="_b989b2ac-e167-7fbf-c972-0c211c4509ce">
<p id="section-3.2-1">While Domain Connect offers significant advantages in automating DNS configuration, it's important to recognize scenarios where it might not be the ideal solution:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
</div>
<ul class="normal">
<li class="normal" id="section-3.2-2.1">
            <strong>Automation or CI/CD Pipelines:</strong> Domain Connect is primarily designed for user-driven DNS configuration, where an end user grants consent and applies changes. Automating this process within CI/CD pipelines or other automated workflows can be challenging, as it requires obtaining and securely storing OAuth tokens beforehand. However, if authorisation tokens are pre-obtained from a user-driven setup process, Domain Connect can be also integrated into automation workflows.<a href="#section-3.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-2.2">
            <strong>Private/Enterprise DNS with Public SaaS Providers:</strong> Domain Connect relies on public DNS records and endpoints to facilitate discovery and configuration. If a private or enterprise DNS service is used, it might not be directly compatible with Domain Connect, unless the DNS service provides publicly accessible Domain Connect endpoints.<a href="#section-3.2-2.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="_terminology">
<section id="section-4">
      <h2 id="name-terminology">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<div id="_28072c7f-04fd-d06a-a2dd-d3103f41b53c">
<p id="section-4-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>", "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-4-1" class="pilcrow">¶</a></p>
</div>
<div id="_b450a161-469c-7035-2c4e-0110aefd95df">
<p id="section-4-2">The Terms like "<strong>Registrar</strong>", "<strong>Authoritative server</strong>", "<strong>Zone</strong>", "<strong>Zone Apex</strong>" or "<strong>Sub Domain</strong>" are used as defined in <span>[<a href="#RFC8499" class="cite xref">RFC8499</a>]</span>.<a href="#section-4-2" class="pilcrow">¶</a></p>
</div>
<span class="break"></span><div id="_9e4125ca-6588-314c-9dbe-dae2000577d6">
<dl class="dlParallel" id="section-4-3">
        <dt id="section-4-3.1">Service Provider</dt>
        <dd style="margin-left: 1.5em" id="section-4-3.2">
          <div id="_e601eaf3-f4da-0498-5ee7-6d66552c7feb">
<p id="section-4-3.2.1">An entity that offers products and services that are configured or accessed using domain names. These services typically rely on DNS for setup, discovery and/or operation. Examples include web hosting, email services, cloud platforms, and other online applications.<a href="#section-4-3.2.1" class="pilcrow">¶</a></p>
</div>
</dd>
        <dd class="break"></dd>
<dt id="section-4-3.3">DNS Provider</dt>
        <dd style="margin-left: 1.5em" id="section-4-3.4">
          <div id="_91a03db6-6d8c-7f76-0066-60c5d6307908">
<p id="section-4-3.4.1">An entity that offers DNS zone hosting services. DNS Providers are responsible for hosting the DNS zone for a domain name and providing the necessary tools to manage the DNS records. DNS Provider would be an Authoritative server operator for the hosted zones, or would have a contractual relationship with the operator to manage zone distribution over DNS.<a href="#section-4-3.4.1" class="pilcrow">¶</a></p>
</div>
</dd>
        <dd class="break"></dd>
<dt id="section-4-3.5">User</dt>
        <dd style="margin-left: 1.5em" id="section-4-3.6">
          <div id="_0460cf74-e9e1-d230-799d-5f3ff5ec1302">
<p id="section-4-3.6.1">Refers to the end-user who has means to control domain name's DNS configuration at DNS Provider and wishes to configure it to work with a service provided by a Service Provider.<a href="#section-4-3.6.1" class="pilcrow">¶</a></p>
</div>
</dd>
        <dd class="break"></dd>
<dt id="section-4-3.7">Service Template/Template</dt>
        <dd style="margin-left: 1.5em" id="section-4-3.8">
          <div id="_adeb402d-3c01-50c9-fd8b-233d992e8bab">
<p id="section-4-3.8.1">A structured data format that describes a set of configurations for DNS records required by a Service Provider to configure a certain service together with metadata related to the control flow of Domain Connect protocol. A template is used as a mean of communication between Service Provider and DNS Provider.<a href="#section-4-3.8.1" class="pilcrow">¶</a></p>
</div>
</dd>
        <dd class="break"></dd>
<dt id="section-4-3.9">Public Template Repository</dt>
        <dd style="margin-left: 1.5em" id="section-4-3.10">
          <div id="_3b3c28f9-b570-b282-8c58-7830cecfcad0">
<p id="section-4-3.10.1">A publicly accessible repository of Service Templates, formatted in a standardized manner, intended to facilitate sharing, discovery, and reuse of service configurations. (Read more: <a href="#repository-and-integrity" class="auto internal xref">Section 10.11</a>).<a href="#section-4-3.10.1" class="pilcrow">¶</a></p>
</div>
</dd>
      <dd class="break"></dd>
</dl>
</div>
</section>
</div>
<div id="_protocol_design">
<section id="section-5">
      <h2 id="name-protocol-design">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-protocol-design" class="section-name selfRef">Protocol design</a>
      </h2>
<div id="_templates">
<section id="section-5.1">
        <h3 id="name-templates">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-templates" class="section-name selfRef">Templates</a>
        </h3>
<div id="_1280b059-1cb4-518f-3065-fdbeec3e6142">
<p id="section-5.1-1">Templates are core to Domain Connect, as they fully describe a service owned by a Service Provider and contain all of the information necessary to enable and operate/maintain the service in the form of a set of records.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
</div>
<div id="_fc533c96-2ba4-28f0-367f-ded0ef7bdf8f">
<p id="section-5.1-2">The individual records in a template MAY be assigned to a group identified by a groupId. This allows for the application of templates in different stages. For example, an email provider might first set a TXT record to verify the domain, and later set an MX record to configure email delivery. While done separately, both changes are fundamentally part of the same service.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
</div>
<div id="_7a48e459-f1a8-574b-bd49-984fb4f8a633">
<p id="section-5.1-3">Templates MAY also contain variable portions, as often values of data in
DNS change based on the implementation and/or user of the
service (e.g. the IP address of a service, a user id,
etc.).<a href="#section-5.1-3" class="pilcrow">¶</a></p>
</div>
<div id="_ee53bb7f-7ef9-ca93-727f-eff8e4cf66e3">
<p id="section-5.1-4">The template is defined by the Service Provider and manually onboarded with the DNS Provider, according to a template definition published in the <span><a href="#repository-and-integrity" class="internal xref">Public Repository</a> (<a href="#repository-and-integrity" class="auto internal xref">Section 10.11</a>)</span> or agreed out-of-band between the Service Provider and the DNS Provider.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_trust_model">
<section id="section-5.2">
        <h3 id="name-trust-model">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-trust-model" class="section-name selfRef">Trust Model</a>
        </h3>
<div id="_e703e674-9a8b-7365-e9c5-6f1334234182">
<p id="section-5.2-1">The Domain Connect protocol relies on a robust trust model to ensure the security and reliability of DNS configuration delegation between Service Providers and DNS Providers.  This model addresses the necessary trust relationships between users, Service Providers, and DNS Providers, centering on secure template utilization and DNS Provider vetting processes.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
</div>
<div id="_trust_establishment">
<section id="section-5.2.1">
          <h4 id="name-trust-establishment">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-trust-establishment" class="section-name selfRef">Trust Establishment</a>
          </h4>
<div id="_1878a7ec-e438-771b-2266-99224eb23df2">
<p id="section-5.2.1-1">User trust in the DNS Provider is an essential factor. DNS Provider is a trusted party by the fact that DNS Provider has full technical access to the DNS zone already. Users depend on their DNS Providers to accurately reflect DNS record modifications initiated through Domain Connect. Consequently, DNS Providers are expected implement authorization checks to validate user permissions prior to enacting any DNS zone changes. Furthermore, DNS Providers are responsible for translating template specifications into a human-readable format, enabling users to readily comprehend the nature and impact of proposed DNS record changes.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
</div>
<div id="_458b2116-ddc6-02dc-bc1e-0477836f515c">
<p id="section-5.2.1-2">Users would typically place trust in Service Providers to act responsibly and only make DNS modifications that are within the scope defined by the approved template, however it shall be observed that a malicious actor may try to exploit this trust by acting as a benign Service Provider or building a fake one, therefore by default Service Provider shall not be assumed to be a trusted party in the protocol considerations.<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
</div>
<div id="_ad89acf1-a696-fb1a-befc-02c559e9f4b1">
<p id="section-5.2.1-3">A foundational element to close this gap is the establishment of trust between DNS Providers and Service Providers. DNS Providers verify the legitimacy and security of templates provided by Service Providers as well as they are able to verify textual information included in the template and provided to the user, such as provider name or service name. This trust is typically established through an onboarding process which may involve contractual agreements or appropriate template acceptance policies.<a href="#section-5.2.1-3" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_template_security">
<section id="section-5.2.2">
          <h4 id="name-template-security">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-template-security" class="section-name selfRef">Template Security</a>
          </h4>
<div id="_311176b1-d423-81fc-ae3f-923e52a07b4a">
<p id="section-5.2.2-1">Templates are central to the trust model, defining the permitted scope of DNS zone modifications and restricting Service Provider actions, preventing unauthorized changes beyond the template's specified parameters. The template defines the types of DNS records within the zone and together with a distinct domain name and optionally sub-domain with user consent it defines clearly the part of the zone that the Service Provider is authorized to modify via the template application. Service Providers create templates which are then onboarded by DNS Providers, either adhering to a published template definition or based on bilateral agreements. The DNS Provider has very explicit knowledge and control of the settings being changed to enable a service.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="_protocol_flows">
<section id="section-6">
      <h2 id="name-protocol-flows">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-protocol-flows" class="section-name selfRef">Protocol Flows</a>
      </h2>
<div id="_general_information">
<section id="section-6.1">
        <h3 id="name-general-information">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-general-information" class="section-name selfRef">General information</a>
        </h3>
<div id="_e2661e51-6f6f-87f2-87fc-be1f3d1aa468">
<p id="section-6.1-1">To attach a domain name to a service provided by a Service Provider, the user would first enter their domain name.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
</div>
<div id="_8cdbf3a4-9368-9fc3-5306-0c88627d486b">
<p id="section-6.1-2">Instead of relying on examination of the nameservers and mapping these to DNS Providers, DNS Provider discovery is handled through simple records in DNS and an API. The Service Provider queries for a specific record in the zone that returns a REST endpoint to initiate the protocol. When this endpoint is called, a Domain Connect compliant DNS Provider returns information about that domain and how to configure it using Domain Connect.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
</div>
<div id="_c75c8b85-3557-10a3-2c19-19c103e2460c">
<p id="section-6.1-3">To apply the changes to DNS, there are two use cases. The first is a synchronous web flow, and the second is an asynchronous flow using OAuth and an API.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
</div>
<div id="_e0ca0ec5-8666-ec4b-045d-4a9ae57cbb89">
<p id="section-6.1-4">It is noted that a DNS Provider MAY choose to only implement one of the flows, however it is RECOMMENDED to implement Synchronous Flow which fulfill needs of most Service Providers.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
</div>
<div id="_23d0500c-5c3c-86ce-1252-477ec7fa3adb">
<p id="section-6.1-5">Individual Service Providers MAY work with the synchronous flow only, the asynchronous flow only, or with both.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_the_synchronous_flow">
<section id="section-6.2">
        <h3 id="name-the-synchronous-flow">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-the-synchronous-flow" class="section-name selfRef">The Synchronous Flow</a>
        </h3>
<div id="_621959a4-3f28-116c-4f42-e1e076b8f6f6">
<p id="section-6.2-1">This flow is tailored for the Service Provider that requires a one time synchronous change to DNS.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
</div>
<span id="name-sequence-diagram-of-synchro"></span><div id="_6b87e6a3-00c0-fab3-3a21-553438986023">
<figure id="figure-1">
          <div id="_3bff9a0d-c3bf-b66a-7a04-851aeb246ebd">
<div class="alignLeft art-ascii-art art-text artwork" id="section-6.2-2.1">
<pre>       ,-.
       `-'
       /|\
        |     ,----------------.   ,------------.          ,----------.
       / \    |Service Provider|   |DNS Provider|          |DNS Server|
      User    `--------+-------'   `------+-----'          `-----+----'
     1 Provides domain name               |                      |
        |-------------&gt;|                  |                      |
        |              |                  |                      |
        |              |       2 Initiates DNS discovery         |
        |              |----------------------------------------&gt;|
        |              |                  |                      |
        |              |         3 Responds with                 |
        |              |         discovery URL fragment          |
        |              |&lt;----------------------------------------|
        |              |                  |                      |
        |        4 Requests DNS Provider settings                |
        |              |-----------------&gt;|                      |
        |              |                  |                      |
        |              5 Provides settings|                      |
        |              |&lt;-----------------|                      |
        |              |                  |                      |
        |        6 Queries for supported template                |
        |              |-----------------&gt;|                      |
        |              |                  |                      |
        |              7 Responds template|                      |
        |              support status     |                      |
        |              |&lt;-----------------|                      |
        |              |                  |                      |
   8 Presents connection link             |                      |
        |&lt;-------------|                  |                      |
        |              |                  |                      |
        |  9 Navigates to DNS Provider    |                      |
        |--------------------------------&gt;|                      |
        |              |                  |                      |
        |              |                  |                      |
        _________________________________________________________|
        ! ALT  /  if the template requires signing               !
        !_____/        |                  |                      !
        !              10 Lookup URL      |                      !
        !              signature keys (DNS)                      !
        !              |&lt;-----------------|                      !
        !              |                  |                      !
        !              |                  |----.                 !
        !              |                  |    | 11 Check        !
        !              |                  |&lt;---' request URL     !
        !              |                  |      signature       !
        !              |                  |                      !
        !~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~!
        |              |                  |                      |
        |   12 Requests authentication    |                      |
        |&lt;--------------------------------|                      |
        |              |                  |                      |
        |        13 Authenticate          |                      |
        |--------------------------------&gt;|                      |
        |              |                  |                      |
        |              |                  |----.                 |
        |              |                  |    | 14 Check domain |
        |              |                  |&lt;---' ame in          |
        |              |                  |      customer's      |
        |              |                  |      account         |
        |              |                  |                      |
        |              |                  |                      |
        15 Requests consent for DNS changes                      |
        |&lt;--------------------------------|                      |
        |              |                  |                      |
        |      16 Confirms consent        |                      |
        |--------------------------------&gt;|                      |
        |              |                  |                      |
        |              |                  17 Apply changes to DNS|
        |              |                  |---------------------&gt;|
        |              |                  |                      |
        |           18 Redirect/ Close window                    |
        |              |&lt;- - - - - - - - -|                      |
        |              |                  |                      |
        |              |          19 Query DNS records           |
        |              |----------------------------------------&gt;|
        |              |                  |                      |
        |              |           20 New DNS records            |
        |              |&lt;----------------------------------------|
        |              |                  |                      |
       21 Report success                  |                      |
        |&lt;-------------|                  |                      |</pre>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-sequence-diagram-of-synchro" class="selfRef">Sequence diagram of Synchronous Flow</a>
          </figcaption></figure>
</div>
<div id="_2cdf587a-868a-a1ed-8874-137d16a7f213">
<p id="section-6.2-3">Steps:<a href="#section-6.2-3" class="pilcrow">¶</a></p>
</div>
<div id="_b78b1791-60e9-e46e-7950-33285c71e540">
<ol start="1" type="1" class="normal type-1" id="section-6.2-4">
<li id="section-6.2-4.1">
            <strong>User Provides Domain Name</strong>: The user initiates the process by providing their domain name to the Service Provider.<a href="#section-6.2-4.1" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-4.2">
            <strong>Service Provider Initiates DNS Discovery</strong>: The Service Provider queries the DNS provider to discover the Domain Connect settings for the given domain.<a href="#section-6.2-4.2" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-4.3">
            <strong>DNS Provider Responds with Discovery URL Fragment</strong>: The DNS Provider responds with a URL fragment containing information where to query settings of DNS provider for a domain name.<a href="#section-6.2-4.3" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-4.4">
            <strong>Service Provider Requests DNS Provider Settings</strong>: The Service Provider uses the URL fragment to request the complete Domain Connect settings from the DNS Provider.<a href="#section-6.2-4.4" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-4.5">
            <strong>DNS Provider Provides Settings</strong>: The DNS Provider provides the settings, including information about API endpoints.<a href="#section-6.2-4.5" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-4.6">
            <strong>Service Provider Queries for Supported Template</strong>: The Service Provider checks if the DNS Provider supports the specific template required for the service.<a href="#section-6.2-4.6" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-4.7">
            <strong>DNS Provider Responds with Template Support Status</strong>: The DNS Provider confirms if they support the requested template.<a href="#section-6.2-4.7" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-4.8">
            <strong>Service Provider Presents Connection Link</strong>: The Service Provider presents a connection link to the user, which leads to the DNS Provider's Domain Connect service.<a href="#section-6.2-4.8" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-4.9">
            <strong>User Navigates to DNS Provider</strong>: The user navigates the link and user agent is directed to the DNS Provider's website.<a href="#section-6.2-4.9" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-4.10">
            <strong>DNS Provider Performs URL Lookup and Signature Key Verification (if required)</strong>: If the template requires signing, the DNS Provider looks up the URL signature keys in DNS.<a href="#section-6.2-4.10" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-4.11">
            <strong>DNS Provider Checks Request URL Signature (if required)</strong>: The DNS Provider verifies the signature of the request URL.<a href="#section-6.2-4.11" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-4.12">
            <strong>Service Provider Requests Authentication</strong>: The Service Provider requests authentication from the user.<a href="#section-6.2-4.12" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-4.13">
            <strong>User Authenticates</strong>: The user authenticates with the DNS Provider.<a href="#section-6.2-4.13" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-4.14">
            <strong>DNS Provider Checks Domain Name in Customer's Account</strong>: The DNS Provider verifies that the user is authorized to make change to the domain's DNS zone.<a href="#section-6.2-4.14" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-4.15">
            <strong>DNS Provider Requests Consent for DNS Changes</strong>: The DNS Provider asks the user for consent to apply the changes to the DNS zone.<a href="#section-6.2-4.15" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-4.16">
            <strong>User Confirms Consent</strong>: The user confirms their consent to the DNS changes.<a href="#section-6.2-4.16" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-4.17">
            <strong>DNS Provider Applies Changes to DNS</strong>: The DNS Provider applies the changes to the zone.<a href="#section-6.2-4.17" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-4.18">
            <strong>DNS Provider Redirects or Closes Window</strong>: The DNS Provider either redirects the user back to the Service Provider or closes the Domain Connect browser window.<a href="#section-6.2-4.18" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-4.19">
            <strong>Service Provider Queries DNS Records</strong>: The Service Provider queries the DNS records to verify that the changes have been applied.<a href="#section-6.2-4.19" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-4.20">
            <strong>DNS Server Returns New DNS Records</strong>: The DNS Server returns the updated DNS records.<a href="#section-6.2-4.20" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-4.21">
            <strong>Service Provider Reports Success</strong>: The Service Provider reports to the user that the domain has been successfully connected to the service.<a href="#section-6.2-4.21" class="pilcrow">¶</a>
</li>
        </ol>
</div>
</section>
</div>
<div id="_the_asynchronous_flow">
<section id="section-6.3">
        <h3 id="name-the-asynchronous-flow">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-the-asynchronous-flow" class="section-name selfRef">The Asynchronous Flow</a>
        </h3>
<div id="_31f56665-afb6-b0a7-ef9d-3390a1f5acc2">
<p id="section-6.3-1">The asynchronous OAuth flow is tailored for the Service Provider that wishes to make changes to DNS asynchronously with respect to the user interaction, or wishes to make multiple or additional changes to DNS over time.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
</div>
<span id="name-sequence-diagram-of-asynchr"></span><div id="_d9c31990-08e7-ae55-8416-5e3ffc52bb64">
<figure id="figure-2">
          <div id="_aa2b7ec2-148f-2707-c08a-fb564fc82393">
<div class="alignLeft art-ascii-art art-text artwork" id="section-6.3-2.1">
<pre>       ,-.
       `-'
       /|\
        |     ,----------------.   ,------------.          ,----------.
       / \    |Service Provider|   |DNS Provider|          |DNS Server|
      User    `--------+-------'   `------+-----'          `-----+----'
        .              .                  .                      .
        .        Steps 1-14 same as for Synchronous flow         .
        .              .                  .                      .
        |              |                  |                      |
        |              |                  |                      |
        |    15 Requests consent for      |                      |
        |    (future) DNS changes         |                      |
        |&lt;--------------------------------|                      |
        |              |                  |                      |
        |       16 Grants consent         |                      |
        |--------------------------------&gt;|                      |
        |              |                  |                      |
        |             17 Provides OAuth code                     |
        |              |&lt;-----------------|                      |
        |              |                  |                      |
        |          18 Exchanges code for token                   |
        |              |-----------------&gt;|                      |
        |              |                  |                      |
        |            19 Returns access token                     |
        |              |&lt;-----------------|                      |
        .              .                  .                      .
        .              .          Later   .                      .
        .              .                  .                      .
        .        20 Sends API request with token                 .
        |              |-----------------&gt;|                      |
        |              |                  |                      |
        |              |                  21 Apply changes to DNS|
        |              |                  |---------------------&gt;|
        |              |                  |                      |
        |              22 Respond success |                      |
        |              |&lt;-----------------|                      |
        |              |                  |                      |
        |              |          23 Query DNS records           |
        |              |----------------------------------------&gt;|
        |              |                  |                      |
        |              |           24 New DNS records            |
        |              |&lt;----------------------------------------|
        |              |                  |                      |
   25 Report success (async)              |                      |
        |&lt;- - - - - - -|                  |                      |</pre>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-sequence-diagram-of-asynchr" class="selfRef">Sequence diagram of Asynchronous Flow</a>
          </figcaption></figure>
</div>
<div id="_2600fb42-fd33-e6e0-0d01-4dc0d600897d">
<p id="section-6.3-3">Steps:<a href="#section-6.3-3" class="pilcrow">¶</a></p>
</div>
<div id="_576c3e8f-6d1f-1dee-b2e4-0e5e5c501121">
<p id="section-6.3-4">1-14: Same as for the Synchronous Flow.<a href="#section-6.3-4" class="pilcrow">¶</a></p>
</div>
<div id="_f4186195-fe83-6130-54e5-9f180233b165">
<ol start="15" type="1" class="normal type-1" id="section-6.3-5">
<li id="section-6.3-5.1">
            <strong>DNS Provider Requests Consent for (Future) DNS Changes</strong>: The DNS Provider asks the user for consent to allow the Service Provider to make DNS changes on their behalf in the future.<a href="#section-6.3-5.1" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-5.2">
            <strong>User Grants Consent</strong>: The user grants consent for future DNS changes.<a href="#section-6.3-5.2" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-5.3">
            <strong>DNS Provider Provides OAuth Code</strong>: The DNS Provider provides an OAuth code to the Service Provider.<a href="#section-6.3-5.3" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-5.4">
            <strong>Service Provider Exchanges Code for Token</strong>: The Service Provider exchanges the OAuth code for an access token.<a href="#section-6.3-5.4" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-5.5">
            <strong>DNS Provider Returns Access Token</strong>: The DNS Provider provides an access token to the Service Provider.<a href="#section-6.3-5.5" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-5.6">
            <strong>Service Provider Sends API Request with Token (Later)</strong>: At a later time, the Service Provider uses the access token to send an API request to apply the template to the domain.<a href="#section-6.3-5.6" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-5.7">
            <strong>DNS Provider Applies Changes to DNS</strong>: The DNS Provider applies the changes to the DNS zone.<a href="#section-6.3-5.7" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-5.8">
            <strong>DNS Provider Responds with Success</strong>: The DNS Provider responds to the Service Provider with success.<a href="#section-6.3-5.8" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-5.9">
            <strong>Service Provider Queries DNS Records</strong>: The Service Provider queries the DNS records to verify that the changes have been applied.<a href="#section-6.3-5.9" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-5.10">
            <strong>DNS Server Returns New DNS Records</strong>: The DNS Server returns the updated DNS records.<a href="#section-6.3-5.10" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-5.11">
            <strong>Service Provider Reports Success (Asynchronous)</strong>: The Service Provider reports to the user that the domain has been successfully connected to the service.<a href="#section-6.3-5.11" class="pilcrow">¶</a>
</li>
        </ol>
</div>
</section>
</div>
</section>
</div>
<div id="_dns_provider_discovery">
<section id="section-7">
      <h2 id="name-dns-provider-discovery">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-dns-provider-discovery" class="section-name selfRef">DNS Provider Discovery</a>
      </h2>
<div id="_49d601c1-0a40-6063-859f-3c14d5522ed4">
<p id="section-7-1">To facilitate discovery of the DNS Provider from a domain name DNS is utilized. This is
done by returning a TXT record for <code>_domainconnect</code> in the zone.<a href="#section-7-1" class="pilcrow">¶</a></p>
</div>
<div id="_d577364a-9752-96ca-5533-8cf45b5af402">
<p id="section-7-2">The record content represents an authority and path part of the settings REST API URL.<a href="#section-7-2" class="pilcrow">¶</a></p>
</div>
<div id="_f09b295e-4399-ef90-b7e4-7cfa1dc04ac1">
<p id="section-7-3">An example of the contents of this record:<a href="#section-7-3" class="pilcrow">¶</a></p>
</div>
<div id="_b23c4ac8-6c99-3e47-ece9-20dc0739c98f">
<div class="sourcecode" id="section-7-4">
<pre>domainconnect.virtucondomains.example</pre><a href="#section-7-4" class="pilcrow">¶</a>
</div>
</div>
<div id="_497308d5-ebce-3312-2e6a-527a99bc1649">
<p id="section-7-5"><code>_domainconnect</code> TXT record content, when prepended with <code>https://</code> schema and appended with <code>/v2</code> path segment, MUST form a valid URL <span>[<a href="#RFC3986" class="cite xref">RFC3986</a>]</span>.
<code>_domainconnect</code> TXT record MUST contain the authority part of the URL and MAY contain a path part.
<code>_domainconnect</code> MUST not contain schema, query or fragment part of an URL.<a href="#section-7-5" class="pilcrow">¶</a></p>
</div>
<div id="_ea06db6f-b688-c102-796f-4b325f2ef7d6">
<p id="section-7-6">As a practical matter of implementation, the DNS Provider may or may not
contain a copy of this data in each and every zone. Instead, the DNS
Provider MUST simply respond to the DNS query for the
_`domainconnect` TXT record with the appropriate data.<a href="#section-7-6" class="pilcrow">¶</a></p>
</div>
<div id="_410f988a-d44f-c888-e28d-2855f6eb7b3b">
<p id="section-7-7">How this is implemented is up to the DNS Provider.<a href="#section-7-7" class="pilcrow">¶</a></p>
</div>
<div id="_588f42b9-cc44-71df-95f8-b24f4b0a89d0">
<p id="section-7-8">For example, the DNS Provider may not store the data inside a TXT record
for the domain, opting instead to put a CNAME in the zone and have the
TXT record in the target of the CNAME. Another DNS Provider may simply
respond with the appropriate records at the DNS layer without having
the data in each zone.<a href="#section-7-8" class="pilcrow">¶</a></p>
</div>
<div id="_33682ad5-86b3-89de-a9ed-113acd0a1da9">
<p id="section-7-9">The URL prefix returned MUST be subsequently used by the Service Provider to
determine the additional settings for using Domain Connect on this
domain at the DNS Provider. This is done by calling a REST API.<a href="#section-7-9" class="pilcrow">¶</a></p>
</div>
<div id="_81e030f5-cab5-860a-7581-d75563525ff5">
<div class="sourcecode" id="section-7-10">
<pre>GET

https://{_domainconnect}/v2/{domain}/settings</pre><a href="#section-7-10" class="pilcrow">¶</a>
</div>
</div>
<div id="_010aaa92-6706-75e7-7bb7-e5dc8de69b82">
<p id="section-7-11">This MUST return a JSON structure containing the settings to use for
Domain Connect on the domain name (passed in on the path) at the DNS
Provider. This JSON structure MUST contain the following fields unless
otherwise specified.<a href="#section-7-11" class="pilcrow">¶</a></p>
</div>
<span id="name-properties-of-the-settings-"></span><div id="_25e15d82-7bcb-92d3-8e48-14c0cc833242">
<table class="center" id="table-1">
        <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-properties-of-the-settings-" class="selfRef">properties of the settings data structure</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">
              <strong>Field</strong>
</th>
            <th class="text-left" rowspan="1" colspan="1">
              <strong>Key</strong>
</th>
            <th class="text-left" rowspan="1" colspan="1">
              <strong>Type</strong>
</th>
            <th class="text-left" rowspan="1" colspan="1">
              <strong>Description</strong>
</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <strong>Provider Id</strong>
</td>
            <td class="text-left" rowspan="1" colspan="1">providerId</td>
            <td class="text-left" rowspan="1" colspan="1">String</td>
            <td class="text-left" rowspan="1" colspan="1">(REQUIRED) Unique identifier for the DNS Provider. To ensure non-coordinated uniqueness,
this SHOULD be the domain name of the DNS Provider (e.g. virtucom.example).</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <strong>Provider Name</strong>
</td>
            <td class="text-left" rowspan="1" colspan="1">providerName</td>
            <td class="text-left" rowspan="1" colspan="1">String</td>
            <td class="text-left" rowspan="1" colspan="1">(REQUIRED) The name of the DNS Provider.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <strong>Provider Display Name</strong>
</td>
            <td class="text-left" rowspan="1" colspan="1">providerDisplayName</td>
            <td class="text-left" rowspan="1" colspan="1">String</td>
            <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) The name of the DNS Provider that SHOULD be displayed by the Service Provider.
This MAY change per domain for some DNS Providers that power multiple brands.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <strong>UX URL Prefix for Synchronous Flows</strong>
</td>
            <td class="text-left" rowspan="1" colspan="1">urlSyncUX</td>
            <td class="text-left" rowspan="1" colspan="1">String</td>
            <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) The URL Prefix for linking to the UX of Domain Connect for the synchronous flow
at the DNS Provider. If not returned, the DNS Provider is not supporting the synchronous
flow on this domain.
This URL MUST be of <code>https</code> schema and MUST NOT contain query or fragment part.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <strong>UX URL Prefix for Asynchronous Flows</strong>
</td>
            <td class="text-left" rowspan="1" colspan="1">urlAsyncUX</td>
            <td class="text-left" rowspan="1" colspan="1">String</td>
            <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) The URL Prefix for linking to the UX elements of Domain Connect for the
asynchronous flow at the DNS Provider. If not returned, the DNS Provider is not supporting
the asynchronous flow on this domain.
This URL MUST be of <code>https</code> schema and MUST NOT contain query or fragment part.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <strong>API URL Prefix</strong>
</td>
            <td class="text-left" rowspan="1" colspan="1">urlAPI</td>
            <td class="text-left" rowspan="1" colspan="1">String</td>
            <td class="text-left" rowspan="1" colspan="1">(REQUIRED) The URL Prefix for the REST API
This URL MUST be of <code>https</code> schema and MUST NOT contain query or fragment part.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <strong>Width of Window</strong>
</td>
            <td class="text-left" rowspan="1" colspan="1">width</td>
            <td class="text-left" rowspan="1" colspan="1">Number</td>
            <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) This is the desired width of the window for granting consent when navigated in a
popup. Default value if not returned is 750px.
The Service Providers SHOULD obey to this setting if opening a pop-up
window to assure optimal display of the user interface of the DNS Proviver.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <strong>Height of Window</strong>
</td>
            <td class="text-left" rowspan="1" colspan="1">height</td>
            <td class="text-left" rowspan="1" colspan="1">Number</td>
            <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) This is the desired height of the window for granting consent when navigated in
a popup. Default value if not returned is 750px.
The Service Providers SHOULD obey to this setting if opening a pop-up
window to assure optimal display of the user interface of the DNS Proviver.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <strong>UX URL Control Panel</strong>
</td>
            <td class="text-left" rowspan="1" colspan="1">urlControlPanel</td>
            <td class="text-left" rowspan="1" colspan="1">String</td>
            <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) This is a URL to the control panel for editing DNS at the DNS Provider.
This field allows a Service Provider whose template isn't supported at the DNS Provider
to provide a direct link to perform manual edits.

To allow deep links to the specific domain, this string MAY contain <code>%domain%</code> which MUST be replaced with the domain name when building the deep link to the control panel of a given domain.

This URL MUST be of <code>https</code> schema and MAY contain query or fragment part.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <strong>Name Servers</strong>
</td>
            <td class="text-left" rowspan="1" colspan="1">nameServers</td>
            <td class="text-left" rowspan="1" colspan="1">String List</td>
            <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) This is the list of nameservers desired by the DNS Provider for the zone to be
authoritative. This does not indicate the authoritative nameservers; for this the registry
would be queried.</td>
          </tr>
        </tbody>
      </table>
</div>
<div id="_f7e1c368-2ed9-750c-4899-f3583ccadbd2">
<div class="lang-json sourcecode" id="section-7-13">
<pre>{
    "providerId": "virtucondomains.example",
    "providerName": "Virtucon Domains",
    "providerDisplayName": "Virtucon Domains",
    "urlSyncUX": "https://domainconnect.virtucondomains.example",
    "urlAsyncUX": "https://domainconnect.virtucondomains.example",
    "urlAPI": "https://api.domainconnect.virtucondomains.example",
    "width": 750,
    "height": 750,
    "urlControlPanel": "https://domaincontrolpanel.virtucondomains.ex
    ample/?domain=%domain%",
    "nameServers": ["ns01.virtucondomainsdns.example", "ns02.virtucon
    domainsdns.example"]
}</pre><a href="#section-7-13" class="pilcrow">¶</a>
</div>
</div>
<div id="_84fe43ee-d348-6218-4c59-0367acba5ecb">
<p id="section-7-14">Discovery MUST work on the Zone Apex only. Bear in mind that
zones can be delegated to other users, making this information valuable to Service Providers since DNS changes may be different for a Zone Apex vs. a Sub Domain for an individual service.<a href="#section-7-14" class="pilcrow">¶</a></p>
</div>
<div id="_6329c6c4-59c4-6ad7-e016-21b5567e1941">
<p id="section-7-15">The Service Provider MUST handle the condition when a query for the
<code>_domainconnect</code> TXT record suceeds, but a call to query for the JSON fails.
This can happen if the zone is hosted with another DNS Provider, but contains an
incorrect <code>_domainconnect</code> TXT record.<a href="#section-7-15" class="pilcrow">¶</a></p>
</div>
<div id="_dd2341e0-6a4c-a4d2-8d29-02e44e47409e">
<p id="section-7-16">The DNS Provider MUST return a 404 HTTP error code if they do not contain the zone.<a href="#section-7-16" class="pilcrow">¶</a></p>
</div>
<span id="name-http-status-codes-for-the-s"></span><div id="_827e884f-9fbb-2f6f-3b91-b7b55ce871f7">
<table class="center" id="table-2">
        <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-http-status-codes-for-the-s" class="selfRef">HTTP status codes for the settings end-point</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Status</th>
            <th class="text-left" rowspan="1" colspan="1">Response</th>
            <th class="text-left" rowspan="1" colspan="1">Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <strong>Success</strong>
</td>
            <td class="text-left" rowspan="1" colspan="1">2xx</td>
            <td class="text-left" rowspan="1" colspan="1">A response of an http status code of 2xx indicates that the
call was successful. The response is the JSON described above.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <strong>Not Found</strong>
</td>
            <td class="text-left" rowspan="1" colspan="1">404</td>
            <td class="text-left" rowspan="1" colspan="1">A response of a 404 indicates that the DNS Provider does not have the zone.</td>
          </tr>
        </tbody>
      </table>
</div>
</section>
</div>
<div id="_applying_domain_connect">
<section id="section-8">
      <h2 id="name-applying-domain-connect">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-applying-domain-connect" class="section-name selfRef">Applying Domain Connect</a>
      </h2>
<div id="_endpoints">
<section id="section-8.1">
        <h3 id="name-endpoints">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-endpoints" class="section-name selfRef">Endpoints</a>
        </h3>
<div id="_88687d30-aa07-a579-ba43-a24bee3f15b3">
<p id="section-8.1-1">The Domain Connect endpoints returned in the JSON during
discovery are in the form of URLs.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
</div>
<div id="_39421469-2747-9e15-630b-5f961fe44c63">
<p id="section-8.1-2">The first set of endpoints are for the UX that the Service Provider
links to. These are for the synchronous flow where the user can click
to grant consent and have changes applied, and for the
asynchronous OAuth flow where the user can grant consent for
OAuth access.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
</div>
<div id="_736e6cec-9f90-8750-7093-38bd4ad274f3">
<p id="section-8.1-3">The second set of endpoints are for the REST API.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
</div>
<div id="_f2f5f834-9fe5-3e57-b0bc-e7db5590113d">
<p id="section-8.1-4">All endpoints begin with a root URL for the DNS Provider such as:<a href="#section-8.1-4" class="pilcrow">¶</a></p>
</div>
<div id="_0d6ff85c-a003-dfe4-f8f6-6aee4663d9a9">
<div class="sourcecode" id="section-8.1-5">
<pre>https://connect.dnsprovider.example</pre><a href="#section-8.1-5" class="pilcrow">¶</a>
</div>
</div>
<div id="_9b9685da-9cd9-531e-378c-9b0c711e8aad">
<p id="section-8.1-6">They MAY also include any path segment at the discretion of the DNS Provider.
For example:<a href="#section-8.1-6" class="pilcrow">¶</a></p>
</div>
<div id="_e5faf0d8-15af-63c8-279c-668a9904bb4b">
<div class="sourcecode" id="section-8.1-7">
<pre>https://connect.dnsprovider.example/api</pre><a href="#section-8.1-7" class="pilcrow">¶</a>
</div>
</div>
<div id="_ee43fbc1-c5bb-4c4b-a0eb-1ab7c39a925b">
<p id="section-8.1-8">The root URLs for the UX endpoints and the API endpoints are returned in
the JSON payload during DNS Provider discovery.<a href="#section-8.1-8" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_synchronous_flow">
<section id="section-8.2">
        <h3 id="name-synchronous-flow">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-synchronous-flow" class="section-name selfRef">Synchronous Flow</a>
        </h3>
<div id="_query_supported_template">
<section id="section-8.2.1">
          <h4 id="name-query-supported-template">
<a href="#section-8.2.1" class="section-number selfRef">8.2.1. </a><a href="#name-query-supported-template" class="section-name selfRef">Query Supported Template</a>
          </h4>
<div id="_84d48574-bf4e-0d58-60e4-15667cbd228e">
<div class="sourcecode" id="section-8.2.1-1">
<pre>GET

{urlAPI}/v2/domainTemplates/providers/{providerId}/services
/{serviceId}</pre><a href="#section-8.2.1-1" class="pilcrow">¶</a>
</div>
</div>
<div id="_c6437a70-5d90-377d-bf3f-5531be99e371">
<p id="section-8.2.1-2">This URL is be used by the Service Provider to determine if the DNS
Provider supports a specific template through the synchronous flow.<a href="#section-8.2.1-2" class="pilcrow">¶</a></p>
</div>
<div id="_4bc7d768-9b0d-09b4-d0bd-11f4d1edcf99">
<p id="section-8.2.1-3">Returning a status of 200 without a body indicates the template is supported.
The DNS Provider MAY disclose the version of the template
in a JSON object with field <code>version</code> (see: <span><a href="#template-definition" class="internal xref">version field</a> (<a href="#template-definition" class="auto internal xref">Section 9.2</a>)</span>
or the full JSON object of deployed template.<a href="#section-8.2.1-3" class="pilcrow">¶</a></p>
</div>
<div id="_5d097ed5-01c6-c19c-2f13-b46c32180e28">
<p id="section-8.2.1-4">Returning a status of 404 indicates the template is not supported.<a href="#section-8.2.1-4" class="pilcrow">¶</a></p>
</div>
<span id="name-https-status-codes-for-the-"></span><div id="_4ff76db4-6a52-8c75-f12b-b8074af2713c">
<table class="center" id="table-3">
            <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-https-status-codes-for-the-" class="selfRef">https status codes for the Query Supported Template end-point</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Status</th>
                <th class="text-left" rowspan="1" colspan="1">Response</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Success</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">2xx</td>
                <td class="text-left" rowspan="1" colspan="1">A response of an http status code of 2xx indicates that the
call was successful. The response OPTIONALLY contains the version or template.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Not Found</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">404</td>
                <td class="text-left" rowspan="1" colspan="1">A response of a 404 indicates that the template is not supported</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<div id="_apply_template">
<section id="section-8.2.2">
          <h4 id="name-apply-template">
<a href="#section-8.2.2" class="section-number selfRef">8.2.2. </a><a href="#name-apply-template" class="section-name selfRef">Apply Template</a>
          </h4>
<div id="_apply_template_url">
<section id="section-8.2.2.1">
            <h5 id="name-apply-template-url">
<a href="#section-8.2.2.1" class="section-number selfRef">8.2.2.1. </a><a href="#name-apply-template-url" class="section-name selfRef">Apply Template URL</a>
            </h5>
<div id="_d399385e-12e4-e1a8-19e4-7dec9b475608">
<div class="sourcecode" id="section-8.2.2.1-1">
<pre>GET

{urlSyncUX}/v2/domainTemplates/providers/{providerId}/services
/{serviceId}/apply?[properties]</pre><a href="#section-8.2.2.1-1" class="pilcrow">¶</a>
</div>
</div>
<div id="_167f04b1-6f0a-f7d4-49ab-cee985ac8bd5">
<p id="section-8.2.2.1-2">This is the URL where the user is sent to apply a template to a domain they own.
It is called from the Service Provider to start the synchronous Domain Connect Protocol.<a href="#section-8.2.2.1-2" class="pilcrow">¶</a></p>
</div>
<div id="_06b6e657-928a-0fcf-9dca-99e03113ddb6">
<p id="section-8.2.2.1-3">This URL can be called in one of two ways.<a href="#section-8.2.2.1-3" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_new_browser_window">
<section id="section-8.2.2.2">
            <h5 id="name-new-browser-window">
<a href="#section-8.2.2.2" class="section-number selfRef">8.2.2.2. </a><a href="#name-new-browser-window" class="section-name selfRef">New Browser Window</a>
            </h5>
<div id="_72b20072-c0b3-6f29-af3c-ae52e4250985">
<p id="section-8.2.2.2-1">The first is through a new browser tab or in a popup browser window.
The DNS Provider signs the user
in if necessary, verifies domain ownership, and asks for confirmation
before application of the template. After application of the template,
the DNS Provider SHOULD automatically close the browser tab or window or direct the user to the user interface of Service Provider in other appropriate way, in order to maintain good user experience.<a href="#section-8.2.2.2-1" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_same_browser_window">
<section id="section-8.2.2.3">
            <h5 id="name-same-browser-window">
<a href="#section-8.2.2.3" class="section-number selfRef">8.2.2.3. </a><a href="#name-same-browser-window" class="section-name selfRef">Same Browser Window</a>
            </h5>
<div id="_9ee90f33-8275-19ef-6b22-e9298f946605">
<p id="section-8.2.2.3-1">The second is in the current browser tab/window. As above the DNS
Provider signs the user in if necessary, verifies the user control of the DNS Zone for the domain,
and asks for confirmation before application of the template. After
application of the template (or cancellation by the user), the DNS
Provider SHOULD redirect the browser to a return URL (redirect_uri), also in error scenarios in any of the mentioned steps, in order for the user to be able to continue the setup with the Service Provider.
The DNS Provider MAY restrain from this redirection if such redirection would be a security threat (for example if redirect_uri is not considered safe).<a href="#section-8.2.2.3-1" class="pilcrow">¶</a></p>
</div>
<div id="_4ed2aa0d-d7dd-9b6d-6215-19160628fd33">
<p id="section-8.2.2.3-2">To prevent an open redirect, unless the request is digitally signed, the redirect_uri
MUST be within the domains specified in the template in <code>syncRedirectDomain</code>.<a href="#section-8.2.2.3-2" class="pilcrow">¶</a></p>
</div>
<div id="_c0011860-f188-b376-5b94-86b16cfd88c6">
<p id="section-8.2.2.3-3">Several query parameters MUST be appended to the end of this redirect_uri.<a href="#section-8.2.2.3-3" class="pilcrow">¶</a></p>
</div>
<ul class="normal">
<li class="normal" id="section-8.2.2.3-4.1">
                <div id="_65936df4-d954-a269-f9db-0d60dc7cb806">
<p id="section-8.2.2.3-4.1.1">State<a href="#section-8.2.2.3-4.1.1" class="pilcrow">¶</a></p>
</div>
<div id="_df54b01c-62f6-6bbd-ff4b-d6abc06a80ac">
<p id="section-8.2.2.3-4.1.2">If a state parameter is passed in on the query string, this MUST be
passed back as state= on the redirect_uri.<a href="#section-8.2.2.3-4.1.2" class="pilcrow">¶</a></p>
</div>
</li>
              <li class="normal" id="section-8.2.2.3-4.2">
                <div id="_f37d4041-e909-31af-1c36-45732b11f6ee">
<p id="section-8.2.2.3-4.2.1">Error<a href="#section-8.2.2.3-4.2.1" class="pilcrow">¶</a></p>
</div>
<div id="_13eba39b-3055-e7c4-ab83-488b8a2a5a9e">
<p id="section-8.2.2.3-4.2.2">If authorization could not be obtained or an error has occurred, the query parameter <code>error</code> MUST be appended. For consistency with the asynchronous OAuth flows the valid values for the error parameter MUST be as specified in OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span> (4.1.2.1. Error Response - "error" parameter). Valid values are: <code>invalid_request</code>, <code>unauthorized_client</code>, <code>access_denied</code>, <code>unsupported_response_type</code>, <code>invalid_scope</code>, <code>server_error</code>, and <code>temporarily_unavailable</code>.<a href="#section-8.2.2.3-4.2.2" class="pilcrow">¶</a></p>
</div>
</li>
              <li class="normal" id="section-8.2.2.3-4.3">
                <div id="_8e2bb032-b7a1-0e78-5706-dfd6a291d398">
<p id="section-8.2.2.3-4.3.1">Error Description<a href="#section-8.2.2.3-4.3.1" class="pilcrow">¶</a></p>
</div>
<div id="_37d09206-4848-03ae-23f2-e140c6b7eb55">
<p id="section-8.2.2.3-4.3.2">When an error occurs, an OPTIONAL error description containing a developer focused error description MAY be returned. It would be conveyed using <code>error_description</code> query parameter as per <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.+<a href="#section-8.2.2.3-4.3.2" class="pilcrow">¶</a></p>
</div>
<div id="_8ab2c4ff-ce25-5c81-ef73-a181eb8b0ea9">
<p id="section-8.2.2.3-4.3.3">Under normal operation the <code>access_denied</code> error can be returned for a number of reasons. For example, the user may not have access to the account that owns the domain. Even if they do and successfully sign-in, the account or the domain may be suspended.<br><a href="#section-8.2.2.3-4.3.3" class="pilcrow">¶</a></p>
</div>
<div id="_0ad598a0-d3c6-2e85-14f7-626f2cffce97">
<p id="section-8.2.2.3-4.3.4">It is unlikely that the DNS Provider would want to leak this information to the Service Provider, and as such the description MAY be vague.<a href="#section-8.2.2.3-4.3.4" class="pilcrow">¶</a></p>
</div>
<div id="_5c48baac-aa72-c4c9-ff74-20692e5adfba">
<p id="section-8.2.2.3-4.3.5">There is one piece of information that may be interesting to communicate to the Service Provider. This is when the end user decided to cancel the operation. If the DNS Provider wishes to communicate this to the Service Provider the <code>error_description</code> MAY contain the prefix <code>"user_cancel"</code>. Again, this is left to the discretion of the DNS Provider and is therefore OPTIONAL.<a href="#section-8.2.2.3-4.3.5" class="pilcrow">¶</a></p>
</div>
</li>
            </ul>
</section>
</div>
<div id="_parametersproperties">
<section id="section-8.2.2.4">
            <h5 id="name-parameters-properties">
<a href="#section-8.2.2.4" class="section-number selfRef">8.2.2.4. </a><a href="#name-parameters-properties" class="section-name selfRef">Parameters/properties</a>
            </h5>
<span id="name-query-parameters-of-the-app"></span><div id="_aa6db042-9b6c-698d-4fa5-a987124072d9">
<table class="center" id="table-4">
              <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-query-parameters-of-the-app" class="selfRef">query parameters of the apply call in the sync flow</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Property</th>
                  <th class="text-left" rowspan="1" colspan="1">Request Parameter</th>
                  <th class="text-left" rowspan="1" colspan="1">Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <strong>Domain</strong>
</td>
                  <td class="text-left" rowspan="1" colspan="1">domain</td>
                  <td class="text-left" rowspan="1" colspan="1">(REQUIRED) The domain name being configured. This is the Zone Apex (the registered domain or delegated zone).</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <strong>Host</strong>
</td>
                  <td class="text-left" rowspan="1" colspan="1">host</td>
                  <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) This is the host name of the Sub Domain. If left blank, the template is being applied to the Zone Apex. Otherwise the template is applied to the sub domain of the domain in the same zone.</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <strong>Redirect URI</strong>
</td>
                  <td class="text-left" rowspan="1" colspan="1">redirect_uri</td>
                  <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) The location to direct the client browser to upon successful authorization, or upon error. If omitted the DNS Provider SHOULD close the browser window upon completion. It MUST be scoped to the <code>syncRedirectDomain</code> authority from the template, or the request MUST be signed.</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <strong>State</strong>
</td>
                  <td class="text-left" rowspan="1" colspan="1">state</td>
                  <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) A random and unique string passed along to prevent CSRF, or to pass back state.
It MUST be returned as a query parameter when redirecting to the <code>redirect_uri</code> described above.</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <strong>Name/Value Pairs</strong>
</td>
                  <td class="text-left" rowspan="1" colspan="1">*</td>
                  <td class="text-left" rowspan="1" colspan="1">(REQUIRED) Any key that is to be used as a replacement for the <code>"% surrounded"</code> variables in the template. The name portion of this API parameter corresponds to the variable(s) specified in the template and the value corresponds to the value that is to be used to replace the variable when applying the template.
The client MUST ignore any unknown parameters, not referenced in the template.</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <strong>Provider Name</strong>
</td>
                  <td class="text-left" rowspan="1" colspan="1">providerName</td>
                  <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) This parameter allows for the caller to provide additional text for display
with the template providerName. This text SHOULD be used to augment the providerName value
from the template, not replace it. This parameter is only allowed when the
<code>"sharedProviderName"</code> attribute is set in the template. Note: this used to be controlled by the <code>"shared"</code> attribute in the template, which has been deprecated.</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <strong>Service Name</strong>
</td>
                  <td class="text-left" rowspan="1" colspan="1">serviceName</td>
                  <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) This parameter allows for the caller to provide additional text for display
with the template <code>serviceName</code>. It SHOULD be used to augment the <code>serviceName</code> value
from the template, not replace it. This parameter is only allowed when the
<code>"sharedServiceName"</code> attribute is set in the template.</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <strong>Group Id</strong>
</td>
                  <td class="text-left" rowspan="1" colspan="1">groupId</td>
                  <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) This parameter specifies the groups from the template to apply.
If no group is specified, all groups are applied. Multiple groups MAY be specified in a
comma delimited format.</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <strong>Signature</strong>
</td>
                  <td class="text-left" rowspan="1" colspan="1">sig</td>
                  <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) A signature of the query string. See Security Considerations section below.</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <strong>Key</strong>
</td>
                  <td class="text-left" rowspan="1" colspan="1">key</td>
                  <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) A value containing the host in DNS where the public key for the signature can be
obtained. The domain for this host is in the template in syncPubKeyDomain. See Security
Considerations section below.</td>
                </tr>
              </tbody>
            </table>
</div>
<div id="_53440c47-04ca-bfc8-6e68-8dee36b452ae">
<p id="section-8.2.2.4-2">An example query string:<a href="#section-8.2.2.4-2" class="pilcrow">¶</a></p>
</div>
<div id="_45053e61-2931-8c5d-d2d2-1784f3bb2256">
<div class="sourcecode" id="section-8.2.2.4-3">
<pre>GET

https://web-connect.dnsprovider.example/v2/domainTemplates/providers/
exampleservice.example/services/template1/apply?domain=example.com&amp;
IP=192.168.42.42&amp;RANDOMTEXT=shm%3A1542108821%3AHello</pre><a href="#section-8.2.2.4-3" class="pilcrow">¶</a>
</div>
</div>
<div id="_c5eb076f-910e-32a3-ac84-c8dd56f8094a">
<p id="section-8.2.2.4-4">This call indicates that the Service Provider wishes to connect the
domain example.com to the service using the template identified by the
composite key of the provider (exampleservice.example) and the service template
owned by them (template1). In this example, there are two variables in this
template, "IP" and "RANDOMTEXT". These variables are passed as name/value pairs.<a href="#section-8.2.2.4-4" class="pilcrow">¶</a></p>
</div>
</section>
</div>
</section>
</div>
<div id="_security_considerations">
<section id="section-8.2.3">
          <h4 id="name-security-considerations">
<a href="#section-8.2.3" class="section-number selfRef">8.2.3. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
          </h4>
<div id="_risk_of_phishing_with_open_template_parameters">
<section id="section-8.2.3.1">
            <h5 id="name-risk-of-phishing-with-open-">
<a href="#section-8.2.3.1" class="section-number selfRef">8.2.3.1. </a><a href="#name-risk-of-phishing-with-open-" class="section-name selfRef">Risk of phishing with open template parameters</a>
            </h5>
<div id="_8c413efb-6170-3a3f-1b11-cfc6837f6b21">
<p id="section-8.2.3.1-1">By applying a template with parameters there is a security
consideration that must be taken into account.<a href="#section-8.2.3.1-1" class="pilcrow">¶</a></p>
</div>
<div id="_665e0af4-30ab-7a82-4151-50715379dc75">
<p id="section-8.2.3.1-2">Consider the template above where the IP address of the A record is
passed in through a variable. A bad actor could generate a URL with a
malicious IP and phish users by sending out emails asking them to "re-configure" their
service. If an end user is convinced to click on
this link, they would land on the DNS Provider site to confirm the
change. To the user, this would appear to be a valid request to
configure the domain. Yet the IP would be hijacking the service.<a href="#section-8.2.3.1-2" class="pilcrow">¶</a></p>
</div>
<div id="_363c776c-254d-6aa5-b865-47ae1ef8a36f">
<p id="section-8.2.3.1-3">Not all templates have this problem. But when they do, there are several options.<a href="#section-8.2.3.1-3" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_disable_synchronous">
<section id="section-8.2.3.2">
            <h5 id="name-disable-synchronous">
<a href="#section-8.2.3.2" class="section-number selfRef">8.2.3.2. </a><a href="#name-disable-synchronous" class="section-name selfRef">Disable Synchronous</a>
            </h5>
<div id="_f499c353-47c3-86d3-9983-d63915b55ef1">
<p id="section-8.2.3.2-1">One option is to disable the synchronous flow and use
asynchronous OAuth. This can be controlled with the <code>syncBlock</code> value from the template. However, as will be seen below OAuth has a higher implementation burden and requires onboarding between each Service and DNS Provider.<a href="#section-8.2.3.2-1" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_digitally_sign_requests">
<section id="section-8.2.3.3">
            <h5 id="name-digitally-sign-requests">
<a href="#section-8.2.3.3" class="section-number selfRef">8.2.3.3. </a><a href="#name-digitally-sign-requests" class="section-name selfRef">Digitally Sign Requests</a>
            </h5>
<div id="_1f21d3fb-d679-bb77-f809-9ae5c8c67d9b">
<p id="section-8.2.3.3-1">Another option is to digitally sign the query string. A
signature is appended as an additional query string parameter,
properly URL encoded and of the form:<a href="#section-8.2.3.3-1" class="pilcrow">¶</a></p>
</div>
<div id="_f8880263-93e9-6714-7fe9-c34f76a8dc34">
<div class="sourcecode" id="section-8.2.3.3-2">
<pre>sig=V2te9zWMU7G3plxBTsmYSJTvn2vzMvNwAjWQ%2BwTe91DxuJhdVf4cVc4vZBYfEYV
7u5d7PzTO7se7OrkhyiB7TpoJJW1yB5qHR7HKM5SZldUsdtg5%2B1SzEtIX0Uq8b2mCmQ
F%2FuJGXpqCyFrEajvpTM7fFKPk1kuctmtkjV7%2BATcvNPLWY7KyE4%2Bqc8jpfN61cP
5l8iA4krAa3%2BfTro5cmWR8YUJ5yrnRs6KT4b5D71HFvOUk0sGEUddUUlsyRQKRHUFN6
HjEya50YDHfZJlYHkHlK0xX6Yqeii9QZ2I35U9eJbSvZGQko5beqviWFXdsVDbvd3DYcb
SHgJq9%2FXoMTTw%3D%3D</pre><a href="#section-8.2.3.3-2" class="pilcrow">¶</a>
</div>
</div>
<div id="_062163b9-7c73-cce2-7db9-7ca865393975">
<p id="section-8.2.3.3-3">The Service Provider generates this signature using a private key. As indicated,
this signature is generated from the query string properly URL encoded.<a href="#section-8.2.3.3-3" class="pilcrow">¶</a></p>
</div>
<div id="_0ed4c69b-dd67-6183-3ba9-4fb5d5bed311">
<p id="section-8.2.3.3-4">The Service Provider MUST publish their public key and place it in a DNS TXT record in a domain specified in the template in <code>syncPubKeyDomain</code> at a host of their choice.
The TXT record MUST be published as a comma-separated list of key-value
properties.<a href="#section-8.2.3.3-4" class="pilcrow">¶</a></p>
</div>
<span id="name-properties-of-the-public-ke"></span><div id="_4007612b-5aac-70ab-2e83-0aba7af1f07b">
<table class="center" id="table-5">
              <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-properties-of-the-public-ke" class="selfRef">Properties of the public key TXT record</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Property</th>
                  <th class="text-left" rowspan="1" colspan="1">Key</th>
                  <th class="text-left" rowspan="1" colspan="1">Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <strong>Fragment Index</strong>
</td>
                  <td class="text-left" rowspan="1" colspan="1">p</td>
                  <td class="text-left" rowspan="1" colspan="1">(REQUIRED) The index value of the public key fragment</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <strong>Fragment Payload</strong>
</td>
                  <td class="text-left" rowspan="1" colspan="1">d</td>
                  <td class="text-left" rowspan="1" colspan="1">(REQUIRED) The payload of public key fragment</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <strong>Signing Algorithm</strong>
</td>
                  <td class="text-left" rowspan="1" colspan="1">a</td>
                  <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) The parameter identifies the algorithm intended for use with the key. The values used SHALL be registered in the IANA "JSON Web Signature and Encryption Algorithms" registry established by <span>[<a href="#RFC7518" class="cite xref">RFC7518</a>]</span>.
If omitted it MUST be assumed to be RS256.
The support of RS256 is MANDATORY for both DNS Providers and Service Providers.</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <strong>Public Key Format</strong>
</td>
                  <td class="text-left" rowspan="1" colspan="1">t</td>
                  <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) The format of the public key.
If omitted MUST be assumed to be x509.</td>
                </tr>
              </tbody>
            </table>
</div>
<div id="_0d8bc350-8a31-4b6f-91e1-f8ec12a2f072">
<p id="section-8.2.3.3-6">To allow for key rotation or usage of multiple keys, the host name of the TXT record MUST be appended as another query parameter on the query string of the form:<a href="#section-8.2.3.3-6" class="pilcrow">¶</a></p>
</div>
<div id="_691b4e77-bd32-0946-0527-70c009476efc">
<div class="sourcecode" id="section-8.2.3.3-7">
<pre>key=_dcpubkeyv1</pre><a href="#section-8.2.3.3-7" class="pilcrow">¶</a>
</div>
</div>
<div id="_6971a19f-ae2d-eec2-6afb-b6f68eee36f8">
<p id="section-8.2.3.3-8">This example indicates that the public key can be found by doing a DNS
query for a TXT record called _dcpubkeyv1 in the domain specified in the
<code>syncPubKeyDomain</code> from the template.<a href="#section-8.2.3.3-8" class="pilcrow">¶</a></p>
</div>
<div id="_93e5d688-cf97-4f27-b901-3082b828552e">
<p id="section-8.2.3.3-9">To account for DNS Servers with limits to the size of a TXT record, the public key MAY be split into multiple TXT records at the specified host. For example, a public key of:<a href="#section-8.2.3.3-9" class="pilcrow">¶</a></p>
</div>
<div id="_d83b12bd-7572-4493-78a5-df77a43f6e4d">
<div class="sourcecode" id="section-8.2.3.3-10">
<pre>MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA18SgvpmeasN4BHkkv0SBjAzIc
4grYLjiAXRtNiBUiGUDMeTzQrKTsWvy9NuxU1dIHCZy9o1CrKNg5EzLIZLNyMfI6qiXnM
+HMd4byp97zs/3D39Q8iR5poubQcRaGozWx8yQpG0OcVdmEVcTfyR/XSEWC5u16EBNvRn
NAOAvZYUdWqVyQvXsjnxQot8KcK0QP8iHpoL/1dbdRy2opRPQ2FdZpovUgknybq/6FkeD
tW7uCQ6Mvu4QxcUa3+WP9nYHKtgWip/eFxpeb+qLvcLHf1h0JXtxLVdyy6OLk3f2JRYUX
2ZZVDvG3biTpeJz6iRzjGg6MfGxXZHjI8weDjXrJwIDAQAB</pre><a href="#section-8.2.3.3-10" class="pilcrow">¶</a>
</div>
</div>
<div id="_2ee2d61e-d0de-768b-cc20-3e2804be47fd">
<p id="section-8.2.3.3-11">may contain several TXT records. The records would be of the form:<a href="#section-8.2.3.3-11" class="pilcrow">¶</a></p>
</div>
<div id="_aa84281f-522d-20c8-3360-204199f65a96">
<div class="sourcecode" id="section-8.2.3.3-12">
<pre>p=1,a=RS256,d=MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA18SgvpmeasN
4BHkkv0SBjAzIc4grYLjiAXRtNiBUiGUDMeTzQrKTsWvy9NuxU1dIHCZy9o1CrKNg5EzL
IZLNyMfI6qiXnM+HMd4byp97zs/3D39Q8iR5poubQcRaGozWx8yQpG0OcVdmEVcTfy

p=2,a=RS256,d=R/XSEWC5u16EBNvRnNAOAvZYUdWqVyQvXsjnxQot8KcK0QP8iHpoL/1
dbdRy2opRPQ2FdZpovUgknybq/6FkeDtW7uCQ6Mvu4QxcUa3+WP9nYHKtgWip/eFxpeb+
qLvcLHf1h0JXtxLVdyy6OLk3f2JRYUX2ZZVDvG3biTpeJz6iRzjGg6MfGxXZHjI8

p=3,a=RS256,d=weDjXrJwIDAQAB</pre><a href="#section-8.2.3.3-12" class="pilcrow">¶</a>
</div>
</div>
<div id="_2bc2b0b2-7d53-b4b6-9168-59aadbd46829">
<p id="section-8.2.3.3-13">Here the public key is broken into three records in DNS, and the data
also indicates that the signing algorithm is an RSA Signature with
SHA-256. The representation as x509 certificate is the default in this case.<a href="#section-8.2.3.3-13" class="pilcrow">¶</a></p>
</div>
<div id="_5f88d1e0-5cd3-b3a2-e679-1da653ba8007">
<p id="section-8.2.3.3-14">The above data was generated for a query string:<a href="#section-8.2.3.3-14" class="pilcrow">¶</a></p>
</div>
<div id="_57a6128f-69e7-fc83-52ff-2a15a15395ee">
<div class="sourcecode" id="section-8.2.3.3-15">
<pre>a=1&amp;b=2&amp;ip=10.10.10.10&amp;domain=example.net</pre><a href="#section-8.2.3.3-15" class="pilcrow">¶</a>
</div>
</div>
<div id="_92ab00e4-6d03-5547-0362-9631500c3e66">
<p id="section-8.2.3.3-16">Signing the query string by the Service Provider is OPTIONAL. Not
all Services Provider templates require or are able to provide this level of security.
Presence of the <code>syncPubKeyDomain</code> in the template indicates that the
template requires signature verification.<a href="#section-8.2.3.3-16" class="pilcrow">¶</a></p>
</div>
<div id="_b9ca6e09-820c-6e5c-ce0d-89f069b6249f">
<p id="section-8.2.3.3-17">DNS Providers MUST reject any request to apply a template with <code>syncPubKeyDomain</code> present and no signing of a query string in place.<a href="#section-8.2.3.3-17" class="pilcrow">¶</a></p>
</div>
<div id="_e48a01da-56ae-abbf-0f8d-bb35be9314c3">
<p id="section-8.2.3.3-18">The digital signature MUST be generated on the full query string only,
excluding the sig and key parameters. This is everything after the ?, except the sig and key values which MUST be appended to the signed query string.<a href="#section-8.2.3.3-18" class="pilcrow">¶</a></p>
</div>
<div id="_22659ee7-4190-d422-43c4-38f45b4b65ba">
<p id="section-8.2.3.3-19">The values of each query string value key/value pair MUST be properly URL Encoded before the signature is generated.<a href="#section-8.2.3.3-19" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_warnings">
<section id="section-8.2.3.4">
            <h5 id="name-warnings">
<a href="#section-8.2.3.4" class="section-number selfRef">8.2.3.4. </a><a href="#name-warnings" class="section-name selfRef">Warnings</a>
            </h5>
<div id="_94672d56-d278-7345-9c8c-a421c527fef7">
<p id="section-8.2.3.4-1">Some applications aren't able to use OAuth and/or sign requests.<a href="#section-8.2.3.4-1" class="pilcrow">¶</a></p>
</div>
<div id="_2dd429d7-4d49-ef1a-7168-f24d009a767c">
<p id="section-8.2.3.4-2">If the template require variables, and OAuth and signing isn't available,
the flag <code>warnPhishing</code> SHOULD be set to true in the template in order to offer transparency to the DNS Provider about security properties of the template.<a href="#section-8.2.3.4-2" class="pilcrow">¶</a></p>
</div>
<div id="_5849edf1-e8aa-0f0d-ee48-9c44b6f01d96">
<p id="section-8.2.3.4-3">When set this indicates to the DNS Provider that they SHOULD display additional warnings to
the user to have them verify the link was/is from a reputable source before applying
the template.<a href="#section-8.2.3.4-3" class="pilcrow">¶</a></p>
</div>
</section>
</div>
</section>
</div>
<div id="_shared_templates">
<section id="section-8.2.4">
          <h4 id="name-shared-templates">
<a href="#section-8.2.4" class="section-number selfRef">8.2.4. </a><a href="#name-shared-templates" class="section-name selfRef">Shared Templates</a>
          </h4>
<div id="_962d0a51-e3d0-4a17-2f13-a86d84496524">
<p id="section-8.2.4-1">Some templates can be called by multiple companies, or be used for different purposes.<a href="#section-8.2.4-1" class="pilcrow">¶</a></p>
</div>
<div id="_e74f9a97-8bb3-2757-bb9c-bebe54a20abc">
<p id="section-8.2.4-2">For example, most services are sold and provided by the same company. However, some
Service Providers have a reseller channel. This allows the service to be
provided by the Service Provider, but sold through third parties.
It is often this third party reseller that configures DNS.<a href="#section-8.2.4-2" class="pilcrow">¶</a></p>
</div>
<div id="_70b6b290-3183-d52d-ec12-fa338325427a">
<p id="section-8.2.4-3">While each reseller could enable Domain Connect, this is inefficient for
the DNS Providers. Enabling a single template that is shared by multiple
resellers would be more optimal.<a href="#section-8.2.4-3" class="pilcrow">¶</a></p>
</div>
<div id="_6e8c1d37-cbeb-eb68-c859-cc9c1d559a9e">
<p id="section-8.2.4-4">As another example, some templates may be used for different purposes by the same company.<a href="#section-8.2.4-4" class="pilcrow">¶</a></p>
</div>
<div id="_9ea1d88d-13a0-6653-38d3-dc9326207697">
<p id="section-8.2.4-5">To facilitate these use cases, the ability to pass in additional context for the display
of the providerName and serviceName is enabled. This is only allowed when the template enables the capability
through the sharedProviderName and/or sharedServiceName flags.<a href="#section-8.2.4-5" class="pilcrow">¶</a></p>
</div>
<div id="_7f6ea6f3-2803-323d-c86a-76423a569844">
<p id="section-8.2.4-6">Note: The shared flag used to be used for this purpose, but has been deprecated.<a href="#section-8.2.4-6" class="pilcrow">¶</a></p>
</div>
<div id="_55500432-b820-5352-7ca1-7c7d302c7538">
<p id="section-8.2.4-7">The exact message presented to the user is up to the DNS Provider. However it is recommended
that these fields be used to augment the display of the serviceName and providerName from the template,
not replace it.<a href="#section-8.2.4-7" class="pilcrow">¶</a></p>
</div>
<div id="_f7f3c2cb-5b6b-c426-bf02-23b34502f168">
<p id="section-8.2.4-8">Note: When a Service Provider has a large reseller channel, it is highly
recommended that the Service Provider creates an API for their resellers
to ease the implementation of Domain Connect. There are elements of convenience in doing
this around Domain Discovery and URL Formatting. But this would be required
if the template required signatures.<a href="#section-8.2.4-8" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_verification_of_changes">
<section id="section-8.2.5">
          <h4 id="name-verification-of-changes">
<a href="#section-8.2.5" class="section-number selfRef">8.2.5. </a><a href="#name-verification-of-changes" class="section-name selfRef">Verification of Changes</a>
          </h4>
<div id="_d7416747-2d4e-ce38-d5a1-67b164f608dc">
<p id="section-8.2.5-1">There are circumstances where the Service Provider may wish to verify
that the template was successfully applied. Without Domain Donnect, this
typically involved the Service Provider querying DNS to see if the
changes to DNS had been made.<a href="#section-8.2.5-1" class="pilcrow">¶</a></p>
</div>
<div id="_aedfc2ff-9dd0-a75a-37f6-a9d309607df5">
<p id="section-8.2.5-2">This same technique works with Domain Connect, and if necessary can be
triggered either manually on the Service Provider site or automatically
upon page/window activation in the browser when the browser window for
the DNS Provider is closed.<a href="#section-8.2.5-2" class="pilcrow">¶</a></p>
</div>
<div id="_c7c1b36e-caf6-f365-0994-43527cc49749">
<p id="section-8.2.5-3">When the redirect_uri is used and an error is not present in the URI,
the Service Provider can not assume the changes were applied to DNS. While true in most
circumstances, users can tamper with or alter the return
url in the browser. As such it is recommend that enablement of a service
be based on verification of changes to DNS.<a href="#section-8.2.5-3" class="pilcrow">¶</a></p>
</div>
</section>
</div>
</section>
</div>
<div id="_asynchronous_flow_oauth">
<section id="section-8.3">
        <h3 id="name-asynchronous-flow-oauth">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-asynchronous-flow-oauth" class="section-name selfRef">Asynchronous Flow: OAuth</a>
        </h3>
<div id="_general_information_2">
<section id="section-8.3.1">
          <h4 id="name-general-information-2">
<a href="#section-8.3.1" class="section-number selfRef">8.3.1. </a><a href="#name-general-information-2" class="section-name selfRef">General information</a>
          </h4>
<div id="_a7ad9670-b365-ce73-862c-18c1c9b080cd">
<p id="section-8.3.1-1">Using the OAuth flow is a more advanced use case needed by Service Providers that have more complex configurations that may require multiple steps and/or are asynchronous from the user's interaction.<a href="#section-8.3.1-1" class="pilcrow">¶</a></p>
</div>
<div id="_24c21750-f45c-53bc-a610-2a5b312bea0f">
<p id="section-8.3.1-2">Details of an OAuth implementation are beyond the scope of this specification. Instead, an overview of how OAuth is used by Domain Connect is given here.<a href="#section-8.3.1-2" class="pilcrow">¶</a></p>
</div>
<div id="_311e2d44-8f18-12fc-b92e-16a5a5886252">
<p id="section-8.3.1-3">Not all DNS Providers will support the asyncronous flow. As such it is recommended that Service Providers relying on an OAuth implementation also implement a synchronous implementation.<a href="#section-8.3.1-3" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_oauth_flow_setup">
<section id="section-8.3.2">
          <h4 id="name-oauth-flow-setup">
<a href="#section-8.3.2" class="section-number selfRef">8.3.2. </a><a href="#name-oauth-flow-setup" class="section-name selfRef">OAuth Flow: Setup</a>
          </h4>
<div id="_4a3e8e8d-6b6e-1464-445a-45b42d623d24">
<p id="section-8.3.2-1">Service Providers wishing to use the OAuth flow MUST register as an
OAuth client with each DNS Provider. This is typically a manual
process, however other solutions like OAuth Dynamic Client Registration <span>[<a href="#RFC7591" class="cite xref">RFC7591</a>]</span> MAY be offered by DNS Provider as well.<a href="#section-8.3.2-1" class="pilcrow">¶</a></p>
</div>
<div id="_8528a5db-e4c2-e94d-bce5-99ee39bcffb9">
<p id="section-8.3.2-2">To register, the Service Provider would provide (in addition to their
template) any configuration necessary for the DNS Providers OAuth
implementation. This includes valid URLs and Domains for redirects upon
success or errors of OAuth flow, token validity, presence and validity of refresh tokens etc.<a href="#section-8.3.2-2" class="pilcrow">¶</a></p>
</div>
<div id="_6b157699-927b-da23-a052-d67d92e6f1c9">
<p id="section-8.3.2-3">Note: The validity of redirects are very important in any OAuth implementation.
Most OAuth vulnerabilities are a combination of an open redirect and/or a
compromised secret.<a href="#section-8.3.2-3" class="pilcrow">¶</a></p>
</div>
<div id="_a18f1ec3-0133-ed4c-de2b-d8a02146d392">
<p id="section-8.3.2-4">The DNS Provider SHOULD give the Service Provider a client id and a secret which will be used when requesting tokens. For simplicity the client id MAY be the same as the providerId, however it is up to the agreement between the parties involved.
Any other form of client authentication within OAuth framework MAY be agreed between the parties.<a href="#section-8.3.2-4" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_oauth_flow_getting_an_authorization_code">
<section id="section-8.3.3">
          <h4 id="name-oauth-flow-getting-an-autho">
<a href="#section-8.3.3" class="section-number selfRef">8.3.3. </a><a href="#name-oauth-flow-getting-an-autho" class="section-name selfRef">OAuth Flow: Getting an Authorization Code</a>
          </h4>
<div id="_6393364b-679b-fcdd-98ac-4b81faff7ddd">
<div class="sourcecode" id="section-8.3.3-1">
<pre>GET

{urlAsyncUX}/v2/domainTemplates/providers/{providerId}</pre><a href="#section-8.3.3-1" class="pilcrow">¶</a>
</div>
</div>
<div id="_178af996-6ab6-0a1b-e915-b3132219d731">
<p id="section-8.3.3-2">To initiate the OAuth flow the Service Provider first links to the DNS
Provider to gain consent.<a href="#section-8.3.3-2" class="pilcrow">¶</a></p>
</div>
<div id="_9c9ee323-ca9a-ec09-5735-ca78f21036a7">
<p id="section-8.3.3-3">This endpoint is similar to the synchronous flow described above. The DNS Provider
MUST authenticate the user, verify the user has control of the DNS Zone for the domain, and ask the user for
permission. Instead of permission to make a change to DNS, the permission
is now to allow the Service Provider to
make the changes on their behalf. Similarly the
DNS Provider MAY warn the user that (the eventual)
application of a template might change existing records and/or disrupt
existing services attached to the domain.<a href="#section-8.3.3-3" class="pilcrow">¶</a></p>
</div>
<div id="_4ac52418-09f3-d256-df88-f890746b04a8">
<p id="section-8.3.3-4">While the variables for the applied template would be provided later,
the values of some variables may be necessary to determine conflicts. As
such, any variables impacting conflicting records SHOULD be provided
in the consent flow. This primarly includes variables in hosts, and
variables in the data portion for certain TXT records.<a href="#section-8.3.3-4" class="pilcrow">¶</a></p>
</div>
<div id="_d7a9be8a-20b5-9036-e34b-e2036cf84acd">
<p id="section-8.3.3-5">The protocol allows for the Service Provider to gain consent to apply
multiple templates. These templates are specified in the <code>scope</code> parameter. It
also allows for the Service Provider to gain consent to apply these templates to the domain
or to the domain with multiple sub-domains. These are specified in the <code>domain</code> and <code>host</code>
parameter. If conflict detection is implemented
by the DNS Provider, they SHOULD account for all permutations, in order to inform
the end user of all possible consequences of the authorised change.<a href="#section-8.3.3-5" class="pilcrow">¶</a></p>
</div>
<div id="_8a6d550b-3dc0-86cb-00b4-4465734ad60a">
<p id="section-8.3.3-6">The scope parameter is a space separated list (as per the OAuth protocol)
of the template serviceIds. The host parameter is an OPTIONAL comma separated
list of hosts. A blank entry for the host implies the template can be
applied to the Zone Apex For example:<a href="#section-8.3.3-6" class="pilcrow">¶</a></p>
</div>
<span id="name-examples-of-scope-and-host-"></span><div id="_b4b72b7b-eebc-1ce5-0d68-9040ad9a2452">
<table class="center" id="table-6">
            <caption>
<a href="#table-6" class="selfRef">Table 6</a>:
<a href="#name-examples-of-scope-and-host-" class="selfRef">examples of scope and host parameter values in the async flow</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">
                  <strong>Query String</strong>
</th>
                <th class="text-left" rowspan="1" colspan="1">
                  <strong>Description</strong>
</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>scope=t1%20t2&amp;domain=example.com</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Templates "t1" and "t2" can be applied to example.com</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>scope=t1%20t2&amp;domain=example.com&amp;host=sub1,sub2</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Templates "t1" and "t2" can be applied to sub1.example.com or sub2.example.com</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>scope=t1%20t2&amp;domain=example.com&amp;host=sub1,</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">Templates "t1" and "t2" can be applied to example.com or sub1.example.com</td>
              </tr>
            </tbody>
          </table>
</div>
<div id="_12222748-eb01-f020-f20f-cb7d351be184">
<p id="section-8.3.3-8">Upon successful authorization/verification/consent from the user, the DNS Provider MUST direct the end user's browser to the redirect URI. The authorization code MUST be appended to this URI as a query parameter of <code>"code="</code> as per the OAuth specification.<a href="#section-8.3.3-8" class="pilcrow">¶</a></p>
</div>
<div id="_ac93aec6-d911-d554-0c47-2243fc46b556">
<p id="section-8.3.3-9">Similar to the synchronous flow, upon error the DNS Provider MAY append an error code as query parameter <code>"error"</code>. These errors are also from the OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span> (4.1.2.1. Error Response - "error" parameter). Valid values include: <code>invalid_request</code>, <code>unauthorized_client</code>, <code>access_denied</code>, <code>unsupported_response_type</code>, <code>invalid_scope</code>, <code>server_error</code>, and <code>temporarilly_unavailable</code>. An OPTIONAL <code>error_description</code> suitable for developers may also be returned at the discretion of the DNS Provider.
The same considerations as in the synchronous flow apply here.<a href="#section-8.3.3-9" class="pilcrow">¶</a></p>
</div>
<div id="_07492a80-4308-86e1-f359-1c574ce3dc36">
<p id="section-8.3.3-10">The state value passed into the call MUST be passed back on the query
string as <code>state=</code>.<a href="#section-8.3.3-10" class="pilcrow">¶</a></p>
</div>
<div id="_ccb8852e-b90e-1b57-5f22-c6d9a202bbb5">
<p id="section-8.3.3-11">The following table describes the values in the query string parameters for the request for the OAuth consent flow that MUST be included unless otherwise indicated<a href="#section-8.3.3-11" class="pilcrow">¶</a></p>
</div>
<span id="name-query-parameters-of-the-aut"></span><div id="_bbc335b2-8f7b-91f4-1ec5-3b984681d830">
<table class="center" id="table-7">
            <caption>
<a href="#table-7" class="selfRef">Table 7</a>:
<a href="#name-query-parameters-of-the-aut" class="selfRef">query parameters of the authorization end-point in async flow</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Property</th>
                <th class="text-left" rowspan="1" colspan="1">Key</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Domain</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">domain</td>
                <td class="text-left" rowspan="1" colspan="1">(REQUIRED) The domain name being configured. This is the Zone Apex.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Host</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">host</td>
                <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) An list of comma separated host names upon which the template may be applied. An empty string implies the root.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Client Id</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">client_id</td>
                <td class="text-left" rowspan="1" colspan="1">(REQUIRED) The client id that was provided by the DNS Provider to the Service Provider during registration.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Redirect URI</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">redirect_uri</td>
                <td class="text-left" rowspan="1" colspan="1">(REQUIRED) The location to direct the client's browser upon successful authorization or upon error.
Validation of the redirect_uri MUST be done by the DNS Provider to match the values provided during onboarding.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Response type</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">response_type</td>
                <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) If included it MUST be the string 'code' to indicate an authorization code is being requested.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Scope</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">scope</td>
                <td class="text-left" rowspan="1" colspan="1">(REQUIRED) The OAuth scope corresponds to the requested templates. This is list of space separated serviceIds.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Provider Name</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">providerName</td>
                <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) This parameter allows for the caller to provide additional text for display with the template providerName. This text SHOULD be used to augment the providerName value from the template, not replace it.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Service Name</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">serviceName</td>
                <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) This parameter allows for the caller to provide additional text for display with the template serviceName(s). It SHOULD be used to augment the serviceName value(s) from the template, not replace.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>State</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">state</td>
                <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) This is a random, unique string passed along to prevent CSRF or to pass state value back to the caller. If present it MUST be returned as a parameter appended to the <code>redirect_url</code> described above.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Name/Value Pairs</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">*</td>
                <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) Any key that will be used as a replacement for the "% surrounded" value(s) in a template required for conflict detection. This includes variables used in hosts and data in certain TXT records.</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<div id="_oauth_flow_requesting_an_access_token">
<section id="section-8.3.4">
          <h4 id="name-oauth-flow-requesting-an-ac">
<a href="#section-8.3.4" class="section-number selfRef">8.3.4. </a><a href="#name-oauth-flow-requesting-an-ac" class="section-name selfRef">OAuth Flow: Requesting an Access Token</a>
          </h4>
<div id="_4c9f424b-fae6-f2b9-ad8d-af88f34e0ec9">
<div class="sourcecode" id="section-8.3.4-1">
<pre>POST

{urlAPI}/v2/oauth/access_token</pre><a href="#section-8.3.4-1" class="pilcrow">¶</a>
</div>
</div>
<div id="_d91508ad-e3ed-ce36-86e3-944bd8858c3e">
<p id="section-8.3.4-2">Once authorization has been granted, the Service Provider MUST use the Authorization Code provided to request an Access Token. The OAuth specification recommends that the Authorization Code be a short lived token, and a reasonable recommended setting is ten minutes, however the specific setup would depend on specifics of DNS Provider's implementation. As such this exchange needs to be completed before that time has expired or the process will need to be repeated.<a href="#section-8.3.4-2" class="pilcrow">¶</a></p>
</div>
<div id="_73ee474d-5765-85a7-e749-77c86f5d342c">
<p id="section-8.3.4-3">This token exchange is typically done via a server to server API call from the
Service Provider to the DNS Provider using a POST. When called in this manner a
secret is provided
along with the Authorization Code.<a href="#section-8.3.4-3" class="pilcrow">¶</a></p>
</div>
<div id="_b0d955cc-8f49-9e5b-5e02-6d58d314a356">
<p id="section-8.3.4-4">OAuth does allow for retrieving the access token without a secret. This is typically
done when the OAuth client is a client application.
When onboarding with the DNS Provider this would need to be enabled.<a href="#section-8.3.4-4" class="pilcrow">¶</a></p>
</div>
<div id="_44e91723-6924-7d5c-e6e0-27d426e7aa60">
<p id="section-8.3.4-5">When the secret is provided (which is the normal case), care must be taken. A malicious
user could create a domain that returns a false _`domainconnect` TXT record, and
subsequently a JSON call to their own server for the API end point. By doing so, they
could then run Domain Connect on their domain and retrieve the secret.<a href="#section-8.3.4-5" class="pilcrow">¶</a></p>
</div>
<div id="_aefe7c45-ee56-d766-b207-ac8a4dee2d0f">
<p id="section-8.3.4-6">As such the urlAPI used for OAuth by the Service Provider SHOULD be maintained per DNS Provider and not the value retrieved during discovery or other measures have to be implemented to prevent token leakage.<a href="#section-8.3.4-6" class="pilcrow">¶</a></p>
</div>
<div id="_6696e999-309b-24a3-6c21-9407a5315b76">
<p id="section-8.3.4-7">The following table describes the POST parameters that MUST be included in the
request for the access token unless otherwise indicated.
The parameters SHALL be accepted via the
query string or the body of the post. This is again particularly
important for the <code>client_secret</code>, as passing secrets via a query string
is generally frowned upon given that various systems often log URLs.<a href="#section-8.3.4-7" class="pilcrow">¶</a></p>
</div>
<div id="_949cdc5f-7756-2bc8-6a9a-8baae21f0a2a">
<p id="section-8.3.4-8">The body of the post is application/json encoded.<a href="#section-8.3.4-8" class="pilcrow">¶</a></p>
</div>
<span id="name-parameters-of-the-token-end"></span><div id="_b1790759-18ca-69af-355c-db3ae521d350">
<table class="center" id="table-8">
            <caption>
<a href="#table-8" class="selfRef">Table 8</a>:
<a href="#name-parameters-of-the-token-end" class="selfRef">parameters of the token end-point</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Property</th>
                <th class="text-left" rowspan="1" colspan="1">Key</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Authorization Code/Refresh Code</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">code/refresh_token</td>
                <td class="text-left" rowspan="1" colspan="1">(REQUIRED) The authorization code that was
provided in the previous step when the user accepted the
authorization request, or the refresh_token for a subsequent access
token.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Redirect URI</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">redirect_uri</td>
                <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) This is REQUIRED if a redirect_uri was
passed to request the authorization code. When included, it needs to be
the same redirect_uri provided in this step.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Grant type</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">grant_type</td>
                <td class="text-left" rowspan="1" colspan="1">(REQUIRED) The type of code in the request. Usually the string 'authorization_code' or 'refresh_token'</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Client ID</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">client_id</td>
                <td class="text-left" rowspan="1" colspan="1">(REQUIRED) This is the client id that was provided by the DNS Provider to the Service Provider during
registration</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Client Secret</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">client_secret</td>
                <td class="text-left" rowspan="1" colspan="1">(REQUIRED) The secret provided to the Service Provider during registration. Typically required
unless the rare circumstance with secret-less OAuth.</td>
              </tr>
            </tbody>
          </table>
</div>
<div id="_3b5cb383-107c-affe-d692-9ca3aa006a1e">
<p id="section-8.3.4-10">Upon successful token exchange, the DNS Provider MUST return a response with 4 properties in the body of the response.<a href="#section-8.3.4-10" class="pilcrow">¶</a></p>
</div>
<span id="name-properties-of-the-token-end"></span><div id="_21a4bce2-0d9c-6972-2b82-a9377e44b84d">
<table class="center" id="table-9">
            <caption>
<a href="#table-9" class="selfRef">Table 9</a>:
<a href="#name-properties-of-the-token-end" class="selfRef">properties of the token end-point response</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Property</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>access_token</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">The access token to be used when making API requests</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>token_type</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">Always the string "bearer"</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>expires_in</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">The number of seconds until the access_token expires</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>refresh_token</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">The token that can be used to request new access tokens when this one has expired.</td>
              </tr>
            </tbody>
          </table>
</div>
<span id="name-http-status-codes-of-the-to"></span><div id="_4589e8fa-c569-9d3d-0c27-9162a1d67c85">
<table class="center" id="table-10">
            <caption>
<a href="#table-10" class="selfRef">Table 10</a>:
<a href="#name-http-status-codes-of-the-to" class="selfRef">http status codes of the token end-point response</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Status</th>
                <th class="text-left" rowspan="1" colspan="1">Response</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Success</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">2xx</td>
                <td class="text-left" rowspan="1" colspan="1">A response of an http status code of 2xx indicates that the
call was successful. The response is the JSON described above.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Errors</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">4**</td>
                <td class="text-left" rowspan="1" colspan="1">All other responses indicate an error.</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<div id="_oauth_flow_making_requests_with_access_tokens">
<section id="section-8.3.5">
          <h4 id="name-oauth-flow-making-requests-">
<a href="#section-8.3.5" class="section-number selfRef">8.3.5. </a><a href="#name-oauth-flow-making-requests-" class="section-name selfRef">OAuth Flow: Making Requests with Access Tokens</a>
          </h4>
<div id="_14f84f21-899b-7fa3-8af7-092c21784c90">
<p id="section-8.3.5-1">Once the Service Provider has the access token, they can call the DNS
Provider's API to make changes to DNS on the domain by applying and (OPTIONALLY)
removing authorized templates. These templates can be applied to the
Zone Apex or to any Sub Domain that has been authorized.<a href="#section-8.3.5-1" class="pilcrow">¶</a></p>
</div>
<div id="_670120d9-f907-b507-4153-7f79de3196cf">
<p id="section-8.3.5-2">All calls to this API pass the access token in the Authorization Header
of the request to the call to the API. More details can be found in the
OAuth specifications, but as an example:<a href="#section-8.3.5-2" class="pilcrow">¶</a></p>
</div>
<div id="_ab8998f9-8c2c-e107-bf0d-4274bc6c502f">
<div class="sourcecode" id="section-8.3.5-3">
<pre>GET /resource/1 HTTP/1.1

Host: example.com

Authorization: Bearer mF_9.B5f-4.1JqM</pre><a href="#section-8.3.5-3" class="pilcrow">¶</a>
</div>
</div>
<div id="_c29dc184-a154-1810-5008-59d8fe7459b7">
<p id="section-8.3.5-4">While the calls below do not have the same security consideration of
passing the secret, it is recommend that the urlAPI be from a stored
value vs. the value returned during discovery here as well.<a href="#section-8.3.5-4" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_oauth_flow_apply_template_to_domain">
<section id="section-8.3.6">
          <h4 id="name-oauth-flow-apply-template-t">
<a href="#section-8.3.6" class="section-number selfRef">8.3.6. </a><a href="#name-oauth-flow-apply-template-t" class="section-name selfRef">OAuth Flow: Apply Template to Domain.</a>
          </h4>
<div id="_3c5a0984-284a-45c8-cd7c-68f33c182e43">
<div class="sourcecode" id="section-8.3.6-1">
<pre>POST

{urlAPI}/v2/domainTemplates/providers/{providerId}/services
/{serviceId}/apply?[properties]</pre><a href="#section-8.3.6-1" class="pilcrow">¶</a>
</div>
</div>
<div id="_6799981f-ac5e-296b-99b9-46cca27e0037">
<p id="section-8.3.6-2">The primary function of the API is to apply a template to a user
domain.<a href="#section-8.3.6-2" class="pilcrow">¶</a></p>
</div>
<div id="_8a5ec8b7-b5d2-538c-f895-6a5906fdda46">
<p id="section-8.3.6-3">While the <code>providerId</code> is implied in the authorization, this is on the
path for consistency with the synchronous flows and other APIs. If not
matching what was authorized, an error MUST be returned.<a href="#section-8.3.6-3" class="pilcrow">¶</a></p>
</div>
<div id="_e08368d9-376f-4765-038a-f0353180b20f">
<p id="section-8.3.6-4">When applying a template to a domain, it is possible that a conflict may
exist with previous settings. While it is recommended that conflicts be
detected when the user grants consent, because OAuth is asynchronous it
is possible that a new conflict was introduced by the user.<a href="#section-8.3.6-4" class="pilcrow">¶</a></p>
</div>
<div id="_e0384d37-3870-f52b-e973-d33fabff6c03">
<p id="section-8.3.6-5">While it is up to the DNS Provider to determine what constitutes a
conflict (see section on Conflicts below), when one is detected calling
this API MUST return an error. This error SHOULD enumerate the
conflicting records in a format described below.<a href="#section-8.3.6-5" class="pilcrow">¶</a></p>
</div>
<div id="_62a2cc35-d999-7283-46ab-761ed9ec5d6a">
<p id="section-8.3.6-6">Because the user often isn't present at the time of this error, it is up the Service Provider to determine how to handle this condition. Some providers may decide to notify the user. Others may decide to apply their template anyway using the <code>"force"</code> parameter. This parameter will bypass error checks for conflicts, and after the call the service will be in its desired state.<a href="#section-8.3.6-6" class="pilcrow">¶</a></p>
</div>
<div id="_86c79dc2-4c52-6858-0619-beee12ee0c15">
<p id="section-8.3.6-7">Calls to apply a template via OAuth require the following parameters
posted to the above URL unless otherwise indicated.
The DNS Provider MUST accept parameters in query string or body of this
post.<a href="#section-8.3.6-7" class="pilcrow">¶</a></p>
</div>
<div id="_ad3e74b5-479c-4c1d-edf8-e8856e740e62">
<p id="section-8.3.6-8">The body is application/json encoded.<a href="#section-8.3.6-8" class="pilcrow">¶</a></p>
</div>
<span id="name-query-parameters-of-the-appl"></span><div id="_0ec56dcb-3c98-c7b8-1c2e-a8ae83aef6d7">
<table class="center" id="table-11">
            <caption>
<a href="#table-11" class="selfRef">Table 11</a>:
<a href="#name-query-parameters-of-the-appl" class="selfRef">query parameters of the apply end-point in the async flow</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Property</th>
                <th class="text-left" rowspan="1" colspan="1">Key</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Domain</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">domain</td>
                <td class="text-left" rowspan="1" colspan="1">(REQUIRED) The Zone Apex domain name being configured. It MUST match the domain that was authorized
in the token.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Host</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">host</td>
                <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) The host name of the Sub Domain that was authorized in the
token. If omitted or left blank, the template is being applied to the Zone Apex.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Name/Value Pairs</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">*</td>
                <td class="text-left" rowspan="1" colspan="1">(REQUIRED) Any variable fields consumed by
this template. The name portion of this API call corresponds to the
variable(s) specified in the record and the value corresponds to the
value that MUST be used when applying the template as per the
implementation notes.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Group ID</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">groupId</td>
                <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) Specifies the group of
changes in the template to apply. If omitted, all changes are applied.
This can also be a comma separated list of groupIds.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Force</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">force</td>
                <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) Specifies that the template SHOULD be applied independently of any conflicts that may exist on the
domain. This can be a value of 0 or 1.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Provider Name</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">providerName</td>
                <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) This parameter allows for the caller to provide additional context for the <code>providerName</code> that applied the template. It MAY be used by DNS Providers that want to display state regarding which templates have been applied. It is only allowed when the <code>"sharedProviderName"</code> attribute is set in the template being applied.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Service Name</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">serviceName</td>
                <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) This parameter allows for the caller to provide additional context for the <code>serviceName</code> that applied the template. It MAY be used by DNS Providers that want to display state regarding which templates have been applied. It is only allowed when the <code>"sharedProviderName"</code> attribute is set in the template being applied.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>InstanceId</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">instanceId</td>
                <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) Only applicable to templates supporting multiple instances
(see <span><a href="#template-definition" class="internal xref">multiInstance</a> (<a href="#template-definition" class="auto internal xref">Section 9.2</a>)</span> template property). Allows for later removal of one template instance by DNS Providers storing this information.</td>
              </tr>
            </tbody>
          </table>
</div>
<div id="_2d3ba33c-b75a-8754-8cdb-c26644580ab7">
<p id="section-8.3.6-10">An example call is below. In this example, it is contemplated that there are two variables in this template, <code>"IP"</code> and <code>"RANDOMTEXT"</code> which both require values. These variables are passed as name/value pairs.<a href="#section-8.3.6-10" class="pilcrow">¶</a></p>
</div>
<div id="_8cd30f20-1e97-282b-b78f-1bec1b0eb673">
<div class="sourcecode" id="section-8.3.6-11">
<pre>POST

https://connect.dnsprovider.example/v2/domainTemplates/providers/
exampleservice.example/services/template1/apply?IP=192.0.2.42&amp;
RANDOMTEXT=shm%3A1542108821%3AHello&amp;force=1</pre><a href="#section-8.3.6-11" class="pilcrow">¶</a>
</div>
</div>
<div id="_78cca39e-04e7-6171-416b-44882fda2b57">
<p id="section-8.3.6-12">The API MUST validate the access token, and that the domain belongs to
the user and is represented by the token being presented. Any errors
with variables, conflicting templates, or problems with the state of the
domain are returned; otherwise the template is applied.<a href="#section-8.3.6-12" class="pilcrow">¶</a></p>
</div>
<div id="_3aa4e2ef-11da-0851-f750-404bd8726b8e">
<p id="section-8.3.6-13">Results of this call can include information indicating success or an error. Errors MUST be 400 status codes, with the following codes defined.<a href="#section-8.3.6-13" class="pilcrow">¶</a></p>
</div>
<span id="name-http-status-codes-of-the-ap"></span><div id="_69a2fd50-e968-de01-7ebe-82902962269b">
<table class="center" id="table-12">
            <caption>
<a href="#table-12" class="selfRef">Table 12</a>:
<a href="#name-http-status-codes-of-the-ap" class="selfRef">http status codes of the apply end-point in the async flow</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Status</th>
                <th class="text-left" rowspan="1" colspan="1">Response</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Success</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">2xx</td>
                <td class="text-left" rowspan="1" colspan="1">Any 200 level code MUST be considered a success. The response MAY be of status 200 with a response body, but also 204 without a body.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Bad Request</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">400</td>
                <td class="text-left" rowspan="1" colspan="1">A response of a 400 indicates that the server cannot process the request because it
was malformed or had errors. This response code is intended for programming errors.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Unauthorized</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">401</td>
                <td class="text-left" rowspan="1" colspan="1">A response of a 401 indicates that caller is not
authorized to make this call. This can be because the token was revoked,
or other access issues.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Conflict</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">409</td>
                <td class="text-left" rowspan="1" colspan="1">This indicates that the call was good, and the caller authorized, but the change could not be applied due to a conflicting template. Errors due to conflicts MUST NOT be returned when force is equal to 1.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Error</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">4xx</td>
                <td class="text-left" rowspan="1" colspan="1">Other 4xx error codes SHOULD be returned when something is wrong with the request that makes applying the template problematic; most often something that is wrong with the account and requires attention.</td>
              </tr>
            </tbody>
          </table>
</div>
<div id="_55d4f6c4-6d8a-bb93-2b2a-197bcad1f58a">
<p id="section-8.3.6-15">When a 409 is returned, the body of the response SHOULD contain details of the conflicting records. If present this MUST be JSON containing the error code, a message suitable for developers, and an array of tuples containing the conflicting records type, host, and data element.<a href="#section-8.3.6-15" class="pilcrow">¶</a></p>
</div>
<div id="_56b0fbe9-08d1-6831-5b65-f78daaefa920">
<p id="section-8.3.6-16">As an example:<a href="#section-8.3.6-16" class="pilcrow">¶</a></p>
</div>
<div id="_1cdcedaa-9356-6641-e2c7-a1d29ed8db0d">
<div class="lang-json sourcecode" id="section-8.3.6-17">
<pre>{
    "code": "409",
    "message": "Conflicting records",
    "records": [
        {
            "type": "CNAME",
            "host": "www",
            "data": "@"
        },
        {
            "type": "A",
            "host": "@",
            "data": "random ip"
        }
    ]
}</pre><a href="#section-8.3.6-17" class="pilcrow">¶</a>
</div>
</div>
<div id="_c20ebd38-81b9-5a9d-611d-edd46bca311d">
<p id="section-8.3.6-18">In this example, the Service Provider tried to apply a new hosting
template. The domain had an existing service applied for hosting.<a href="#section-8.3.6-18" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_oauth_flow_revert_template">
<section id="section-8.3.7">
          <h4 id="name-oauth-flow-revert-template">
<a href="#section-8.3.7" class="section-number selfRef">8.3.7. </a><a href="#name-oauth-flow-revert-template" class="section-name selfRef">OAuth Flow: Revert Template</a>
          </h4>
<div id="_808d96ed-4ba3-57d3-8d37-7fe6f0efcd45">
<p id="section-8.3.7-1">This call reverts the application of a specific template from a domain.<a href="#section-8.3.7-1" class="pilcrow">¶</a></p>
</div>
<div id="_4426608c-8c5b-fadf-b9f9-5ec9541d2c77">
<p id="section-8.3.7-2">Implementation of this call is OPTIONAL. If not supported a 501 MUST be returned.<a href="#section-8.3.7-2" class="pilcrow">¶</a></p>
</div>
<div id="_1410b839-e767-fab6-d53f-5b4e89d892d1">
<div class="sourcecode" id="section-8.3.7-3">
<pre>POST

{urlAPI}/v2/domainTemplates/providers/{providerId}/services
/{serviceId}/revert?domain={domain}&amp;host={host}</pre><a href="#section-8.3.7-3" class="pilcrow">¶</a>
</div>
</div>
<div id="_15197e6e-a4b4-2293-928d-6b31913833ca">
<p id="section-8.3.7-4">This API allows the removal of a template from a user domain/host
using an OAuth request.<a href="#section-8.3.7-4" class="pilcrow">¶</a></p>
</div>
<div id="_e6c8269d-8882-eb8b-83c6-714e59d91f6c">
<p id="section-8.3.7-5">The provider and service name in the URL MUST match the values provided during authorization.<a href="#section-8.3.7-5" class="pilcrow">¶</a></p>
</div>
<div id="_db161e52-7783-36b3-9e4a-9eade1640c87">
<p id="section-8.3.7-6">This call MUST validate that the template exists and has been
applied to the domain by the Service Provider, or an error response with code 410 SHOULD be returned that the call would have no effect.<a href="#section-8.3.7-6" class="pilcrow">¶</a></p>
</div>
<div id="_9fe8e30d-f461-9017-813f-c6d1bb3bdab4">
<p id="section-8.3.7-7">An example query string might look like:<a href="#section-8.3.7-7" class="pilcrow">¶</a></p>
</div>
<div id="_420ca461-546a-d20e-8b51-81fa06ea3b7e">
<div class="sourcecode" id="section-8.3.7-8">
<pre>POST

https://connect.dnsprovider.example/v2/domainTemplates/providers
/exampleservice.example/services/template1/revert?domain=example.com</pre><a href="#section-8.3.7-8" class="pilcrow">¶</a>
</div>
</div>
<div id="_42cce2cc-6280-4866-5ec9-dac6f7787446">
<p id="section-8.3.7-9">Allowed parameters:<a href="#section-8.3.7-9" class="pilcrow">¶</a></p>
</div>
<span id="name-query-parameters-of-the-rev"></span><div id="_7d4a62b1-8f04-fc68-460c-3d4834e435da">
<table class="center" id="table-13">
            <caption>
<a href="#table-13" class="selfRef">Table 13</a>:
<a href="#name-query-parameters-of-the-rev" class="selfRef">query parameters of the revert end-point in the async flow</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Property</th>
                <th class="text-left" rowspan="1" colspan="1">Key</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Domain</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">domain</td>
                <td class="text-left" rowspan="1" colspan="1">(REQUIRED) The Zone Apex domain name being configured. It
MUST match the domain that was authorized in the token.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>Host</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">host</td>
                <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) The host name of the Sub Domain that was authorized in the token.
If omitted or left blank, the template is being applied to the Zone Apex.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>InstanceId</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">instanceId</td>
                <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) Only applicable to templates supporting multiple instances
(see <span><a href="#template-definition" class="internal xref">multiInstance</a> (<a href="#template-definition" class="auto internal xref">Section 9.2</a>)</span> template property). For DNS Provider storing information about applied templates allows removal of single instance of template. If missing all instances of template MUST be removed.</td>
              </tr>
            </tbody>
          </table>
</div>
<div id="_5de0c4ed-9dc6-60a5-feb5-36247c33acce">
<p id="section-8.3.7-11">The DNS Provider MUST be able to accept these on the query string or in the body of the POST with <code>application/json</code> encoding.<a href="#section-8.3.7-11" class="pilcrow">¶</a></p>
</div>
<div id="_5cf571cb-ecd7-b425-6382-be7eb89359f4">
<p id="section-8.3.7-12">Response codes Success, Authorization, and Errors are identical to
above with the addition of the 501 code.<a href="#section-8.3.7-12" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_oauth_flow_revoking_access">
<section id="section-8.3.8">
          <h4 id="name-oauth-flow-revoking-access">
<a href="#section-8.3.8" class="section-number selfRef">8.3.8. </a><a href="#name-oauth-flow-revoking-access" class="section-name selfRef">OAuth Flow: Revoking access</a>
          </h4>
<div id="_a4d5ee13-f6df-6b5f-2e3a-b2a937abdd23">
<p id="section-8.3.8-1">Like all OAuth flows, the user may revoke the access at any time using
UX at the DNS Provider site. As such the Service Provider needs to be
aware that their access to the API may be denied.<a href="#section-8.3.8-1" class="pilcrow">¶</a></p>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="_domain_connect_objects_and_templates">
<section id="section-9">
      <h2 id="name-domain-connect-objects-and-">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-domain-connect-objects-and-" class="section-name selfRef">Domain Connect Objects and Templates</a>
      </h2>
<div id="_template_versioning">
<section id="section-9.1">
        <h3 id="name-template-versioning">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-template-versioning" class="section-name selfRef">Template Versioning</a>
        </h3>
<div id="_749a6538-36a5-a1cb-0c58-3b17df9a3f6b">
<p id="section-9.1-1">If a breaking change is made to a template it is recommended that a new template be created. While on the surface versioning looks appealing, in reality this is rarely needed.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
</div>
<div id="_7deb2da7-02d4-9014-ae28-9ad305c3ce0b">
<p id="section-9.1-2">Any changes to the template need to account for existing users with settings in DNS, some applied through Domain Connect and some manual. So when changes are made, they are often backward compatible.<a href="#section-9.1-2" class="pilcrow">¶</a></p>
</div>
<div id="_09b4a162-80f2-ca5d-06ff-ec0a28c68b1f">
<p id="section-9.1-3">Note that when a template changes, it does need to be on-boarded with the DNS Providers.<a href="#section-9.1-3" class="pilcrow">¶</a></p>
</div>
<div id="_111adffd-7be7-563e-a43e-fbe3d21d0a35">
<p id="section-9.1-4">The <span><a href="#template-definition" class="internal xref">version field</a> (<a href="#template-definition" class="auto internal xref">Section 9.2</a>)</span> of the template definition serves the purpose of transparency between the DNS Provider and the Service Provider in case of such changes.<a href="#section-9.1-4" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="template-definition">
<section id="section-9.2">
        <h3 id="name-template-definition">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-template-definition" class="section-name selfRef">Template Definition</a>
        </h3>
<div id="_ae992b8b-1139-690e-f8d4-d2d7397cb93f">
<p id="section-9.2-1">A template is defined as a standard JSON data structure containing the following data. Field values MUST be defined unless otherwise indicated.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
</div>
<span id="name-properties-of-the-template-"></span><div id="_7cd98029-4bcf-0fad-b7a4-e52493701e16">
<table class="center" id="table-14">
          <caption>
<a href="#table-14" class="selfRef">Table 14</a>:
<a href="#name-properties-of-the-template-" class="selfRef">properties of the template definition</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Data Element</th>
              <th class="text-left" rowspan="1" colspan="1">Type</th>
              <th class="text-left" rowspan="1" colspan="1">Key</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Service Provider Id</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">String</td>
              <td class="text-left" rowspan="1" colspan="1">providerId</td>
              <td class="text-left" rowspan="1" colspan="1">(REQUIRED) The unique identifier of the Service Provider that created this template. This is used in the URLs to identify the Service Provider. To ensure non-coordinated uniqueness, this SHOULD be the domain name of the Service Provider (e.g. exampleservice.example).</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Service Provider Name</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">String</td>
              <td class="text-left" rowspan="1" colspan="1">providerName</td>
              <td class="text-left" rowspan="1" colspan="1">(REQUIRED) The name of the Service Provider suitable for display. This SHOULD be displayed to the user on the DNS Provider consent UX.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Service Id</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">String</td>
              <td class="text-left" rowspan="1" colspan="1">serviceId</td>
              <td class="text-left" rowspan="1" colspan="1">(REQUIRED) The name or identifier of the template.
This is used in URLs to identify the template. It is also used in the scope parameter for OAuth. It MUST NOT contain space characters, and SHOULD be URL friendly.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Service Name</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">String</td>
              <td class="text-left" rowspan="1" colspan="1">serviceName</td>
              <td class="text-left" rowspan="1" colspan="1">(REQUIRED) The name of the service suitable for display to the user. This SHOULD be displayed to the user on the DNS Provider consent UX.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Version</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">Integer</td>
              <td class="text-left" rowspan="1" colspan="1">version</td>
              <td class="text-left" rowspan="1" colspan="1">(OPTIONAL)
If present this represents a version of the template and SHOULD be changed with each update of the template content. This opaque value is mainly informational to improve communication and transparency between providers.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Logo</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">String</td>
              <td class="text-left" rowspan="1" colspan="1">logoUrl</td>
              <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) A graphical logo representing the Service Provider and/or Service for use in any web-based flow. If present this MAY be displayed to the user on the DNS Provider consent UX.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Description</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">Text</td>
              <td class="text-left" rowspan="1" colspan="1">description</td>
              <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) A textual description of what this template attempts to do. This is meant to assist developers and MUST NOT be displayed to the user.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Variable Description</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">Text</td>
              <td class="text-left" rowspan="1" colspan="1">variableDescription</td>
              <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) A textual description of what the variables are. This is meant to assist developers and MUST NOT be displayed to the user.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Synchronous Block</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">Boolean</td>
              <td class="text-left" rowspan="1" colspan="1">syncBlock</td>
              <td class="text-left" rowspan="1" colspan="1">(OPTIONAL) Indicates that the synchronous protocol MUST be disabled for this template. The default for this is false.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Shared</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">Boolean</td>
              <td class="text-left" rowspan="1" colspan="1">shared</td>
              <td class="text-left" rowspan="1" colspan="1">(OPTIONAL)
This flag has been deprecated. It used to indicate that the template allowed a dynamic <code>providerName</code> on the query string. It is replaced with the <code>sharedProviderName</code> flag in v2.2 of the spec.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Shared Provider Name</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">Boolean</td>
              <td class="text-left" rowspan="1" colspan="1">sharedProviderName</td>
              <td class="text-left" rowspan="1" colspan="1">(OPTIONAL)
This flag indicates that the template allows the caller to pass in additional information for the <code>providerName</code>. This information SHOULD augment the display of the <code>providerName</code> from the template. The default for this is false. For backward compatability with DNS Providers not at V2.2 of the spec it is recommended that the shared flag also be set.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Shared Service Name</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">Boolean</td>
              <td class="text-left" rowspan="1" colspan="1">sharedServiceName</td>
              <td class="text-left" rowspan="1" colspan="1">(OPTIONAL)
This flag indicates that the template allows the caller to pass in additional information for the <code>serviceName</code>. This information SHOULD augment the display of the <code>serviceName</code> from the template. The default for this is false.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Synchronous Public Key Domain</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">String</td>
              <td class="text-left" rowspan="1" colspan="1">syncPubKeyDomain</td>
              <td class="text-left" rowspan="1" colspan="1">(OPTIONAL)
When present, indicates that calls to apply a template synchronously MUST be digitally signed. The value indicates the domain name for querying the TXT record from DNS that contains the public key used for signing.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Synchronous Redirect Domains</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">String</td>
              <td class="text-left" rowspan="1" colspan="1">syncRedirectDomain</td>
              <td class="text-left" rowspan="1" colspan="1">(OPTIONAL)
When present, this is a comma separated list of domain names for which redirects are allowed be sent to after applying a template for the synchronous flow. DNS Provider MUST NOT send redirects to any other domain name not included on this list.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Multiple Instance</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">Boolean</td>
              <td class="text-left" rowspan="1" colspan="1">multiInstance</td>
              <td class="text-left" rowspan="1" colspan="1">(OPTIONAL)
Defaults to False. When set to True, it indicates that the template
MAY be applied multiple times. This only impacts DNS Providers that
maintain template state in DNS.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Warn Phishing</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">Boolean</td>
              <td class="text-left" rowspan="1" colspan="1">warnPhishing</td>
              <td class="text-left" rowspan="1" colspan="1">(OPTIONAL)
When present, this tells the DNS Provider that the template likely contains variables susceptible to phishing attacks and the provider is unable to digitally sign the requests. When set the DNS Provider SHOULD display warnings to the user and be more verbose about the changes applied.
The default value for this is false.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Host Required</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">Boolean</td>
              <td class="text-left" rowspan="1" colspan="1">hostRequired</td>
              <td class="text-left" rowspan="1" colspan="1">(OPTIONAL)
Defaults to false. When present this indicates that the template has been authored to work only when both domain and host are provided. An example where this would be true would be a template where CNAME is set on the fully qualified domain name. This is largely informational, as most DNS Providers already enforce such rules on the DNS level anyway.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Template Records</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">Array of Template Records</td>
              <td class="text-left" rowspan="1" colspan="1">records</td>
              <td class="text-left" rowspan="1" colspan="1">(REQUIRED) A list of records for the template.</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="template-record">
<section id="section-9.3">
        <h3 id="name-template-record">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-template-record" class="section-name selfRef">Template Record</a>
        </h3>
<div id="_d2d223ff-36f8-8143-d6e0-a97908d0d0ec">
<p id="section-9.3-1">Each template record is an entry that contains a type and several
other values depending on the type.<a href="#section-9.3-1" class="pilcrow">¶</a></p>
</div>
<div id="_9df423a5-2767-5f1b-377a-6b4d5d828039">
<p id="section-9.3-2">Many of these values can contain variables. There are three built in variables.<a href="#section-9.3-2" class="pilcrow">¶</a></p>
</div>
<ul class="normal">
<li class="normal" id="section-9.3-3.1">%host%: This is the host passed from the query string<a href="#section-9.3-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.3-3.2">%domain%: This is the domain passed from the query string<a href="#section-9.3-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.3-3.3">%fqdn%: This is the fully qualified domain name e.g. [host.]domain<a href="#section-9.3-3.3" class="pilcrow">¶</a>
</li>
        </ul>
<div id="_66936557-6aa5-8d7a-4b61-ea0b449adf70">
<p id="section-9.3-4">The @ symbol has special meaning, and can be used in the host/name field or in
the pointsTo/data field in isolation.<a href="#section-9.3-4" class="pilcrow">¶</a></p>
</div>
<div id="_41623e6b-a9de-7e8a-8e46-23012d4c6116">
<p id="section-9.3-5">For the host/name field it is a shortcut for the value "%fqdn%.". When applying the
template to a domain only, it represents "example.com.". When applying with a sub-domain
(host) it represents "subdomain.example.com.".<a href="#section-9.3-5" class="pilcrow">¶</a></p>
</div>
<div id="_97e3e108-fe30-1251-6f0b-c8d774d6f8e9">
<p id="section-9.3-6">Note: The trailing dot here is equal to the DNS master file notation <span>[<a href="#RFC1035" class="cite xref">RFC1035</a>]</span>, which indicates the value
is absolute. Without the trailing ".", the value in this field is relative to the [host.]example.com
value.<a href="#section-9.3-6" class="pilcrow">¶</a></p>
</div>
<div id="_e3472f1a-8c3c-772d-4280-fd3d40bb0389">
<p id="section-9.3-7">For the pointsTo/data field it is a shortcut for for the "%fqdn%". When appling
the template to a domain only, it represents "example.com". When applying with a sub-
domain (host) it represents "subdomain.example.com".<a href="#section-9.3-7" class="pilcrow">¶</a></p>
</div>
<div id="_d70e7969-50de-96df-11fa-586c9d88ef6b">
<p id="section-9.3-8">Note: The pointsTo and data files are always absolute for these fields.<a href="#section-9.3-8" class="pilcrow">¶</a></p>
</div>
<div id="_e1ed7b9f-4d2c-5a2e-01d7-83ab518a378b">
<p id="section-9.3-9">It is noted that as a best practice the variable portions SHOULD be constrained to as small as possible a portion of the resulting DNS record.<a href="#section-9.3-9" class="pilcrow">¶</a></p>
</div>
<div id="_50859a7c-f3fb-b6aa-40e1-1e238f087f08">
<p id="section-9.3-10">For example, say a Service Provider requires a CNAME of one of three
values for their users: s01.example.com, s02.example.com, and
s03.example.com.<a href="#section-9.3-10" class="pilcrow">¶</a></p>
</div>
<div id="_fe93ac83-1241-87d7-54a4-8a5a3a342464">
<p id="section-9.3-11">The value in the template could simply contain <code>%servercluster%</code>, and the fully qualified string passed in. Alternatively, the value in the
template could contain <code>%var%.example.com</code> and a value of <code>01</code>, <code>02</code>, or <code>03</code> passed in. By placing more fixed data into the template, the template is more secure.<a href="#section-9.3-11" class="pilcrow">¶</a></p>
</div>
<div id="_86a9e64e-acf3-5172-28f2-8795ed3719b4">
<p id="section-9.3-12">Each record MUST contain the following elements unless otherwise specified.<a href="#section-9.3-12" class="pilcrow">¶</a></p>
</div>
<span id="name-properties-of-the-template-r"></span><div id="_107fc1c6-a59a-6669-21a5-550a93786df0">
<table class="center" id="table-15">
          <caption>
<a href="#table-15" class="selfRef">Table 15</a>:
<a href="#name-properties-of-the-template-r" class="selfRef">properties of the template record definition</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Data Element</th>
              <th class="text-left" rowspan="1" colspan="1">Type</th>
              <th class="text-left" rowspan="1" colspan="1">Key</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Type</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">enum</td>
              <td class="text-left" rowspan="1" colspan="1">type</td>
              <td class="text-left" rowspan="1" colspan="1">(REQUIRED) Describes the type of record in DNS, or the operation impacting DNS.<br>

Valid values include: A, AAAA, CNAME, MX, TXT, SRV, or SPFM.<br>
The DNS Provider MUST support the core set of records A, AAAA, CNAME, MX, TXT, SRV.<br>
The DNS Provider SHOULD support SPFM record for high interoperability with existing templates<br>
                <br>
All other record types MAY be specified by type name as listed in IANA registry for DNS Resource Record (RR) TYPEs. Unknown record types MAY be specified as per <span>[<a href="#RFC3597" class="cite xref">RFC3597</a>]</span> by the word "TYPE" immediately followed by the decimal RR type number, with no intervening whitespace. Support for other record types is OPTIONAL.<br>

For each type, additional fields would be REQUIRED.<br>
* A: host, pointsTo, TTL<br>
* AAAA: host, pointsTo, TTL<br>
* CNAME: host, pointsTo, TTL (host MUST NOT be null or @ unless <code>hostRequired</code> is defined <code>true</code> for the template)<br>
* NS: host, pointsTo, TTL (host MUST NOT be null or @ unless <code>hostRequired</code> is defined <code>true</code> for the template)<br>
* TXT: host, data, TTL, txtConflict-MatchingMode, txtConflict-MatchingPrefix<br>
* MX: host, pointsTo, TTL, priority<br>
* SRV: name, target, TTL, priority, protocol, service, weight, port<br>
* SPFM: host, spfRules<br>
* other record types: host, data, TTL<br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Group Id</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">String</td>
              <td class="text-left" rowspan="1" colspan="1">groupId</td>
              <td class="text-left" rowspan="1" colspan="1">(OPTIONAL)
This parameter identifies the group the record belongs to when applying changes. This MUST NOT contain variables.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Essential</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">enum</td>
              <td class="text-left" rowspan="1" colspan="1">essential</td>
              <td class="text-left" rowspan="1" colspan="1">(OPTIONAL)
This parameter indicates how the record is treated during conflict detection with
existing templates.<br>

If the DNS Provider is not implementing applied template state in DNS this is ignored.<br>

Always (default) - record MUST be applied and kept with the template<br>

OnApply - record MUST be applied but can be later removed without dropping the whole
template<br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Host</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">String</td>
              <td class="text-left" rowspan="1" colspan="1">host</td>
              <td class="text-left" rowspan="1" colspan="1">(REQUIRED) The host for A, AAAA, CNAME, NS, TXT, MX and other unspecified record type values.<br>

This value is relative to the applied host and domain, unless trailed by a ".".<br>

A value of empty or <code>@</code> indicates the root of the applied host and domain. In other words <code>"[host.]example.com."</code>.<br>

This value SHOULD NOT contain variables unless absolutely necessary. This is discussed below.<br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Name</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">String</td>
              <td class="text-left" rowspan="1" colspan="1">name</td>
              <td class="text-left" rowspan="1" colspan="1">The name for the SRV record.<br>

This value is relative to the applied host and domain. A value of empty or <code>@</code> indicates the root of the applied host and domain.<br>

This value SHOULD NOT contain variables unless absolutely necessary. This is discussed below.<br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Points To</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">String</td>
              <td class="text-left" rowspan="1" colspan="1">pointsTo</td>
              <td class="text-left" rowspan="1" colspan="1">The pointsTo location for A, AAAA, CNAME, NS and MX records.<br>

A value of empty or @ indicates the host and domain name being applied or [host.]example.com<br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>TTL</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">Int or string repr. of Int</td>
              <td class="text-left" rowspan="1" colspan="1">ttl</td>
              <td class="text-left" rowspan="1" colspan="1">The time-to-live for the record in DNS. Valid
for A, AAAA, CNAME, NS, TXT, MX, and SRV records.
In order to avoid operational unpredactibility of the template and the challenges outlined below this SHOULD NOT contain variables unless absolutely necessary. If it does, the variable MUST be included as string in the template definition to build a valid JSON and the variable MUST be the only value content. Prefixes, suffixes or multiple variables MUST NOT be used.

This value, no matter if variable or constant, is understood as "best effort" by DNS Provider and MAY be limited or adjusted by local policy at runtime or during template onboarding, like applying a certain minimum or maximum value of TTL or an enumeration of TTL values supported by the DNS Provider. The DNS Provider SHOULD NOT reject template application because of invalid value, rather pick the nearest supported value or a default, in order to avoid necessity of per provider adjustment to the application flow.

Support of variables in this field is OPTIONAL for DNS Provider.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Data</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">String</td>
              <td class="text-left" rowspan="1" colspan="1">data</td>
              <td class="text-left" rowspan="1" colspan="1">The data for a TXT record in DNS.
A value of empty or @ indicates the host and domain name being applied or [host.]example.com

For any unspecified record type this field contains the canonical presentation format of the given record. The representation SHALL follow <span>[<a href="#RFC3597" class="cite xref">RFC3597</a>]</span> as generic or type-specific encoding. This MUST NOT be used for any record type explicitly listed in the Type field with specific data fields.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>TXT Conflict Matching Mode</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">String</td>
              <td class="text-left" rowspan="1" colspan="1">txtConflictMatchingMode</td>
              <td class="text-left" rowspan="1" colspan="1">Describes how conflicts on the TXT record are detected. Possible values are
None, All, or Prefix. The default value is None. <span><a href="#record-types-conflicts" class="internal xref">See below</a> (<a href="#record-types-conflicts" class="auto internal xref">Section 10.3</a>)</span>.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>TXT Conflict Matching Prefix</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">String</td>
              <td class="text-left" rowspan="1" colspan="1">txtConflictMatchingPrefix</td>
              <td class="text-left" rowspan="1" colspan="1">The prefix to detect conflicts when txtConflict-MatchingMode is "Prefix". This
MUST NOT contain variables. <span><a href="#record-types-conflicts" class="internal xref">See below</a> (<a href="#record-types-conflicts" class="auto internal xref">Section 10.3</a>)</span>.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Priority</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">Int or string repr. of Int</td>
              <td class="text-left" rowspan="1" colspan="1">priority</td>
              <td class="text-left" rowspan="1" colspan="1">The priority for an MX or SRV record.
This MAY contain variable but if it does the variable MUST be included as string in the template definition to build a valid JSON and the variable MUST be the only content of the value field. Prefixes, suffixes or multiple variables MUST NOT be used.

Support of variables in this field is OPTIONAL for DNS Provider.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Weight</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">Int or string repr. of Int</td>
              <td class="text-left" rowspan="1" colspan="1">weight</td>
              <td class="text-left" rowspan="1" colspan="1">The weight for the SRV record.
This MAY contain variable but if it does the variable MUST be included as string in the template definition to build a valid JSON and the variable MUST be the only content of the value field. Prefixes, suffixes or multiple variables MUST NOT be used.

Support of variables in this field is OPTIONAL for DNS Provider.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Port</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">Int or string repr. of Int</td>
              <td class="text-left" rowspan="1" colspan="1">port</td>
              <td class="text-left" rowspan="1" colspan="1">The port for the SRV record.
This MAY contain variable but if it does the variable MUST be included as string in the template definition to build a valid JSON and the variable MUST be the only content of the value field. Prefixes, suffixes or multiple variables MUST NOT be used.

Support of variables in this field is OPTIONAL for DNS Provider.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Protocol</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">String</td>
              <td class="text-left" rowspan="1" colspan="1">protocol</td>
              <td class="text-left" rowspan="1" colspan="1">The protocol for the SRV record.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Service</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">String</td>
              <td class="text-left" rowspan="1" colspan="1">service</td>
              <td class="text-left" rowspan="1" colspan="1">The symbolic name for the SRV record.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Target</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">String</td>
              <td class="text-left" rowspan="1" colspan="1">target</td>
              <td class="text-left" rowspan="1" colspan="1">The target for the SRV record.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>SPF Rules</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">String</td>
              <td class="text-left" rowspan="1" colspan="1">spfRules</td>
              <td class="text-left" rowspan="1" colspan="1">These are desired rules for the SPF TXT record. These rules SHOULD be merged with other SPFM records into final SPF TXT record. See <a href="#spf-record-merging" class="auto internal xref">Section 10.10</a>.</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
</section>
</div>
<div id="_template_considerations">
<section id="section-10">
      <h2 id="name-template-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-template-considerations" class="section-name selfRef">Template Considerations</a>
      </h2>
<div id="_template_state_in_dns">
<section id="section-10.1">
        <h3 id="name-template-state-in-dns">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-template-state-in-dns" class="section-name selfRef">Template State in DNS</a>
        </h3>
<div id="_35309921-ce5a-6a2e-1dc0-bb4b2e8032a4">
<p id="section-10.1-1">DNS Providers may choose to maintain state inside records in DNS indicating the templates writing the records.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
</div>
<div id="_c2c3c252-c1eb-b510-8d5d-da76bb3cc884">
<p id="section-10.1-2">A DNS Provider that maintains this state may be able to provide an improved experience for users, telling them the services enabled. They also may be able to have more advanced handling of conflicts.<a href="#section-10.1-2" class="pilcrow">¶</a></p>
</div>
<div id="_cc977f71-9ee4-4ce6-f3b2-b61fb072973c">
<p id="section-10.1-3">To make the implementation burden reasonable for DNS Providers, Domain Connect does not dictate the approach.<a href="#section-10.1-3" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_disclosure_of_changes_and_conflicts">
<section id="section-10.2">
        <h3 id="name-disclosure-of-changes-and-c">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-disclosure-of-changes-and-c" class="section-name selfRef">Disclosure of Changes and Conflicts</a>
        </h3>
<div id="_03e3eb18-dfa9-1826-818d-bcff89c92b0c">
<p id="section-10.2-1">It is left to the discretion of the DNS Provider to determine what is disclosed to the user
when granting permission and/or applying changes to DNS.
This includes disclosing the records being applied and the records
that may be overwritten.<a href="#section-10.2-1" class="pilcrow">¶</a></p>
</div>
<div id="_e7570b56-0ca1-fc52-91d2-b4937a573cfa">
<p id="section-10.2-2">For changes being made, one DNS Provider
may decide to simply tell the user the name of the service being enabled. Another
may decide to display the records being set. And another
may progressively display both.<a href="#section-10.2-2" class="pilcrow">¶</a></p>
</div>
<div id="_4dd16918-db3e-1903-f055-6d8823457641">
<p id="section-10.2-3">For conflict detection, one DNS Provider may simply overwrite changed records without warning. Another may detect conflicts and warn the user of the records that will change. And another may implement logic to further detect, warn, and remove any of the existing templates that overlap with the new template once applied (this assumes they are a DNS Provider that maintains template state in DNS).<a href="#section-10.2-3" class="pilcrow">¶</a></p>
</div>
<div id="_927fad37-208b-f437-3971-e5ad01f89136">
<p id="section-10.2-4">As an example, consider applying a template that sets two records (recordA and recordB) into a zone. Next consider applying a second template that overlaps with the first template (recordB and recordC). If the DNS maintains template state and removes conflicting templates, applying the second template would remove the first template. Application of the second template would conflict with recordB and the entire first template would be removed.<a href="#section-10.2-4" class="pilcrow">¶</a></p>
</div>
<div id="_d2359d04-5882-0d81-9844-09a42e0fa175">
<p id="section-10.2-5">Manual changes made by the user at the DNS Provider may also have
appropriate warnings in place to prevent unwanted changes; with
overrides being possible and removal of conflicting templates.<a href="#section-10.2-5" class="pilcrow">¶</a></p>
</div>
<div id="_eea930df-b43f-7faf-4101-6918aa75e856">
<p id="section-10.2-6">For the synchronous flow, this happens while the user is present.<a href="#section-10.2-6" class="pilcrow">¶</a></p>
</div>
<div id="_e520ff00-2f16-d74c-6a36-102af7f13139">
<p id="section-10.2-7">For the asynchronous flow, the consent UX is similar. However, the changes are made later
using the API and OAuth. The DNS Provider MAY decide to detect conflicts and
return these from the API without applying the change using the proper response code.
If the force parameter is set, the changes MUST be applied regardless of conflicts.<a href="#section-10.2-7" class="pilcrow">¶</a></p>
</div>
<div id="_b522ca2c-f9e7-79ad-3d06-5939f4363dc5">
<p id="section-10.2-8">It is ultimately left to the DNS Provider to determine the amount of
disclosure and/or conflict detection. The only requirement is that after
a template is applied the new records MUST be applied in totality.<a href="#section-10.2-8" class="pilcrow">¶</a></p>
</div>
<div id="_891279ba-6fab-bb45-93f9-53229e46b8b5">
<p id="section-10.2-9">A reasonable set of recommendations for the UX might consist of:<a href="#section-10.2-9" class="pilcrow">¶</a></p>
</div>
<ul class="normal">
<li class="normal" id="section-10.2-10.1">The consent UX SHOULD inform the user of the service that will be enabled. If the user want to know the specifics, the DNS Provider could provide a "show details" link to the user. This could display to them the specific records that are being set in DNS.<a href="#section-10.2-10.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.2-10.2">If there are conflicts, either at the template or record level, the consent UX SHOULD warn the user about these conflicts. For templates, this would be services that would be disabled. For records, this would be records that would be deleted or overwritten. This could be progressively disclosed.<a href="#section-10.2-10.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="record-types-conflicts">
<section id="section-10.3">
        <h3 id="name-record-types-and-conflicts">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-record-types-and-conflicts" class="section-name selfRef">Record Types and Conflicts</a>
        </h3>
<div id="_ed8c1eba-75b6-8ad4-deb4-418d2e75573e">
<p id="section-10.3-1">Conflict detection done by the DNS Provider prior to template application has to take
into consideration specifics of each DNS record type. The rules outlined below
ensure predictable conflict resolution between DNS Providers. Each rule applies to
the records on the very same host, unless specifed otherwise.<a href="#section-10.3-1" class="pilcrow">¶</a></p>
</div>
<ul class="normal">
<li class="normal" id="section-10.3-2.1">CNAME record conflicts with TXT, MX, AAAA, A and existing CNAME records, and any other records of these
types conflict with an existing CNAME record. Note: CNAME records cannot be at the root of the zone.<a href="#section-10.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.3-2.2">NS records conflict with all other records. This includes of the same host, and for any record ending with the NS host. For example, an NS record of foo will conflict with any foo, <code>www.foo</code>, <code>bar.foo</code>, etc. Similarly all
other record type conflict with NS records in the same manner.<a href="#section-10.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.3-2.3">MX, SRV records always conflict with records of the same type<a href="#section-10.3-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.3-2.4">A and AAAA records conflict with any other A and/or AAAA record, to avoid IPv4
and IPv6 pointing to different services.<a href="#section-10.3-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.3-2.5">
            <div id="_6384cf60-7267-995e-be73-aa17f00d37eb">
<p id="section-10.3-2.5.1">TXT records conflict detection is handled looking at txtConflictMatchingMode
parameter<a href="#section-10.3-2.5.1" class="pilcrow">¶</a></p>
</div>
<ul class="normal">
<li class="normal" id="section-10.3-2.5.2.1">None: This indicates that the TXT records do not conflict with any other TXT
record. This is the default setting, if not specified.<a href="#section-10.3-2.5.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-10.3-2.5.2.2">All: This indicates that the TXT records conflict with any other TXT record<a href="#section-10.3-2.5.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-10.3-2.5.2.3">Prefix: This indicates that TXT record conflict with any other TXT containing value starting with
txtConflictMatchingPrefix<a href="#section-10.3-2.5.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="_apply_re_apply_and_multi_instance">
<section id="section-10.4">
        <h3 id="name-apply-re-apply-and-multi-in">
<a href="#section-10.4" class="section-number selfRef">10.4. </a><a href="#name-apply-re-apply-and-multi-in" class="section-name selfRef">Apply, Re-apply, and Multi-Instance</a>
        </h3>
<div id="_d50411ad-c072-52f7-b5c8-ab8595bdc97d">
<p id="section-10.4-1">There is an additional consideration for DNS Providers that maintain the state of an applied template when re-applying a template.<a href="#section-10.4-1" class="pilcrow">¶</a></p>
</div>
<div id="_57a15188-37f0-0894-7595-e3b007a85216">
<p id="section-10.4-2">To avoid unnecessary conflict warnings to the user, under normal use when re-applying a template such a DNS Provider SHOULD remove the previously applied template on the same host.<a href="#section-10.4-2" class="pilcrow">¶</a></p>
</div>
<div id="_5d68176e-984b-32eb-5ed2-0b94d44ca492">
<p id="section-10.4-3">This may not be desireable for all templates, as a limited set of templates are designed to be applied multiple times. To faciliate this the template can have the flag <span><a href="#template-definition" class="internal xref">multiInstance</a> (<a href="#template-definition" class="auto internal xref">Section 9.2</a>)</span>
set. This tells the DNS Provider that the template is expected to be written multiple times
and that a re-apply MUST NOT remove previous instances.<a href="#section-10.4-3" class="pilcrow">¶</a></p>
</div>
<div id="_786f8d67-2a86-1fe5-a3e3-3e882b37a000">
<p id="section-10.4-4">This setting only impacts DNS Providers that maintain applied template state. DNS Providers that do not maintain applied template state can only rely on the normal conflict resolution rules, and this flag has no impact.<a href="#section-10.4-4" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="non-essential-record">
<section id="section-10.5">
        <h3 id="name-non-essential-records">
<a href="#section-10.5" class="section-number selfRef">10.5. </a><a href="#name-non-essential-records" class="section-name selfRef">Non-essential records</a>
        </h3>
<div id="_063195e4-761e-a9ed-f6d3-a9cdc5ee7835">
<p id="section-10.5-1">Typically a template specifies a list of DNS records which are required for the service.
There may be cases where some records are only required for a very short period of time, and removing or altering the record later (either by the end user or through application of another template) should not trigger conflict detection.<a href="#section-10.5-1" class="pilcrow">¶</a></p>
</div>
<div id="_13057088-0d48-5341-b61c-9b02027df588">
<p id="section-10.5-2">This can be controlled by the <span><a href="#template-record" class="internal xref">essential</a> (<a href="#template-record" class="auto internal xref">Section 9.3</a>)</span> property of a record in the template.<a href="#section-10.5-2" class="pilcrow">¶</a></p>
</div>
<div id="_e9a93138-6f82-60a3-9bf5-f5cab333334b">
<p id="section-10.5-3">Again, this setting only impacts DNS Providers that maintain applied template state.<a href="#section-10.5-3" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_template_scope">
<section id="section-10.6">
        <h3 id="name-template-scope">
<a href="#section-10.6" class="section-number selfRef">10.6. </a><a href="#name-template-scope" class="section-name selfRef">Template Scope</a>
        </h3>
<div id="_be276a2d-81ec-99cc-46c0-1ce9578b20dc">
<p id="section-10.6-1">For DNS Providers that maintain template state, an individual template is scoped to the set of records applied to a fully qualified domain. This includes the Zone Apex and the host (aka Sub Domain) at apply time.<a href="#section-10.6-1" class="pilcrow">¶</a></p>
</div>
<div id="_fee8108e-916e-fd48-ceb6-cf8c46c85209">
<p id="section-10.6-2">As an example, if a template is applied on <code>domain=example.com&amp;host=sub1</code> a later application of the template on <code>domain=example.com&amp;host=sub2</code> must be treated as a distinct template. If a conflict is detected later with the records set into <code>"sub2.example.com"</code>, only the records set with this template would be removed.<a href="#section-10.6-2" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_hostname_in_template">
<section id="section-10.7">
        <h3 id="name-host-name-in-template">
<a href="#section-10.7" class="section-number selfRef">10.7. </a><a href="#name-host-name-in-template" class="section-name selfRef">Host/Name in Template</a>
        </h3>
<div id="_88bc37ce-5bee-1e43-59b7-98d3c9903c78">
<p id="section-10.7-1">Template records contain the host name of the record to set into the zone (called name for SRV records). This value MUST be considered relative to the domain/host when the template is applied, unless followed by a trailing ".".<a href="#section-10.7-1" class="pilcrow">¶</a></p>
</div>
<div id="_011c6dd7-76be-bb43-fed1-1d1e7ef0bede">
<p id="section-10.7-2">Consider a template record of type A with a host value of "xyz". When the template is applied to a domain=example.com and an empty host value, the resulting zone after the template is applied will contain an A record of "xyz" (or "xyz.example.com." as absolute domain name in DNS master file notation).<a href="#section-10.7-2" class="pilcrow">¶</a></p>
</div>
<div id="_2894287f-c9c6-8dc2-f09a-6aa876374cad">
<p id="section-10.7-3">If the same template is applied to a domain=example.com and host=bar, the zone will contain an A
record of "xyz.bar" (or "xyz.bar.example.com." as absolute domain name).<a href="#section-10.7-3" class="pilcrow">¶</a></p>
</div>
<div id="_93bbd946-75d9-cb91-4c5a-6ca7c3109abf">
<p id="section-10.7-4">A value of @ for host in the template is a placeholder for an empty value. In other words @
would point to "bar.example.com." when the same template is applied to domain=example.com and host=bar.<a href="#section-10.7-4" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_pointsto_in_template">
<section id="section-10.8">
        <h3 id="name-pointsto-in-template">
<a href="#section-10.8" class="section-number selfRef">10.8. </a><a href="#name-pointsto-in-template" class="section-name selfRef">PointsTo in Template</a>
        </h3>
<div id="_e5b25983-698a-efa5-c62f-52f67e0ac678">
<p id="section-10.8-1">Template records of certain types contain the <code>pointsTo</code> value to set in the zone. For record types such as <code>CNAME</code> where this can be a fully qualified domain name.<a href="#section-10.8-1" class="pilcrow">¶</a></p>
</div>
<div id="_3e0338b3-c59b-71cd-2a8b-c098814674b3">
<p id="section-10.8-2">A value of <code>@</code> in <code>pointsTo</code> field in the template is a shortcut for the fully qualified domain name of the domain/host being applied.<a href="#section-10.8-2" class="pilcrow">¶</a></p>
</div>
<div id="_c33f201a-cca9-f55f-62f9-b6a6c4f98837">
<p id="section-10.8-3">Consider a template record of type <code>CNAME</code> with a <code>pointsTo</code> value of <code>"@"</code>. After a template of <code>domain=example.com</code> and an empty host is applied, the <code>pointsTo</code> value (or corresponding field) in the resulting zone would be <code>"example.com"</code>. After a template of <code>domain=example.com</code> with <code>host=bar</code> is applied, the points to value would be <code>"bar.example.com"</code>.<a href="#section-10.8-3" class="pilcrow">¶</a></p>
</div>
<div id="_142e2245-f5b0-c63a-de26-5a3c62016452">
<p id="section-10.8-4">Any domain in a <code>pointsTo</code> field in a template MUST be considered fully qualified and not relative.<a href="#section-10.8-4" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_variables">
<section id="section-10.9">
        <h3 id="name-variables">
<a href="#section-10.9" class="section-number selfRef">10.9. </a><a href="#name-variables" class="section-name selfRef">Variables</a>
        </h3>
<div id="variables-and-hosts">
<section id="section-10.9.1">
          <h4 id="name-variables-and-host-name-in-">
<a href="#section-10.9.1" class="section-number selfRef">10.9.1. </a><a href="#name-variables-and-host-name-in-" class="section-name selfRef">Variables and Host/Name in Template</a>
          </h4>
<div id="_a030fff2-510e-a852-d4c7-a51e2b4e24b9">
<p id="section-10.9.1-1">While templates do allow for variables in a host or name field values, these SHOULD be used very sparingly.<a href="#section-10.9.1-1" class="pilcrow">¶</a></p>
</div>
<div id="_2e59a7f8-d432-b44f-3c76-5dd986676dc6">
<p id="section-10.9.1-2">As an example, consider setting up hosting for a site. But instead of applying the template to a domain/host, the name of the host is placed as a variable in the template.<a href="#section-10.9.1-2" class="pilcrow">¶</a></p>
</div>
<div id="_5a9683e9-17aa-3284-19e4-bdb273da116c">
<p id="section-10.9.1-3">Such a template might contain an A record of the form:<a href="#section-10.9.1-3" class="pilcrow">¶</a></p>
</div>
<div id="_37928be3-15b5-3cb5-ea4e-ecde33d3bea1">
<div class="lang-json sourcecode" id="section-10.9.1-4">
<pre>{
    "type": "A",
    "host": "%var%",
    "pointsTo": "192.0.2.2",
    "ttl": 1800
}</pre><a href="#section-10.9.1-4" class="pilcrow">¶</a>
</div>
</div>
<div id="_7ae55530-1a8c-a2f0-063d-97f14fd7d50c">
<p id="section-10.9.1-5">This template could be applied on a domain like example.com with the var set to <code>"sub"</code>, <code>"sub1"</code>, <code>"sub2"</code>, etc.<a href="#section-10.9.1-5" class="pilcrow">¶</a></p>
</div>
<div id="_7765b6ba-3ac4-274b-1e56-1992e40fa701">
<p id="section-10.9.1-6">Application of this template would be at the domain level for <code>"example.com"</code>. This causes problems for application/re-application of the template, conflict detection, and template removal.<a href="#section-10.9.1-6" class="pilcrow">¶</a></p>
</div>
<div id="_270f6a11-6579-e48b-98d8-9cdc63573176">
<p id="section-10.9.1-7">Since this template would be applied to the domain only, DNS Providers that maintain template state would remove previous instances of the template before re-application.
This means applying this template with <code>var=sub</code> would result in the A record for sub.example.com to be set to the value <code>192.0.2.2</code>. Later, applying the template on "example.com" with the <code>var=sub2</code> should remove the old template before setting the new one. <code>sub.example.com</code> would be removed, and <code>sub2.example.com</code> would be set to the value <code>192.0.2.2</code>.<a href="#section-10.9.1-7" class="pilcrow">¶</a></p>
</div>
<div id="_b5c37903-ac57-0709-8ee4-684a4536c3c0">
<p id="section-10.9.1-8">Furthermore, determining conflicts would be impossible when the user is granting consent for asynchronous operations (OAuth). This is because the host would be indeterminate.<a href="#section-10.9.1-8" class="pilcrow">¶</a></p>
</div>
<div id="_2e608da6-8a13-b589-13f7-e7a9396d1e68">
<p id="section-10.9.1-9">To solve this problem, templates MUST be considered as scoped to a <code>domain</code> and a <code>host</code> value. For synchronous operations, the <code>host</code> value is specified in the url.
For asynchronous operations, permissions are granted for specific <code>host</code> values, whose value is later specified when applying the template.<a href="#section-10.9.1-9" class="pilcrow">¶</a></p>
</div>
<div id="_b93b8616-9c1a-7d1f-7d2a-2408651aac1b">
<p id="section-10.9.1-10">Some templates might want to utilize CNAME or TXT records with host values containing some form of user identification for validation of domain ownership, and these are often passed in variables. In those cases usage of variables in <code>host</code> field value can be applied without risk of issues mentioned above. In all other cases it is RECOMMENDED not to define variables in the <code>host</code> field.<a href="#section-10.9.1-10" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_variable_values">
<section id="section-10.9.2">
          <h4 id="name-variable-values">
<a href="#section-10.9.2" class="section-number selfRef">10.9.2. </a><a href="#name-variable-values" class="section-name selfRef">Variable Values</a>
          </h4>
<div id="_ee536b47-2236-a436-ef3d-c0af6d914e5e">
<p id="section-10.9.2-1">To allow for the use of the host name or domain name in templates, the values of <code>%host%</code> and <code>%domain%</code> are available. A third value of %fqdn% is also available. This value is the result of combining the host and domain name with the necessary ".".<a href="#section-10.9.2-1" class="pilcrow">¶</a></p>
</div>
<div id="_3f3a2f57-ad80-c520-a60a-837651b1faa1">
<p id="section-10.9.2-2">For example, with the query string <code>"domain=example.com&amp;host="</code>, <code>%fqdn%</code> in a template would be <code>"example.com"</code>, and with <code>"domain=example.com&amp;host=sub1"</code>, <code>%fqdn%</code> in a template would be <code>"sub1.example.com"</code>.<a href="#section-10.9.2-2" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_variables_and_security">
<section id="section-10.9.3">
          <h4 id="name-variables-and-security">
<a href="#section-10.9.3" class="section-number selfRef">10.9.3. </a><a href="#name-variables-and-security" class="section-name selfRef">Variables and Security</a>
          </h4>
<div id="_3d948963-ef4c-7970-524d-9f70d0987392">
<p id="section-10.9.3-1">As discussed, with variables consideration is necessary to prevent certain styles of phishing attacks.<a href="#section-10.9.3-1" class="pilcrow">¶</a></p>
</div>
<div id="_1e2f2ddd-5548-f156-183d-8ac9d973b850">
<p id="section-10.9.3-2">The more static the value in the template record, the more secure the template. When static values are not possible, a carefully crafted link could hijack DNS settings.<a href="#section-10.9.3-2" class="pilcrow">¶</a></p>
</div>
<div id="_fc8d066e-9817-9a4e-3f7b-ef1706c9a567">
<p id="section-10.9.3-3">Mitigations to this are discussed above.<a href="#section-10.9.3-3" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_variable_examples">
<section id="section-10.9.4">
          <h4 id="name-variable-examples">
<a href="#section-10.9.4" class="section-number selfRef">10.9.4. </a><a href="#name-variable-examples" class="section-name selfRef">Variable Examples</a>
          </h4>
<div id="_80bde947-1586-497a-8bb5-d285b8a75996">
<p id="section-10.9.4-1">Example template:<a href="#section-10.9.4-1" class="pilcrow">¶</a></p>
</div>
<div id="_38d83cab-19a9-802f-f9a9-5dace86e5449">
<div class="lang-json sourcecode" id="section-10.9.4-2">
<pre>[{
    "type": "CNAME",
    "host": "www",
    "pointsTo": "@",
    "ttl": 1800
},
{
    "type": "A",
    "host": "@",
    "pointsTo": "192.0.2.1",
    "ttl": 1800
}]</pre><a href="#section-10.9.4-2" class="pilcrow">¶</a>
</div>
</div>
<div id="_9ed163d6-b01b-a8d4-1af9-07f879b2fe22">
<p id="section-10.9.4-3">Template applied with <code>domain=example.com</code> and <code>host</code> parameter missing or empty:<a href="#section-10.9.4-3" class="pilcrow">¶</a></p>
</div>
<div id="_5451ac21-4512-dddc-7d76-139dd5ceeb38">
<div class="sourcecode" id="section-10.9.4-4">
<pre>www 1800 IN CNAME example.com.
@   1800 IN A 192.0.2.1</pre><a href="#section-10.9.4-4" class="pilcrow">¶</a>
</div>
</div>
<div id="_b6d784bd-4ab9-1715-87b1-5201d7b9e124">
<p id="section-10.9.4-5"><em>alternatively</em><a href="#section-10.9.4-5" class="pilcrow">¶</a></p>
</div>
<div id="_91581754-2be2-ffb0-74e3-47a4f652cf5a">
<div class="sourcecode" id="section-10.9.4-6">
<pre>www.example.com.    1800 IN CNAME example.com.
example.com.        1800 IN A 192.0.2.1</pre><a href="#section-10.9.4-6" class="pilcrow">¶</a>
</div>
</div>
<div id="_cd6e90f7-9a2b-bcbb-ed74-ee701f92cdb6">
<p id="section-10.9.4-7">Template applied with <code>domain=example.com</code> and <code>host=bar</code>:<a href="#section-10.9.4-7" class="pilcrow">¶</a></p>
</div>
<div id="_8af8c590-378e-3c8a-0f21-ebdd2b3abf34">
<div class="sourcecode" id="section-10.9.4-8">
<pre>www.bar 1800 IN CNAME bar.example.com.
bar     1800 IN A 192.0.2.1</pre><a href="#section-10.9.4-8" class="pilcrow">¶</a>
</div>
</div>
<div id="_0ff1d01f-efd8-18c4-2c19-8e7931a1fc97">
<p id="section-10.9.4-9">alternatively<a href="#section-10.9.4-9" class="pilcrow">¶</a></p>
</div>
<div id="_680070ed-aa16-8581-ae0e-c87965514d06">
<div class="sourcecode" id="section-10.9.4-10">
<pre>www.bar.example.com.    1800 IN CNAME bar.example.com.
bar.example.com.        1800 IN A 192.0.2.1</pre><a href="#section-10.9.4-10" class="pilcrow">¶</a>
</div>
</div>
</section>
</div>
</section>
</div>
<div id="spf-record-merging">
<section id="section-10.10">
        <h3 id="name-spf-txt-record">
<a href="#section-10.10" class="section-number selfRef">10.10. </a><a href="#name-spf-txt-record" class="section-name selfRef">SPF TXT Record</a>
        </h3>
<div id="_what_is_spf">
<section id="section-10.10.1">
          <h4 id="name-what-is-spf">
<a href="#section-10.10.1" class="section-number selfRef">10.10.1. </a><a href="#name-what-is-spf" class="section-name selfRef">What is SPF?</a>
          </h4>
<div id="_fb6d156a-bd93-1842-f2fc-990e6b72036d">
<p id="section-10.10.1-1">SPF stands for Sender Policy Framework specified in
<span>[<a href="#RFC7208" class="cite xref">RFC7208</a>]</span>. It is a
record that specifies a list of authorized host names and/or IP addresses from which mail
can originate from for a given domain name.<a href="#section-10.10.1-1" class="pilcrow">¶</a></p>
</div>
<div id="_5d620680-60a3-49b2-4412-4ad9248617ab">
<p id="section-10.10.1-2">It manifests itself as a TXT record.  The format of which starts with v=spf1 followed by a list of "rules" of
what to include/exclude.  If a rule passes, the mail is allowed. If it fails, it moves to the next rule.
Typical record might appear as:<a href="#section-10.10.1-2" class="pilcrow">¶</a></p>
</div>
<div id="_82d58131-5b2d-10d4-6b2c-8b8fe28ade03">
<div class="sourcecode" id="section-10.10.1-3">
<pre>v=spf1 include:policy.exampleprovider.example -all</pre><a href="#section-10.10.1-3" class="pilcrow">¶</a>
</div>
</div>
<div id="_d7cc1203-a46c-52f1-2ef3-e5b5e00d38a5">
<p id="section-10.10.1-4">This is an SPF record with two rules.  The first rule indicates that the rules for SPF record
<code>_policy.exampleprovider.example</code> be included in this record. The second rule is a catch all (<code>all</code>). The default modifier for a rule is <code>pass</code> (+). Other modifiers are <code>hard failure</code> (<code>-</code>), <code>soft failure</code> (<code>~</code>) and <code>neutral</code> (<code>?</code>).<a href="#section-10.10.1-4" class="pilcrow">¶</a></p>
</div>
<div id="_e3c4c021-7ac6-5cc3-dfd1-516b1970d9d5">
<p id="section-10.10.1-5">Note: A failure in SPF doesn't mean delivery won't happen, however depending on the policies of the receiving system, messages classified with <code>hard failure</code> or <code>soft failure</code> may not be delivered or marked as spam.<a href="#section-10.10.1-5" class="pilcrow">¶</a></p>
</div>
<div id="_1f2ccd76-8bf3-63fb-46b6-c7c1d255d682">
<p id="section-10.10.1-6">The use of "all" at the end  is pretty common, although some providers mark it as <code>~</code> (soft fail) or <code>?</code> (neutral). The reality is that a good SPF record is tuned based on what services are attached to a domain. Not just one individual service.<a href="#section-10.10.1-6" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="multiple-services">
<section id="section-10.10.2">
          <h4 id="name-multiple-services">
<a href="#section-10.10.2" class="section-number selfRef">10.10.2. </a><a href="#name-multiple-services" class="section-name selfRef">Multiple Services</a>
          </h4>
<div id="_c0d9b115-5177-a9e8-eb32-74eee8212f52">
<p id="section-10.10.2-1">If only one email sending service were active, the SPF record recommended by the provider is sufficient. But
mail from a domain can often come from several different services.<a href="#section-10.10.2-1" class="pilcrow">¶</a></p>
</div>
<div id="_bf087d47-8dc3-ea33-87b3-44069ef0eb5c">
<p id="section-10.10.2-2">A very typical use case might be end user mail and an email newsletter service.
Let's look at the SPF records recommended for individual services.<a href="#section-10.10.2-2" class="pilcrow">¶</a></p>
</div>
<div id="_f18d7c52-d185-04aa-a032-80846b594ca4">
<p id="section-10.10.2-3">Mailer1: v=spf1 include:spf.mailer1.example -all
Newsletter1: v=spf1 include:_spf.newsletter.example ~all<a href="#section-10.10.2-3" class="pilcrow">¶</a></p>
</div>
<div id="_a477c312-1138-6231-64cc-fcd8c55c4922">
<p id="section-10.10.2-4">All of these examples use the include syntax. This is fairly common. The use of all at the end is common,
although is often inconsistent with the modifier.<a href="#section-10.10.2-4" class="pilcrow">¶</a></p>
</div>
<div id="_693b9f43-171e-4e8b-1326-c0bddbe40ba6">
<p id="section-10.10.2-5">If a user installed Mailer1 and Newsletter1, their combined SPF record ought to be something like:<a href="#section-10.10.2-5" class="pilcrow">¶</a></p>
</div>
<div id="_c810b221-7012-3dd9-4f1b-0677dcfc784e">
<div class="sourcecode" id="section-10.10.2-6">
<pre>v=spf1 include:spf.mailer1.example include:_spf.newsletter.example
 ~all</pre><a href="#section-10.10.2-6" class="pilcrow">¶</a>
</div>
</div>
<div id="_a74a75b8-5435-2c13-0f4c-636c16d0ce51">
<p id="section-10.10.2-7">We combined the two rules, and in this case picked the least restrictive all modifier.<a href="#section-10.10.2-7" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_spf_record_merging">
<section id="section-10.10.3">
          <h4 id="name-spf-record-merging">
<a href="#section-10.10.3" class="section-number selfRef">10.10.3. </a><a href="#name-spf-record-merging" class="section-name selfRef">SPF Record Merging</a>
          </h4>
<div id="_c18f3cc2-71ed-ade5-8826-8b00a74dbbe0">
<p id="section-10.10.3-1">The challenge with SPF records and Domain Connect is that an individual service might recommend an SPF record. If only one service were active, this would be accurate. But with several services together only the DNS Provider is able to determine the valid shape of a SPF TXT record.<a href="#section-10.10.3-1" class="pilcrow">¶</a></p>
</div>
<div id="_869a5f6b-fa02-2bce-4144-b18b7cbf65d1">
<p id="section-10.10.3-2">One solution to this problem is to merge all related records. At the highest level, this means taking everything between the "v=spf1" and the "all" from each of the records and merging them together, terminating with hard-coded modifier on <code>all</code> at the end.  For an SPF record to fulfill it's purpose of protection against malicious email delivery, Domain Connect advises a fixed modifier <code>"~"</code> advising lower rating of the messages from other sources not specified in SPF. This setup offers a reasonable level of protection of mail delivery, on the other side does not reject the message in case forwarding facility is in place.<a href="#section-10.10.3-2" class="pilcrow">¶</a></p>
</div>
<div id="_75b10e19-322a-b28b-e809-614736e5a9f0">
<div class="sourcecode" id="section-10.10.3-3">
<pre>@ TXT v=spf1 include:spf.mailer1.example include:_spf.newsletter.exam
ple ~all</pre><a href="#section-10.10.3-3" class="pilcrow">¶</a>
</div>
</div>
<div id="_a9297820-9ee9-af64-f1b1-7efe866d5950">
<p id="section-10.10.3-4">The other would be to write intermediate records, and reference these locally.<a href="#section-10.10.3-4" class="pilcrow">¶</a></p>
</div>
<div id="_16530b16-c71e-ddc1-f1f8-3ef5bc0bb451">
<div class="sourcecode" id="section-10.10.3-5">
<pre>r1.example.com. TXT v=spf1 include:spf.mailer1.example ~all
r2.example.com. TXT v=spf1 include:_spf.newsletter.example ~all
@ TXT v=spf1 include:r1.example.com include:r2.example.com ~all</pre><a href="#section-10.10.3-5" class="pilcrow">¶</a>
</div>
</div>
<div id="_5b84b1c6-cfcc-cfc7-4fe6-94111f4e403c">
<p id="section-10.10.3-6">There are advantages and disadvantages to both approaches.  SPF records have a limit of 10 DNS lookups and record length is limited to 255 characters.  So depending on the embedded records both approaches might have advantages.<a href="#section-10.10.3-6" class="pilcrow">¶</a></p>
</div>
<div id="_a4f92cde-2a23-0641-bbd7-645e703cde3a">
<p id="section-10.10.3-7">The implementation would be left to the DNS Provider, but to facilitate this SPF records SHOULD NOT be included in templates.  Instead, a new pseudo-record type is introduced in the template called <code>SPFM</code>. This has the following attribute:<a href="#section-10.10.3-7" class="pilcrow">¶</a></p>
</div>
<span class="break"></span><div id="_28070809-b0d0-ba52-74d8-c05e1d16ef79">
<dl class="dlParallel" id="section-10.10.3-8">
            <dt id="section-10.10.3-8.1">spfRules</dt>
            <dd style="margin-left: 1.5em" id="section-10.10.3-8.2">
              <div id="_0f6eb6b9-9998-2a73-464f-e2cc4d7a580d">
<p id="section-10.10.3-8.2.1">Determines the desired rules, basically everything but leading "v=spf1" and trailing <code>all</code> rule -  see: <span><a href="#template-record" class="internal xref">SPF Rules</a> (<a href="#template-record" class="auto internal xref">Section 9.3</a>)</span><a href="#section-10.10.3-8.2.1" class="pilcrow">¶</a></p>
</div>
</dd>
          <dd class="break"></dd>
</dl>
</div>
<div id="_9b1fdcdb-ef6c-5ea4-fcf2-18191426da2f">
<p id="section-10.10.3-9">When a template is added or removed with an <code>SPFM</code> record in the template, some code would need to take the aggregate value of all <code>SPFM</code> records in all templates applied as well as existing SPF TXT record on the host and recalculate the resulting SPF TXT record. In case several sources specify the same rule with a different policy DNS Provider SHOULD apply the least restrictive one as a result. <code>soft failure</code> SHOULD be preferred over <code>hard failure</code>, <code>neutral</code> SHOULD be preferred over <code>soft failure</code>.<a href="#section-10.10.3-9" class="pilcrow">¶</a></p>
</div>
<div id="_03a718fc-04a7-17df-b012-a35963d4efa2">
<p id="section-10.10.3-10">DNS Provider SHOULD also allow the end user to modify the SPF record after merging.<a href="#section-10.10.3-10" class="pilcrow">¶</a></p>
</div>
<div id="_74d4d3f8-ff89-bd12-176a-076235346654">
<p id="section-10.10.3-11">Due to merging step in between, the resulting SPF TXT records are considered non-essential (see: <a href="#non-essential-record" class="auto internal xref">Section 10.5</a>). That means the user may decide to override the final calculated value or remove the whole SPF record. This action MUST NOT lead to removal of any related templates in conflict detection and template integrity routines if implemented by the DNS Provider.<a href="#section-10.10.3-11" class="pilcrow">¶</a></p>
</div>
<div id="_8ef0975b-1333-8f2b-2563-813432c82dc8">
<p id="section-10.10.3-12">If the existing TXT record makes the merging operation not possible, the DNS Provider MUST handle this situation the same way as a conflict and either let the end-user resolve it in the UX (both in Synchronous and Asynchronous flow) or return the conflict as an error in the Asynchronous flow unless the <code>force=true</code> parameter is used, effectively removing the existing record.<a href="#section-10.10.3-12" class="pilcrow">¶</a></p>
</div>
<div id="_ab664add-3430-6a8c-29a3-bc57f525f6e6">
<p id="section-10.10.3-13">Service Providers MUST NOT check content of TXT SPF record for an exact match, as it might be strongly influenced by the DNS Provider merging strategy and user actions.<a href="#section-10.10.3-13" class="pilcrow">¶</a></p>
</div>
<div id="_a9c8ce72-ed67-cb00-a7ae-b6af130e51f0">
<p id="section-10.10.3-14">See <a href="#example-spf-merge" class="auto internal xref">Appendix A.6</a>.<a href="#section-10.10.3-14" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_alternatives">
<section id="section-10.10.4">
          <h4 id="name-alternatives">
<a href="#section-10.10.4" class="section-number selfRef">10.10.4. </a><a href="#name-alternatives" class="section-name selfRef">Alternatives</a>
          </h4>
<div id="_e29d1567-7394-6675-6fb7-d054548c101b">
<p id="section-10.10.4-1">Some DNS Providers MAY decide not to support the SPFM record. The following alternative solution would allow general interoperability of the templates for those providers: onboard the templates with SPFM record in variable-compatible form using a regular TXT record with content <code>"v=spf1 %spfRules% ~all"</code>, using property <code>essential=OnApply</code> set to avoid removal of the whole template by a conflict.<a href="#section-10.10.4-1" class="pilcrow">¶</a></p>
</div>
</section>
</div>
</section>
</div>
<div id="repository-and-integrity">
<section id="section-10.11">
        <h3 id="name-public-template-repository">
<a href="#section-10.11" class="section-number selfRef">10.11. </a><a href="#name-public-template-repository" class="section-name selfRef">Public Template Repository</a>
        </h3>
<div id="_general_information_3">
<section id="section-10.11.1">
          <h4 id="name-general-information-3">
<a href="#section-10.11.1" class="section-number selfRef">10.11.1. </a><a href="#name-general-information-3" class="section-name selfRef">General information</a>
          </h4>
<div id="_a6e8ebc0-f662-83b7-f459-76755243e186">
<p id="section-10.11.1-1">The Public Template Repository is an open accessible location where Service Providers
MAY publish their Service Templates in the format specified in this specification.
DNS Providers MAY support all of the published templates, just a subset or none of them according
to own onboarding policies (see also: <a href="#onboarding-considerations" class="auto internal xref">Section 11.1</a>).<a href="#section-10.11.1-1" class="pilcrow">¶</a></p>
</div>
<div id="_8342b49d-bb4e-5e32-4c45-05c3c581eb55">
<p id="section-10.11.1-2">The template format is intended largely for documentation and communication between the DNS Providers and
Service Providers, and there are no codified endpoints for creation or modification of these objects.
Instead, Domain Connect references a template by ID.<a href="#section-10.11.1-2" class="pilcrow">¶</a></p>
</div>
<div id="_39aff128-42e2-374c-2494-e94bd9ab2863">
<p id="section-10.11.1-3">As such, DNS Providers may or may not use templates in this format in their internal implementations. By defining a standard template format, it is believed it will make it easier for Service Providers to share their configuration across DNS Providers.<a href="#section-10.11.1-3" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_repository_location">
<section id="section-10.11.2">
          <h4 id="name-repository-location">
<a href="#section-10.11.2" class="section-number selfRef">10.11.2. </a><a href="#name-repository-location" class="section-name selfRef">Repository Location</a>
          </h4>
<div id="_7de9a834-4142-854f-e19a-d3ed93d36985">
<p id="section-10.11.2-1">The  repository of the templates is maintained under
<span><a href="https://github.com/Domain-Connect/templates">https://github.com/Domain-Connect/templates</a></span>.<a href="#section-10.11.2-1" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="repository-file-names-requirements">
<section id="section-10.11.3">
          <h4 id="name-file-naming-requirements">
<a href="#section-10.11.3" class="section-number selfRef">10.11.3. </a><a href="#name-file-naming-requirements" class="section-name selfRef">File naming requirements</a>
          </h4>
<div id="_5b50791f-f148-23f4-f627-304ea5966455">
<p id="section-10.11.3-1">The file names in this repository MUST be all lower case, including the <code>providerId</code> and <code>serviceId</code>. As a result, while the <code>providerId</code> and <code>serviceId can be mixed case, all `providerIds</code> and <code>serviceIds</code> in this repository MUST be unique when lower case.<a href="#section-10.11.3-1" class="pilcrow">¶</a></p>
</div>
<div id="_a8017e29-6a92-30fe-cc7b-b1c14ec8e620">
<p id="section-10.11.3-2">Templates MUST be named according the following pattern: <code>{providerId}.{serviceId}.json</code><a href="#section-10.11.3-2" class="pilcrow">¶</a></p>
</div>
<div id="_063691d3-f471-32b6-469b-a4809ceb4eb5">
<div class="sourcecode" id="section-10.11.3-3">
<pre>providerId: example.com
serviceId: WebsiteBuilder

Template file name: example.com.websitebuilder.json</pre><a href="#section-10.11.3-3" class="pilcrow">¶</a>
</div>
</div>
</section>
</div>
<div id="_template_integrity">
<section id="section-10.11.4">
          <h4 id="name-template-integrity">
<a href="#section-10.11.4" class="section-number selfRef">10.11.4. </a><a href="#name-template-integrity" class="section-name selfRef">Template Integrity</a>
          </h4>
<div id="_a6a3e9ce-aff5-5df9-a683-d81c3cbdd8b6">
<p id="section-10.11.4-1">Implementers are responsible for data integrity and MUST use the record type field to validate that variable input meets the criteria for each different data type.<a href="#section-10.11.4-1" class="pilcrow">¶</a></p>
</div>
<div id="_96b87533-e975-40fc-d2cc-6e619567ffab">
<p id="section-10.11.4-2">Hard-coded host names are the responsibility of the DNS Provider to protect. That is, DNS Providers MUST ensure that host names do not interfere with known values (such as <code>m.</code> or <code>www.</code> or <code>mail.</code>) or internal names that provide critical functionality that is outside the scope of this specification.<a href="#section-10.11.4-2" class="pilcrow">¶</a></p>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="_general_considerations">
<section id="section-11">
      <h2 id="name-general-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-general-considerations" class="section-name selfRef">General considerations</a>
      </h2>
<div id="onboarding-considerations">
<section id="section-11.1">
        <h3 id="name-onboarding">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-onboarding" class="section-name selfRef">Onboarding</a>
        </h3>
<div id="_908ec1f8-a3c1-7b89-ff4a-52405dea54ac">
<p id="section-11.1-1">This specification is an open standard that describes the protocol, messages and formats used to enable Domain Connect between a Service Provider and a DNS Provider.<a href="#section-11.1-1" class="pilcrow">¶</a></p>
</div>
<div id="_3157bbd1-6c62-24bd-786e-1be23d17edc0">
<p id="section-11.1-2">Any Service Provider is free to define and publish a template. However, the terms and conditions for a DNS Provider onboarding a Service Provider template is beyond the scope of this document. A DNS Provider can be selective in what templates they support, can require a contractual relationship, or even charge a fee for onboarding.<a href="#section-11.1-2" class="pilcrow">¶</a></p>
</div>
<div id="_a4b7a26b-f236-b121-d6e9-afb471e69851">
<p id="section-11.1-3">One way a Service Provider can be selective in which DNS Providers they accept is to implement a whitelist of <code>providerIds</code>. A Service Provider who chooses to whitelist MUST use <code>providerId</code> to distinguish between unique DNS Providers. The DNS Provider's <code>providerId</code> would typically be a domain name.<a href="#section-11.1-3" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_case_sensitivity">
<section id="section-11.2">
        <h3 id="name-case-sensitivity">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-case-sensitivity" class="section-name selfRef">Case Sensitivity</a>
        </h3>
<div id="_dd84604a-d966-b8e0-55e8-38d8bfff6281">
<p id="section-11.2-1">All values are case sensitive. This includes variable names, values, parameters and objects
returned.<a href="#section-11.2-1" class="pilcrow">¶</a></p>
</div>
<div id="_dd5b0536-6a56-d4a0-a561-397f44e58759">
<p id="section-11.2-2">One exception is the domain/host name. This is because a fully qualified domain name is case insensitive.<a href="#section-11.2-2" class="pilcrow">¶</a></p>
</div>
<div id="_a51abae0-32cd-196c-402d-595c0cbe4fe3">
<p id="section-11.2-3">The values for providerId/serviceId in the template and passed through URIs in the path or query string are case sensitive. Different rules apply to the file naming in the <span><a href="#repository-file-names-requirements" class="internal xref">Public Template Repository</a> (<a href="#repository-file-names-requirements" class="auto internal xref">Section 10.11.3</a>)</span>.<a href="#section-11.2-3" class="pilcrow">¶</a></p>
</div>
</section>
</div>
</section>
</div>
<div id="_extensionsexclusions">
<section id="section-12">
      <h2 id="name-extensions-exclusions">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-extensions-exclusions" class="section-name selfRef">Extensions/Exclusions</a>
      </h2>
<div id="_general_information_4">
<section id="section-12.1">
        <h3 id="name-general-information-4">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-general-information-4" class="section-name selfRef">General information</a>
        </h3>
<div id="_51d20d9f-56ea-483f-ae60-5b952987b0c6">
<p id="section-12.1-1">Additional record types and/or extensions to records in the template can be implemented on a per DNS Provider basis. However, care should be taken when defining extensions so as to not conflict with other protocols and standards. Certain record names are reserved for use in DNS for protocols like DNSSEC (DNSKEY, RRSIG) <span>[<a href="#RFC9364" class="cite xref">RFC9364</a>]</span> at the registry level.<a href="#section-12.1-1" class="pilcrow">¶</a></p>
</div>
<div id="_0958c14d-c092-769f-f4b9-a3c952047f38">
<p id="section-12.1-2">Defining these OPTIONAL extensions in an open manner as part of this specification is done to provide consistency. The following are the initial OPTIONAL extensions a DNS Provider/Service Provider may support.<a href="#section-12.1-2" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_apexcname">
<section id="section-12.2">
        <h3 id="name-apexcname">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-apexcname" class="section-name selfRef">APEXCNAME</a>
        </h3>
<div id="_851eba50-c804-d925-f2f6-a373d44a075f">
<p id="section-12.2-1">Some Service Providers desire the behavior of a CNAME record, but in the
apex record. This would allow for an A Record at the root of the domain
but dynamically determined at runtime.<a href="#section-12.2-1" class="pilcrow">¶</a></p>
</div>
<div id="_695c2a95-7659-ee6e-5490-5bd1bfd6173a">
<p id="section-12.2-2">The recommended record type for DNS Providers that wish to support this
is an APEXCNAME record. Additional fields included with this record
would include pointsTo and TTL.<a href="#section-12.2-2" class="pilcrow">¶</a></p>
</div>
<div id="_16249cf1-9127-744f-3c16-000579c25bda">
<p id="section-12.2-3">Defining a standard for such functionality in DNS is beyond the scope of
this specification. But for DNS Providers that support this
functionality, using the same record type name across DNS Providers
allows template reuse.<a href="#section-12.2-3" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_redirection">
<section id="section-12.3">
        <h3 id="name-redirection">
<a href="#section-12.3" class="section-number selfRef">12.3. </a><a href="#name-redirection" class="section-name selfRef">Redirection</a>
        </h3>
<div id="_efa38ed6-1ea4-49a1-33b7-d493b987010c">
<p id="section-12.3-1">Some Service Providers desire a redirection service associated with the
A Record. A typical example is a service that requires a redirect of the
domain (e.g. example.com) to the www variant (www.example.com). The www
would often contain a CNAME.<a href="#section-12.3-1" class="pilcrow">¶</a></p>
</div>
<div id="_072ba9fb-1947-fd51-7df4-9c1c2b85f3f1">
<p id="section-12.3-2">Since implementation of a redirection service is typically simple, it is recommended that Service Providers implement redirection on their own.
But for DNS Providers that have a redirection service, supporting simple templates with this functionality may be desired.<a href="#section-12.3-2" class="pilcrow">¶</a></p>
</div>
<div id="_e63fab7c-45a9-c89c-0641-274adb440061">
<p id="section-12.3-3">While technically not a "record" in DNS, when supporting this OPTIONAL functionality it is recommended that this SHOULD be implemented using two new record types.<a href="#section-12.3-3" class="pilcrow">¶</a></p>
</div>
<div id="_dc51c144-0877-630e-2cd4-2c0dd880b81a">
<p id="section-12.3-4">REDIR301 and REDIR302 would implement 301 and 302 redirects respectively. Associated with this record would be a single field called the "target", containing the target url of the redirect.<a href="#section-12.3-4" class="pilcrow">¶</a></p>
</div>
<div id="_5d6467cf-fc16-50b7-b8ce-d4999ac6b6a2">
<p id="section-12.3-5">Please note, that setting up an HTTP redirect typically involves setting up a webserver and configuring A and AAAA records pointing to this webserver accordingly. The template may or may not explicitly define those records, as the orchestration and the values would we controlled by the DNS provider, not the Service Provider. The DNS Provider SHOULD however consider those records during the conflict resolution in order to give transparency of the changes to the user.<a href="#section-12.3-5" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_nameservers">
<section id="section-12.4">
        <h3 id="name-nameservers">
<a href="#section-12.4" class="section-number selfRef">12.4. </a><a href="#name-nameservers" class="section-name selfRef">Nameservers</a>
        </h3>
<div id="_40941bb5-6a7c-10e0-033e-c97e9498296a">
<p id="section-12.4-1">Several Service Providers have asked for functionality supporting an update to the nameserver records at the registry associated with the domain.<a href="#section-12.4-1" class="pilcrow">¶</a></p>
</div>
<div id="_7a190046-cae7-7908-6f59-346f35fb8d01">
<p id="section-12.4-2">When implementing this functionality a template defined at DNS Provider would need to define a set of NS records, typically a minimum of 2 and a maximum depending on the number supported by the registrar system of the DNS Provider, likely with <code>groupIds</code> to allow for optionality of those additional nameservers. Each NS entry would then contain a <code>data</code> field with desired host names or variables to allow for dynamic setup.<a href="#section-12.4-2" class="pilcrow">¶</a></p>
</div>
<div id="_2c529814-19c0-fe4b-ac44-614b82f4d494">
<p id="section-12.4-3">It will be noted that a nameserver update would require that the entity implementing DNS Provider side of the protocol is the Registrar. This is not always the case.<a href="#section-12.4-3" class="pilcrow">¶</a></p>
</div>
<div id="_05ee5372-7fd9-795f-c998-42e44aa0503a">
<p id="section-12.4-4">Additional care would have to be taken by the DNS Provider informing the user about the change happening and the impact of the change.<a href="#section-12.4-4" class="pilcrow">¶</a></p>
</div>
<div id="_1ca9934e-e17e-033f-eb28-816f09ffa75d">
<p id="section-12.4-5">This functionality is again deemed as OPTIONAL and up to the DNS Provider to determine if they will support this.<a href="#section-12.4-5" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_ds_dnssec">
<section id="section-12.5">
        <h3 id="name-ds-dnssec">
<a href="#section-12.5" class="section-number selfRef">12.5. </a><a href="#name-ds-dnssec" class="section-name selfRef">DS (DNSSEC)</a>
        </h3>
<div id="_6ec9396e-0dcb-ff27-6434-0b31a0dc3885">
<p id="section-12.5-1">Requests have been made to allow for updates to the DS record for
DNSSEC. This record is required at the registry to enable DNSSEC, but can only be written by the registrar.<a href="#section-12.5-1" class="pilcrow">¶</a></p>
</div>
<div id="_e1c62a99-843f-e696-6fdf-a239754c9829">
<p id="section-12.5-2">For DNS Providers that support this record, the record type would be DS. Values will be keyTag, algorithm, digestType, and digest.<a href="#section-12.5-2" class="pilcrow">¶</a></p>
</div>
<div id="_0a289230-1a33-3abd-bdf8-60149657826c">
<p id="section-12.5-3">Again it should be noted that a DS update would require that the entity implementing DNS Provider side of the protocol is the registrar, and is again deemed as OPTIONAL and up to the DNS Provider to determine if they will support.<a href="#section-12.5-3" class="pilcrow">¶</a></p>
</div>
</section>
</div>
</section>
</div>
<div id="iana">
<section id="section-13">
      <h2 id="name-iana-considerations">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="_d19cb766-39e2-54af-6219-8e894105a386">
<p id="section-13-1">Per <span>[<a href="#RFC8552" class="cite xref">RFC8552</a>]</span>, please add the following entry to the "Underscored and Globally Scoped DNS Node Names" registry:<a href="#section-13-1" class="pilcrow">¶</a></p>
</div>
<div id="_6a918a82-5cfc-709b-0191-b49d018bcdbd">
<table class="center" id="table-16">
        <caption><a href="#table-16" class="selfRef">Table 16</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">RR Type</th>
            <th class="text-left" rowspan="1" colspan="1">_NODE NAME</th>
            <th class="text-left" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TXT</td>
            <td class="text-left" rowspan="1" colspan="1">_domainconnect</td>
            <td class="text-left" rowspan="1" colspan="1">This document.</td>
          </tr>
        </tbody>
      </table>
</div>
</section>
</div>
<div id="_implementation_status">
<section id="section-14">
      <h2 id="name-implementation-status">
<a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
      </h2>
<p id="section-14-1">This section is to be removed before publishing as an RFC.<a href="#section-14-1" class="pilcrow">¶</a></p>
<div id="_dns_providers">
<section id="section-14.1">
        <h3 id="name-dns-providers">
<a href="#name-dns-providers" class="section-name selfRef">DNS Providers</a>
        </h3>
<div id="_open_source">
<section id="section-14.1.1">
          <h4 id="name-open-source">
<a href="#name-open-source" class="section-name selfRef">Open Source</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-14.1.1-1.1">Server library (Python):
<span><a href="https://github.com/Domain-Connect/DomainConnectApplyZone">https://github.com/Domain-Connect/DomainConnectApplyZone</a></span><a href="#section-14.1.1-1.1" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="_priopriatery_implementations">
<section id="section-14.1.2">
          <h4 id="name-priopriatery-implementation">
<a href="#name-priopriatery-implementation" class="section-name selfRef">Priopriatery implementations</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-14.1.2-1.1">~20 providers, incl. GoDaddy, IONOS, Cloudflare, Squarespace Domains
(former Google), Wordpress.com or Plesk<a href="#section-14.1.2-1.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-14.1.2-1.2">35% of the .com zone (May'24)<a href="#section-14.1.2-1.2" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="_service_providers">
<section id="section-14.2">
        <h3 id="name-service-providers">
<a href="#name-service-providers" class="section-name selfRef">Service Providers</a>
        </h3>
<div id="_open_source_2">
<section id="section-14.2.1">
          <h4 id="name-open-source-2">
<a href="#name-open-source-2" class="section-name selfRef">Open Source</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-14.2.1-1.1">Example service:
<span><a href="https://exampleservice.domainconnect.org/">https://exampleservice.domainconnect.org/</a></span>
              <span><a href="https://github.com/Domain-Connect/exampleservice">https://github.com/Domain-Connect/exampleservice</a></span><a href="#section-14.2.1-1.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-14.2.1-1.2">Client library (Python):
<span><a href="https://github.com/Domain-Connect/domainconnect_python">https://github.com/Domain-Connect/domainconnect_python</a></span><a href="#section-14.2.1-1.2" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="_priopriatery_implementations_2">
<section id="section-14.2.2">
          <h4 id="name-priopriatery-implementations">
<a href="#name-priopriatery-implementations" class="section-name selfRef">Priopriatery implementations</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-14.2.2-1.1">300 templates from over 120 providers, incl. O365, Google Workspace, Apple Cloud+, Weebly, Squarespace...
<span><a href="https://github.com/Domain-Connect/Templates">https://github.com/Domain-Connect/Templates</a></span><a href="#section-14.2.2-1.1" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="_change_history">
<section id="section-15">
      <h2 id="name-change-history">
<a href="#name-change-history" class="section-name selfRef">Change History</a>
      </h2>
<p id="section-15-1">This section is to be removed before publishing as an RFC.<a href="#section-15-1" class="pilcrow">¶</a></p>
<div id="_change_from_00_to_01">
<section id="section-15.1">
        <h3 id="name-change-from-00-to-01">
<a href="#name-change-from-00-to-01" class="section-name selfRef">Change from -00 to -01</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-15.1-1.1">Changed term Root Domain to Zone Apex to align with <span>[<a href="#RFC8499" class="cite xref">RFC8499</a>]</span>.<a href="#section-15.1-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-15.1-1.2">Removed example provider names from Service Providers and DNS Providers teminology<a href="#section-15.1-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-15.1-1.3">Cleaned up usage of terminology<a href="#section-15.1-1.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="_change_from_draft_kowalik_regext_domainconnect_00_to_draft_kowalik_domainconnect_00">
<section id="section-15.2">
        <h3 id="name-change-from-draft-kowalik-r">
<a href="#name-change-from-draft-kowalik-r" class="section-name selfRef">Change from draft-kowalik-regext-domainconnect-00 to draft-kowalik-domainconnect-00</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-15.2-1.1">Added possibility to specify any DNS record type in a generic manner.<a href="#section-15.2-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-15.2-1.2">Added possibility to define variables for numeric fields.<a href="#section-15.2-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-15.2-1.3">Added IANA registration for _domainconnect record as per <span>[<a href="#RFC8552" class="cite xref">RFC8552</a>]</span><a href="#section-15.2-1.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="_change_from_draft_carney_regext_domainconnect_03_to_draft_kowalik_regext_domainconnect_00">
<section id="section-15.3">
        <h3 id="name-change-from-draft-carney-re">
<a href="#name-change-from-draft-carney-re" class="section-name selfRef">Change from draft-carney-regext-domainconnect-03 to draft-kowalik-regext-domainconnect-00</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-15.3-1.1">Version synchronized with 2.2 version rev. 66 of the public Domain Connect specification.<a href="#section-15.3-1.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="_change_from_02_to_03">
<section id="section-15.4">
        <h3 id="name-change-from-02-to-03">
<a href="#name-change-from-02-to-03" class="section-name selfRef">Change from -02 to -03</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-15.4-1.1">Added width/height JSON values returned by DNS Provider Discovery.<a href="#section-15.4-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-15.4-1.2">Corrected text of GET method for getting the authorization token.<a href="#section-15.4-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-15.4-1.3">Added clarifying text to Group ID description parameter of the apply template POST method.  Quite a few minor edits and clarifications that were found during implementation, especially in the Implementation Considerations section.<a href="#section-15.4-1.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="_change_from_01_to_02">
<section id="section-15.5">
        <h3 id="name-change-from-01-to-02">
<a href="#name-change-from-01-to-02" class="section-name selfRef">Change from -01 to -02</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-15.5-1.1">Added new GET method for Service Providers to determine if the DNS Provider supports a specific template.  Some other minor edits for clarification.<a href="#section-15.5-1.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="_change_from_draft_carney_regext_domainconnect_00_to_01">
<section id="section-15.6">
        <h3 id="name-change-from-draft-carney-reg">
<a href="#name-change-from-draft-carney-reg" class="section-name selfRef">Change from draft-carney-regext-domainconnect-00 to -01</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-15.6-1.1">Minor edits and clarifications found during implementation.<a href="#section-15.6-1.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="_normative_references">
<section id="section-16">
      <h2 id="name-normative-references">
<a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC1035">[RFC1035]</dt>
      <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - implementation and specification"</span>, <span class="stream">IETF</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">DOI 10.17487/RFC1035</span>, <span class="seriesInfo">BCP 13</span>, <span class="seriesInfo">RFC 1035</span>, <time datetime="1987-11" class="refDate">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1035">https://www.rfc-editor.org/info/rfc1035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="stream">IETF</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="stream">IETF</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7208">[RFC7208]</dt>
      <dd>
<span class="refAuthor">Kitterman, S.</span>, <span class="refTitle">"Sender Policy Framework (SPF) for Authorizing Use of Domains in Email, Version 1"</span>, <span class="stream">IETF</span>, <span class="seriesInfo">DOI 10.17487/RFC7208</span>, <span class="seriesInfo">RFC 7208</span>, <time datetime="2014-04" class="refDate">April 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7208">https://www.rfc-editor.org/info/rfc7208</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
      <dd>
<span class="refAuthor">Hardt, D.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="stream">IETF</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <span class="seriesInfo">RFC 6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6749">https://www.rfc-editor.org/info/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3597">[RFC3597]</dt>
      <dd>
<span class="refAuthor">Gustafsson, A.</span>, <span class="refTitle">"Handling of Unknown DNS Resource Record (RR) Types"</span>, <span class="stream">IETF</span>, <span class="seriesInfo">DOI 10.17487/RFC3597</span>, <span class="seriesInfo">RFC 3597</span>, <time datetime="2003-09" class="refDate">September 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3597">https://www.rfc-editor.org/info/rfc3597</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8552">[RFC8552]</dt>
      <dd>
<span class="refAuthor">Crocker, D.</span>, <span class="refTitle">"Scoped Interpretation of DNS Resource Records through "Underscored" Naming of Attribute Leaves"</span>, <span class="stream">IETF</span>, <span class="seriesInfo">DOI 10.17487/RFC8552</span>, <span class="seriesInfo">BCP 222</span>, <span class="seriesInfo">RFC 8552</span>, <time datetime="2019-03" class="refDate">March 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8552">https://www.rfc-editor.org/info/rfc8552</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[RFC3986]</dt>
      <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="stream">IETF</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <span class="seriesInfo">BCP 66</span>, <span class="seriesInfo">RFC 3986</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7518">[RFC7518]</dt>
    <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Algorithms (JWA)"</span>, <span class="stream">IETF</span>, <span class="seriesInfo">DOI 10.17487/RFC7518</span>, <span class="seriesInfo">RFC 7518</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7518">https://www.rfc-editor.org/info/rfc7518</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="_informative_references">
<section id="section-17">
      <h2 id="name-informative-references">
<a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="RFC9364">[RFC9364]</dt>
      <dd>
<span class="refAuthor">Hoffman, P.</span>, <span class="refTitle">"DNS Security Extensions (DNSSEC)"</span>, <span class="stream">IETF</span>, <span class="seriesInfo">DOI 10.17487/RFC9364</span>, <span class="seriesInfo">BCP 237</span>, <span class="seriesInfo">RFC 9364</span>, <time datetime="2023-02" class="refDate">February 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9364">https://www.rfc-editor.org/info/rfc9364</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8499">[RFC8499]</dt>
      <dd>
<span class="refAuthor">Hoffman, P.</span>, <span class="refAuthor">Sullivan, A.</span>, and <span class="refAuthor">K. Fujiwara</span>, <span class="refTitle">"DNS Terminology"</span>, <span class="stream">IETF</span>, <span class="seriesInfo">DOI 10.17487/RFC8499</span>, <span class="seriesInfo">RFC 8499</span>, <time datetime="2019-01" class="refDate">January 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8499">https://www.rfc-editor.org/info/rfc8499</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7591">[RFC7591]</dt>
    <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Machulak, M.</span>, <span class="refAuthor">Hunt, P.</span>, and <span class="refAuthor">J. Richer</span>, <span class="refTitle">"OAuth 2.0 Dynamic Client Registration Protocol"</span>, <span class="stream">IETF</span>, <span class="seriesInfo">DOI 10.17487/RFC7591</span>, <span class="seriesInfo">RFC 7591</span>, <time datetime="2015-07" class="refDate">July 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7591">https://www.rfc-editor.org/info/rfc7591</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="_examples">
<section id="appendix-A">
      <h2 id="name-examples">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<div id="_example_template">
<section id="appendix-A.1">
        <h3 id="name-example-template">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-example-template" class="section-name selfRef">Example Template</a>
        </h3>
<div id="_191efd0a-04f8-5a98-70dc-445d2282408d">
<div class="lang-json sourcecode" id="appendix-A.1-1">
<pre>{
    "providerId": "example.com",
    "providerName": "Example Web Hosting",
    "serviceId": "hosting",
    "serviceName": "Wordpress by example.com",
    "version": 1,
    "logoUrl": "https://www.example.com/images/billthecat.jpg",
    "description": "This connects your domain to our web hosting",
    "records": [
        {
            "type": "A",
            "groupId": "service",
            "host": "www",
            "pointsTo": "%var1%",
            "ttl": 600
        },
        {
            "type": "A",
            "groupId": "service",
            "host": "m",
            "pointsTo": "%var2%",
            "ttl": 600
        },
        {
            "type": "CNAME",
            "groupId": "service",
            "host": "webmail",
            "pointsTo": "%var3%",
            "ttl": 600
        },
        {
            "type": "TXT",
            "groupId": "verification",
            "host": "example",
            "ttl": 600,
            "data": "%var4%"
        }
    ]
}</pre><a href="#appendix-A.1-1" class="pilcrow">¶</a>
</div>
</div>
</section>
</div>
<div id="_example_records_single_static_host_record">
<section id="appendix-A.2">
        <h3 id="name-example-records-single-stat">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-example-records-single-stat" class="section-name selfRef">Example Records: Single static host record</a>
        </h3>
<div id="_7824dc78-8d68-915a-d837-911cb7d537bf">
<p id="appendix-A.2-1">Consider a template for setting a single host record. The records
section of the template would have a single record of type "A" and could
have a value of:<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
</div>
<div id="_6fa9ba4b-1c57-ff27-0412-876c38b9cffd">
<div class="lang-json sourcecode" id="appendix-A.2-2">
<pre>[{
    "type": "A",
    "host": "www",
    "pointsTo": "192.0.2.1",
    "ttl": 600
}]</pre><a href="#appendix-A.2-2" class="pilcrow">¶</a>
</div>
</div>
<div id="_5f2c547d-f995-20aa-907d-34869d1e0a28">
<p id="appendix-A.2-3">This would have no variable substitution and the application of this
template to a domain would simply set the host name "www" to the IP
address "192.0.2.1"<a href="#appendix-A.2-3" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_example_records_single_variable_host_record_for_a">
<section id="appendix-A.3">
        <h3 id="name-example-records-single-vari">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-example-records-single-vari" class="section-name selfRef">Example Records: Single variable host record for A</a>
        </h3>
<div id="_64e34c26-9369-8656-8832-64ab72a78881">
<p id="appendix-A.3-1">In the case of a template for setting a single host record from a
variable, the template would have a single record of type "A" and could
have a value of:<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
</div>
<div id="_0eea237d-9d4f-1046-5fe9-7261f1eecde3">
<div class="lang-json sourcecode" id="appendix-A.3-2">
<pre>[{
    "type": "A",
    "host": "@",
    "pointsTo": "198.51.100.%srv%",
    "ttl": 600
}]</pre><a href="#appendix-A.3-2" class="pilcrow">¶</a>
</div>
</div>
<div id="_423ff008-95c8-c538-4e9d-4f1a822d4d1d">
<p id="appendix-A.3-3">A query string with a key/value pair of<a href="#appendix-A.3-3" class="pilcrow">¶</a></p>
</div>
<div id="_5c9436cf-d5bc-cc04-cef6-0eb9a852c3bd">
<div class="sourcecode" id="appendix-A.3-4">
<pre>srv=2</pre><a href="#appendix-A.3-4" class="pilcrow">¶</a>
</div>
</div>
<div id="_29e1c9b0-f7be-4e51-9cf0-afd8cee7b848">
<p id="appendix-A.3-5">would cause the application of this template to a domain to set the host
name for the apex A record to the IP address "198.51.100.2" with a TTL of
600<a href="#appendix-A.3-5" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_example_records_unspecified_record_type_caa">
<section id="appendix-A.4">
        <h3 id="name-example-records-unspecified">
<a href="#appendix-A.4" class="section-number selfRef">A.4. </a><a href="#name-example-records-unspecified" class="section-name selfRef">Example Records: Unspecified record type CAA</a>
        </h3>
<div id="_22a2eb01-c26a-2dc3-0b20-b6073b00f91b">
<p id="appendix-A.4-1">This example shows how to include a set of unspecified record types on an example of CAA records:<a href="#appendix-A.4-1" class="pilcrow">¶</a></p>
</div>
<div id="_3c054d60-d2ca-c71e-f63f-b22a2522af20">
<div class="lang-json sourcecode" id="appendix-A.4-2">
<pre>[
    {
        "type": "CAA",
        "host": "@",
        "data": "0 issue \"ca1.example.net\"",
        "ttl": 1800
    },
    {
        "type": "CAA",
        "host": "@",
        "data": "0 issuewild \"ca2.example.\"",
        "ttl": 1800
    }
]</pre><a href="#appendix-A.4-2" class="pilcrow">¶</a>
</div>
</div>
<div id="_67818e16-a617-f61c-19e2-aec64abca78b">
<p id="appendix-A.4-3">This would have no variable substitution and the application of this
template to a domain would add 2 CAA records.<a href="#appendix-A.4-3" class="pilcrow">¶</a></p>
</div>
</section>
</div>
<div id="_example_dns_zone_merging">
<section id="appendix-A.5">
        <h3 id="name-example-dns-zone-merging">
<a href="#appendix-A.5" class="section-number selfRef">A.5. </a><a href="#name-example-dns-zone-merging" class="section-name selfRef">Example: DNS Zone merging</a>
        </h3>
<div id="_e0f231cb-09e8-836a-a74a-fd4b38ebf842">
<p id="appendix-A.5-1">Consider a DNS Zone before a template application:<a href="#appendix-A.5-1" class="pilcrow">¶</a></p>
</div>
<div id="_3e420795-9e46-f5d9-4e14-0eff7950cd46">
<div class="sourcecode" id="appendix-A.5-2">
<pre>$ORIGIN example.com.

@ 3600 IN SOA ns11.example.net. support.example.net. 2017050817 7200
1800 1209600 3600
@ 3600 IN NS ns11.example.net.
@ 3600 IN NS ns12.example.net.
@ 3600 IN A 192.0.2.1
@ 3600 IN A 192.0.2.2
@ 3600 IN AAAA 2001:db8:1234:0000:0000:0000:0000:0000
@ 3600 IN AAAA 2001:db8:1234:0000:0000:0000:0000:0001
@ 3600 IN MX 10 mx1.example.net.
@ 3600 IN MX 10 mx2.example.net.
@ 3600 IN TXT "v=spf1 a include:spf.example.org ~all"
www 3600 IN CNAME other.host.example.</pre><a href="#appendix-A.5-2" class="pilcrow">¶</a>
</div>
</div>
<div id="_87566759-15b8-d69e-d115-b049a0bdc7b7">
<p id="appendix-A.5-3">Now application of the following template:<a href="#appendix-A.5-3" class="pilcrow">¶</a></p>
</div>
<div id="_68d703c6-87d6-4af8-2894-80db8e6e901c">
<div class="lang-json sourcecode" id="appendix-A.5-4">
<pre>[
    {
        "type":"A",
        "host":"@",
        "pointsTo":"203.0.113.2",
        "ttl":"1800"
    },
    {
        "type":"A",
        "host":"www",
        "pointsTo":"203.0.113.2",
        "ttl":"1800"
    },
    {
        "type":"SPFM",
        "host":"@",
        "spfRules":"a include:spf.hoster.example"
    }
]</pre><a href="#appendix-A.5-4" class="pilcrow">¶</a>
</div>
</div>
<div id="_203bb063-1ddf-b883-377e-1060c8b863ff">
<p id="appendix-A.5-5">The following DNS Zone would be generated after the template is applied:<a href="#appendix-A.5-5" class="pilcrow">¶</a></p>
</div>
<div id="_8315f86b-f40d-0a9f-716d-cb636744982d">
<div class="sourcecode" id="appendix-A.5-6">
<pre>$ORIGIN example.com.

@ 3600 IN SOA ns11.example.net. support.example.net. 2017050920 7200
1800 1209600 3600
@ 3600 IN NS ns11.example.net.
@ 3600 IN NS ns12.example.net.
@ 1800 IN A 203.0.113.2
@ 3600 IN MX 10 mx1.example.net.
@ 3600 IN MX 10 mx2.example.net.
@ 1800 IN TXT "v=spf1 a include:spf.example.org include:spf.hoster.ex
ample ~all"
www 1800 IN A 203.0.113.2</pre><a href="#appendix-A.5-6" class="pilcrow">¶</a>
</div>
</div>
</section>
</div>
<div id="example-spf-merge">
<section id="appendix-A.6">
        <h3 id="name-example-spf-record-merging">
<a href="#appendix-A.6" class="section-number selfRef">A.6. </a><a href="#name-example-spf-record-merging" class="section-name selfRef">Example: SPF Record Merging</a>
        </h3>
<div id="_b283620a-4a03-b77c-b55e-8d3dae5fcc8f">
<p id="appendix-A.6-1">Consider a DNS Zone before a template application:<a href="#appendix-A.6-1" class="pilcrow">¶</a></p>
</div>
<div id="_ec7c3fec-8579-6ae9-474c-d40436fd7c80">
<div class="sourcecode" id="appendix-A.6-2">
<pre>$ORIGIN example.com.

@ 3600 IN SOA ns11.example.net. support.example.net. 2017050817 7200
1800 1209600 3600
@ 3600 IN NS ns11.example.net.
@ 3600 IN NS ns12.example.net.</pre><a href="#appendix-A.6-2" class="pilcrow">¶</a>
</div>
</div>
<div id="_cf41ade7-0f62-be88-0819-af512bdf35f3">
<p id="appendix-A.6-3">Now application of the following template of Mail service:<a href="#appendix-A.6-3" class="pilcrow">¶</a></p>
</div>
<div id="_9343c470-547d-cadf-69e6-fe830006caed">
<div class="lang-json sourcecode" id="appendix-A.6-4">
<pre>[
    {
        "type":"MX",
        "host":"@",
        "priority": "10",
        "pointsTo":"mx1.example.net",
        "ttl":"1800"
    },
    {
        "type":"MX",
        "host":"www",
        "priority": "10",
        "pointsTo":"mx2.example.net",
        "ttl":"1800"
    },
    {
        "type":"SPFM",
        "host":"@",
        "spfRules":"a include:spf.example.net"
    }
]</pre><a href="#appendix-A.6-4" class="pilcrow">¶</a>
</div>
</div>
<div id="_e97ffa42-5444-013e-8082-ab72c5f5f2e6">
<p id="appendix-A.6-5">Expected result in the DNS Zone<a href="#appendix-A.6-5" class="pilcrow">¶</a></p>
</div>
<div id="_c795e651-3d85-1853-fd48-9807adc71de6">
<div class="sourcecode" id="appendix-A.6-6">
<pre>$ORIGIN example.com.

@ 3600 IN SOA ns11.example.net. support.example.net. 2017050817 7200
1800 1209600 3600
@ 3600 IN NS ns11.example.net.
@ 3600 IN NS ns12.example.net.
@ 3600 IN MX 10 mx1.example.net.
@ 3600 IN MX 10 mx2.example.net.
@ 3600 IN TXT "v=spf1 a include:spf.example.net ~all"</pre><a href="#appendix-A.6-6" class="pilcrow">¶</a>
</div>
</div>
<div id="_1a13303b-5b1b-c2a7-491d-de97d5f6a6b8">
<p id="appendix-A.6-7">In the next step application of the following template of Newsletter
service:<a href="#appendix-A.6-7" class="pilcrow">¶</a></p>
</div>
<div id="_7021cef8-d5f9-57b6-0714-b181121fbf27">
<div class="lang-json sourcecode" id="appendix-A.6-8">
<pre>[
    {
        "type":"SPFM",
        "host":"@",
        "spfRules":"include:_spf.newsletter.example"
    }
]</pre><a href="#appendix-A.6-8" class="pilcrow">¶</a>
</div>
</div>
<div id="_9f28dc19-276e-b4a4-f28b-5081469a36d5">
<p id="appendix-A.6-9">Expected result in the DNS Zone<a href="#appendix-A.6-9" class="pilcrow">¶</a></p>
</div>
<div id="_b54df81b-9920-33a5-1bdf-29024d6b02a2">
<div class="sourcecode" id="appendix-A.6-10">
<pre>$ORIGIN example.com.

@ 3600 IN SOA ns11.example.net. support.example.net. 2017050817 7200
1800 1209600 3600
@ 3600 IN NS ns11.example.net.
@ 3600 IN NS ns12.example.net.
@ 3600 IN MX 10 mx1.example.net.
@ 3600 IN MX 10 mx2.example.net.
@ 3600 IN TXT "v=spf1 a include:spf.example.net include:_spf.newslett
er.
example ~all"</pre><a href="#appendix-A.6-10" class="pilcrow">¶</a>
</div>
</div>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">P Kowalik</span></div>
<div dir="auto" class="left"><span class="org">DENIC eG</span></div>
<div dir="auto" class="left"><span class="street-address">Theodor-Stern-Kai 1</span></div>
<div dir="auto" class="left"><span class="locality">Frankfurt am Main</span></div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:pawel.kowalik@denic.de" class="email">pawel.kowalik@denic.de</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://denic.de" class="url">https://denic.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">A Blinn</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:arnold@arnoldblinn.com" class="email">arnold@arnoldblinn.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">J Kolker</span></div>
<div dir="auto" class="left"><span class="org">GoDaddy Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">14455 N. Hayden Rd. #219</span></div>
<div dir="auto" class="left">
<span class="locality">Scottsdale</span>,  </div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jkolker@godaddy.com" class="email">jkolker@godaddy.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://www.godaddy.com" class="url">https://www.godaddy.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">S Kerola</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare, Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">101 Townsend St</span></div>
<div dir="auto" class="left">
<span class="locality">San Francisco</span>,  </div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:kerolasa@cloudflare.com" class="email">kerolasa@cloudflare.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://cloudflare.com" class="url">https://cloudflare.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
